- oee_layout:
    Control: GroupContainer
    Variant: verticalAutoLayoutContainer
    Properties:
      DropShadow: =DropShadow.None
      Height: =Parent.Height
      LayoutAlignItems: =LayoutAlignItems.Stretch
      LayoutDirection: =LayoutDirection.Vertical
      LayoutGap: =
      LayoutMode: =LayoutMode.Auto
      RadiusBottomLeft: =0
      RadiusBottomRight: =0
      RadiusTopLeft: =0
      RadiusTopRight: =0
      Width: =Parent.Width
      X: =
    Children:
    - oee_header:
        Control: GroupContainer
        Variant: horizontalAutoLayoutContainer
        Properties:
          AlignInContainer: =AlignInContainer.SetByContainer
          DropShadow: =DropShadow.None
          Fill: =varColor1
          LayoutAlignItems: =LayoutAlignItems.Stretch
          LayoutMinHeight: =10
          LayoutMinWidth: =10
          LayoutMode: =LayoutMode.Auto
          PaddingBottom: =locPadding
          PaddingLeft: =locPadding
          PaddingRight: =locPadding
          PaddingTop: =locPadding
          RadiusBottomLeft: =0
          RadiusBottomRight: =0
          RadiusTopLeft: =0
          RadiusTopRight: =0
        Children:
        - oee_collect:
            Control: Classic/Button
            Properties:
              OnSelect: |-
                =/*Start*/
                UpdateContext({locLoading:{Visible: true, Value: 1, Text: "Loading"}});

                /*Capture Local Date Selection*/
                UpdateContext({
                    locEndDate: oee_end_date.SelectedDate,
                    locStartDate: oee_start_date.SelectedDate
                });

                UpdateContext({locLoading:{Visible: true, Value: 5, Text: "Checking for Updates"}});
                /*Check if collections need updating*/
                Set(varUpdateProduction,
                    Or(
                        Not(First(Sort(Production,ID,SortOrder.Descending)).ID = First(Sort(collectProduction,id,SortOrder.Descending)).id),
                        Not(varEndDate = locEndDate),
                        Not(varStartDate = locStartDate)
                    )
                );
                Set(varUpdateDowntime,
                    Or(    
                        Not(First(Sort(Downtime,ID,SortOrder.Descending)).ID = First(Sort(collectDowntime,id,SortOrder.Descending)).id),
                        Not(varEndDate = locEndDate),
                        Not(varStartDate = locStartDate)
                    )
                );

                /*Set collection dates from selected local dates*/
                If( Not(varEndDate = locEndDate), Set(varEndDate, locEndDate));
                If( Not(varStartDate = locStartDate), Set(varStartDate, locStartDate));


                /*Collect Production*/
                UpdateContext({locLoading:{Visible: true, Value: 10, Text: "Collecting Production Data"}});
                If(varUpdateProduction,
                    If(
                        DateDiff( varStartDate, varEndDate, TimeUnit.Days) <= 14,
                        UpdateContext({locLoading:{Visible: true, Value: 50, Text: "Retrieving Production Data"}});
                        ClearCollect(collectProduction,
                            ForAll(
                                Filter(Production,
                                    Hour_Ending <= DateAdd(varEndDate, 23, TimeUnit.Hours),
                                    Hour_Starting >= DateAdd(varStartDate, -1, TimeUnit.Hours)
                                ),
                                {
                                    id: Value(ThisRecord.ID),
                                    shift: Text(ThisRecord.Shift_Letter),
                                    line: Text(ThisRecord.Line.Value),
                                    lot: Text(ThisRecord.Lot),
                                    catalog: Text(ThisRecord.Catalog),
                                    size: Text(ThisRecord.Size),
                                    hour_ending: DateTimeValue(ThisRecord.Hour_Ending),
                                    hour_starting: DateTimeValue(ThisRecord.Hour_Starting),
                                    goal: Value(ThisRecord.Hourly_Goal),
                                    amount_built: Value(ThisRecord.Amount_Built),
                                    unit_starting: Value(ThisRecord.Unit_Starting),
                                    unit_ending: Value(ThisRecord.Unit_Ending),
                                    reject_labels: Value(ThisRecord.Reject_Labels),
                                    reject_cartridges: Value(ThisRecord.Reject_Cartridges),
                                    reject_units: Value(ThisRecord.Reject_Units),
                                    qa_units: Value(ThisRecord.QA_Units)
                                }
                            )
                        ),

                        DateDiff( varStartDate, varEndDate, TimeUnit.Days) > 21,
                        UpdateContext({locLoading:{Visible: true, Value: 50, Text: "Parsing PowerAutomate Flow for Production Data"}});
                        ClearCollect(collectProduction,
                            ForAll(
                                Table(
                                    ParseJSON(
                                        flow_get_units_range_v2.Run(
                                            Text("All"),
                                            Text(DateAdd(varEndDate, 23,TimeUnit.Hours), "yyyy-mm-dd"),
                                            Text(DateAdd(varStartDate, -1, TimeUnit.Hours), "yyyy-mm-dd")
                                        ).output
                                    )
                                ),
                                {
                                    id: Value(Value._ID),
                                    shift: Text(Value._shift),
                                    line: Text(Value._line),
                                    lot: Text(Value._lot),
                                    catalog: Text(Value._catalog),
                                    size: Text(Value._size),
                                    hour_ending: DateTimeValue(Value._hour_ending),
                                    hour_starting: DateTimeValue(Value._hour_starting),
                                    goal: Value(Value._goal),
                                    amount_built: Value(Value._amount_built),
                                    unit_starting: Value(Value._unit_starting),
                                    unit_ending: Value(Value._unit_ending),
                                    reject_labels: Value(Value._reject_labels),
                                    reject_cartridges: Value(Value._reject_cartridges),
                                    reject_units: Value(Value._reject_units),
                                    qa_units: Value(Value._qa)
                                }
                            )
                        ),

                        DateDiff( varStartDate, varEndDate, TimeUnit.Days) <= 21,
                        UpdateContext({locLoading:{Visible: true, Value: 20, Text: "Collecting Production Dataset 1"}});
                        Collect(material_1,
                            Sort(
                                Filter(Production,
                                    And(
                                        Hour_Ending <= DateAdd(varEndDate, 23, TimeUnit.Hours),
                                        Hour_Starting >= DateAdd(varStartDate, -1, TimeUnit.Hours)                        
                                    )
                                ),
                                Hour_Ending,
                                SortOrder.Ascending
                            )
                        );

                        UpdateContext({locLoading:{Visible: true, Value: 30, Text: "Collecting Production Dataset 2"}});
                        Collect(material_2,
                            Sort(
                                Filter(Production,
                                    And(
                                        Hour_Ending <= DateAdd(varEndDate, 23, TimeUnit.Hours),
                                        Hour_Starting >= DateAdd(varStartDate, -1, TimeUnit.Hours)                        
                                    )
                                ),
                                Hour_Ending,
                                SortOrder.Descending
                            )
                        );

                        UpdateContext({locLoading:{Visible: true, Value: 40, Text: "Joining Production Dataset 1"}});
                        ClearCollect(fusion, material_1);

                        UpdateContext({locLoading:{Visible: true, Value: 45, Text: "Joining Production Dataset 2"}});
                        Collect(fusion,
                            Filter(material_2, Not(ID in material_1.ID))
                        );

                        UpdateContext({locLoading:{Visible: true, Value: 50, Text: "Collecting Joined Production Data"}});
                        ClearCollect(
                            collectProduction,
                            ForAll(
                                fusion,
                                {
                                    id: Value(ThisRecord.ID),
                                    shift: Text(ThisRecord.Shift_Letter),
                                    line: Text(ThisRecord.Line.Value),
                                    lot: Text(ThisRecord.Lot),
                                    catalog: Text(ThisRecord.Catalog),
                                    size: Text(ThisRecord.Size),
                                    hour_ending: DateTimeValue(ThisRecord.Hour_Ending),
                                    hour_starting: DateTimeValue(ThisRecord.Hour_Starting),
                                    goal: Value(ThisRecord.Hourly_Goal),
                                    amount_built: Value(ThisRecord.Amount_Built),
                                    unit_starting: Value(ThisRecord.Unit_Starting),
                                    unit_ending: Value(ThisRecord.Unit_Ending),
                                    reject_labels: Value(ThisRecord.Reject_Labels),
                                    reject_cartridges: Value(ThisRecord.Reject_Cartridges),
                                    reject_units: Value(ThisRecord.Reject_Units),
                                    qa_units: Value(ThisRecord.QA_Units)
                                }
                            )
                        );

                        UpdateContext({locLoading:{Visible: true, Value: 55, Text: "Garbage Collection"}});
                        Clear(fusion);
                        Clear(material_1);
                        Clear(material_2);
                    )
                );

                /*Collect Downtime*/
                UpdateContext({locLoading:{Visible: true, Value: 60, Text: "Collecting Downtime Data"}});
                If(varUpdateDowntime,
                    If(
                        DateDiff( varStartDate, varEndDate, TimeUnit.Days) <= 14,
                        UpdateContext({locLoading:{Visible: true, Value: 85, Text: "Retrieving Downtime Data"}});
                        ClearCollect(collectDowntime,
                            ForAll(
                                Filter(Downtime,
                                    Ended <= DateAdd(varEndDate, 23, TimeUnit.Hours),
                                    Started >= DateAdd(varStartDate, -1, TimeUnit.Hours)
                                ),
                                {
                                    id: Value(ThisRecord.ID),
                                    shift: Text(ThisRecord.Shift_Letter),
                                    line: Text(ThisRecord.Line.Value),
                                    lot: Text(ThisRecord.Lot),
                                    catalog: Text(ThisRecord.Catalog),
                                    size: Text(ThisRecord.Size),
                                    started: DateTimeValue(ThisRecord.Started),
                                    ended: DateTimeValue(ThisRecord.Ended),
                                    reason: Text(ThisRecord.Reason.Value),
                                    total: Value(ThisRecord.Total_Downtime),
                                    comments: Text(ThisRecord.Comments)
                                }
                            )
                        ),

                        DateDiff( varStartDate, varEndDate, TimeUnit.Days) > 21,
                        UpdateContext({locLoading:{Visible: true, Value: 85, Text: "Parsing PowerAutomate Flow for Downtime Data"}});
                        ClearCollect(collectDowntime,
                            ForAll(
                                Table(
                                    ParseJSON(
                                        flow_get_downtime_range_v2.Run(
                                            Text("All"),
                                            Text(DateAdd(varEndDate, 23,TimeUnit.Hours), "yyyy-mm-dd"),
                                            Text(DateAdd(varStartDate, -1, TimeUnit.Hours), "yyyy-mm-dd")
                                        ).output
                                    )
                                ),
                                {
                                    id: Value(Value._ID),
                                    shift: Text(Value._shift),
                                    line: Text(Value._line),
                                    lot: Text(Value._lot),
                                    catalog: Text(Value._catalog),
                                    size: Text(Value._size),
                                    started: DateTimeValue(Value._started),
                                    ended: DateTimeValue(Value._ended),
                                    reason: Text(Value._reason),
                                    total: Value(Value._total),
                                    comments: Text(Value._comments)
                                }
                            )
                        ),

                        DateDiff( varStartDate, varEndDate, TimeUnit.Days) <= 21,
                        UpdateContext({locLoading:{Visible: true, Value: 65, Text: "Collecting Downtime Dataset 1"}});
                        Collect(material_1,
                            Sort(
                                Filter(Downtime,
                                    And(
                                        Ended <= DateAdd(varEndDate, 23, TimeUnit.Hours),
                                        Started >= DateAdd(varStartDate, -1, TimeUnit.Hours)
                                    )
                                ),
                                Ended,
                                SortOrder.Ascending
                            )
                        );

                        UpdateContext({locLoading:{Visible: true, Value: 70, Text: "Collecting Downtime Dataset 2"}});
                        Collect(material_2,
                            Sort(
                                Filter(Downtime,
                                    And(
                                        Ended <= DateAdd(varEndDate, 23, TimeUnit.Hours),
                                        Started >= DateAdd(varStartDate, -1, TimeUnit.Hours)                        
                                    )
                                ),
                                Ended,
                                SortOrder.Descending
                            )
                        );

                        UpdateContext({locLoading:{Visible: true, Value: 75, Text: "Joining Downtime Dataset 1"}});
                        ClearCollect(fusion, material_1);

                        UpdateContext({locLoading:{Visible: true, Value: 85, Text: "Joining Downtime Dataset 2"}});
                        Collect(fusion,
                            Filter(material_2, Not(ID in material_1.ID))
                        );

                        UpdateContext({locLoading:{Visible: true, Value: 85, Text: "Collecting Joined Downtime Data"}});
                        ClearCollect(
                            collectDowntime,
                            ForAll(
                                fusion,
                                {
                                    id: Value(ThisRecord.ID),
                                    shift: Text(ThisRecord.Shift_Letter),
                                    line: Text(ThisRecord.Line.Value),
                                    lot: Text(ThisRecord.Lot),
                                    catalog: Text(ThisRecord.Catalog),
                                    size: Text(ThisRecord.Size),
                                    started: DateTimeValue(ThisRecord.Started),
                                    ended: DateTimeValue(ThisRecord.Ended),
                                    reason: Text(ThisRecord.Reason.Value),
                                    total: Value(ThisRecord.Total_Downtime),
                                    comments: Text(ThisRecord.Comments)
                                }
                            )
                        );

                        UpdateContext({locLoading:{Visible: true, Value: 90, Text: "Garbage Collection"}});
                        Clear(fusion);
                        Clear(material_1);
                        Clear(material_2);
                    )
                );

                UpdateContext({locLoading:{Visible: true, Value: 95, Text: "Finshing up"}});

                /*Update the UI Elements*/
                Select(oee_collect_lists);
              Text: ="collect"
              FillPortions: =1
              LayoutMinHeight: =10
              LayoutMinWidth: =10
              Visible: =false
        - oee_collect_lists:
            Control: Classic/Button
            Properties:
              OnSelect: |-
                =/*Start*/
                UpdateContext({locLoading:{Visible: true, Value: 25, Text: "Creating Data Lists"}});

                /*Gather production size and line*/
                ClearCollect(
                    collectTempProduction,
                    GroupBy(
                        Filter(
                            collectProduction,
                            hour_starting >= DateAdd(oee_start_date.SelectedDate, -1, TimeUnit.Hours),
                            hour_ending <= DateAdd(oee_end_date.SelectedDate, 23, TimeUnit.Hours),
                            If(
                                oee_line.Selected.Value = "All",
                                line = line,
                                oee_line.Selected.Value = "Only SSCs",
                                Or(line = "SSC", line = "SSC2"),
                                oee_line.Selected.Value = "Only XLs",
                                Or(line = "XL1",line = "XL2",line = "XL3",line = "XL4",line = "XL5"),
                                oee_line.Selected.Value = "Only XLTs",
                                Or(line = "XLT", line = "XLT2", line = "XLT3"),
                                line = oee_line.Selected.Value
                            )
                        ),            
                        size,
                        line_group
                    )
                );

                /*Init size list collection*/
                Clear(collectSizeList);
                Collect(collectSizeList, {Size: "All", Line: []});
                /*Create a size list from production*/
                ForAll(
                    collectTempProduction,
                    Collect(
                        collectSizeList,
                        {
                            Size: size,
                            Line: line_group.line
                        }
                    )
                );
                /*Clear for garbage collection*/
                Clear(collectTempProduction);

                UpdateContext({locLoading:{Visible: true, Value: 50, Text: "Checking Production Catalogs"}});
                /*Gather production catalogs and line*/
                ClearCollect(
                    collectTempProduction,
                    GroupBy(
                        Filter(
                            collectProduction,
                            hour_starting >= DateAdd(oee_start_date.SelectedDate, -1, TimeUnit.Hours),
                            hour_ending <= DateAdd(oee_end_date.SelectedDate, 23, TimeUnit.Hours)
                        ),
                        catalog,
                        line_group
                    )
                );

                UpdateContext({locLoading:{Visible: true, Value: 75, Text: "Checking Downtime Catalogs"}});
                /*Gather Downtime catalogs and lines*/
                ClearCollect(
                    collectTempDowntime,
                    GroupBy(
                        Filter(
                            collectDowntime,
                            started >= DateAdd(oee_start_date.SelectedDate, -1, TimeUnit.Hours),
                            ended <= DateAdd(oee_end_date.SelectedDate, 23, TimeUnit.Hours)
                        ),
                        catalog,
                        line_group
                    )
                );

                /*Init Lot List collection*/
                UpdateContext({locLoading:{Visible: true, Value: 90, Text: "Initializing Lot List"}});
                Clear(collectCatalogList);
                Collect(collectCatalogList, {Catalog: "All", Line: []});
                /*Create a lot list from production and downtime*/
                ForAll(
                    collectTempProduction,
                    Collect(
                        collectCatalogList,
                        {
                            Catalog: catalog,
                            Line: line_group.line
                        }
                    )
                );
                ForAll(
                    collectTempDowntime,
                    If(
                        Not(ThisRecord.catalog in catalog),
                        Collect(
                            collectCatalogList,
                            {
                                Catalog: catalog,
                                Line: line_group.line
                            }
                        )
                    )
                );

                /*Clear temp collections*/
                UpdateContext({locLoading:{Visible: true, Value: 90, Text: "Garbage Collection"}});
                Clear(collectTempProduction);
                Clear(collectTempDowntime);


                UpdateContext({locLoading:{Visible: true, Value: 95, Text: "Finishing Up"}});
                Select(oee_update);
              Text: ="collect lists"
              FillPortions: =1
              LayoutMinHeight: =10
              LayoutMinWidth: =10
              Visible: =false
        - oee_update:
            Control: Classic/Button
            Properties:
              OnSelect: "=/*Start*/\nUpdateContext({locLoading:{Visible: true, Value: 1, Text: \"Creating Default Filters\"}});\n\n/*Set the default filter for production*/\nUpdateContext({locDefaultProductionFilter:\n    Filter(collectProduction,\n        And(\n            hour_starting >= DateAdd(oee_start_date.SelectedDate, -1, TimeUnit.Hours),\n            hour_ending <= DateAdd(oee_end_date.SelectedDate, 23, TimeUnit.Hours)\n        ),\n        If(\n            oee_line.Selected.Value = \"All\",\n            line = line,\n            oee_line.Selected.Value = \"Only SSCs\",\n            Or(line = \"SSC\", line = \"SSC2\"),\n            oee_line.Selected.Value = \"Only XLs\",\n            Or(line = \"XL1\",line = \"XL2\",line = \"XL3\",line = \"XL4\",line = \"XL5\"),\n            oee_line.Selected.Value = \"Only XLTs\",\n            Or(line = \"XLT\", line = \"XLT2\", line = \"XLT3\"),\n            line = oee_line.Selected.Value\n        )\n    )\n});\n\n/*Set the default filter for downtime*/\nUpdateContext({locDefaultDowntimeFilter:\n    Filter(collectDowntime,\n        And(\n            started >= DateAdd(DateValue(oee_start_date.SelectedDate), -1, TimeUnit.Hours),\n            ended <= DateAdd(DateValue(oee_end_date.SelectedDate), 23, TimeUnit.Hours)\n        ),\n        If(\n            oee_line.Selected.Value = \"All\",\n            line = line,\n            oee_line.Selected.Value = \"Only SSCs\",\n            Or(line = \"SSC\",line = \"SSC2\"),\n            oee_line.Selected.Value = \"Only XLs\",\n            Or(line = \"XL1\",line = \"XL2\",line = \"XL3\",line = \"XL4\",line = \"XL5\"),\n            oee_line.Selected.Value = \"Only XLTs\",\n            Or(line = \"XLT\",line = \"XLT2\",line = \"XLT3\"),\n            line = oee_line.Selected.Value\n        )\n    )\n});\n\nUpdateContext(\n    {        \n        count_of_days:\n            RoundDown(\n                DateDiff(oee_start_date.SelectedDate, oee_end_date.SelectedDate, TimeUnit.Days) / 7,\n                0\n            ) * 5 +\n            Mod(5 + Weekday(oee_end_date.SelectedDate) - Weekday(oee_start_date.SelectedDate), 5) + 1\n    }\n);\n\nUpdateContext({locLoading:{Visible: true, Value: 5, Text: \"Processing Top Downtime Reasons\"}});\n/*Collect Top Downtime*/\n/*Clear for reprocessing*/\nClear(collectTopDowntime);\n/*For all downtime reasons, collect the total sum of downtime, if downtime is greater than 0, add to collectHasReason*/\nForAll(collectDowntimeReasons,\n    If(\n        Sum(\n            Filter(locDefaultDowntimeFilter,\n                reason = Downtime_Reason\n            ),\n            total\n        ) > 0,\n        Collect(collectHasReason,\n            {\n                Downtime_Reason: Downtime_Reason\n            }\n        )\n    )\n);\n\n/*For all downtime that has an amount/reason, collect the total sum of downtime, sort by total amount*/\nForAll(collectHasReason,\n    Collect(collectTopDowntime,\n        {\n            Downtime_Reason: Downtime_Reason,\n            \n            Downtime_Total: Sum(\n                Filter(\n                    locDefaultDowntimeFilter,\n                    reason = Downtime_Reason\n                ),\n                total\n            )\n        }\n    )\n);\n\n/*Clear for garbage collection*/\nClear(collectHasReason);\n\nUpdateContext({locLoading:{Visible: true, Value: 10, Text: \"Creating Pareto Chart Data\"}});\n/*Collect data for pareto chart*/\nClear(collectPareto);\nForAll(\n    /*For downtime in collectTopDowntime, collect to collectPareto*/\n    Sort(\n        Filter(collectTopDowntime,\n            If(\n                oee_downtime.Selected.Value = \"Unplanned Only\", \n                And(\n                    Not(Downtime_Reason = \"No Scheduled Work\"),\n                    Not(Downtime_Reason = \"Engineering DT\"),\n                    Not(Downtime_Reason = \"Planned Downtime\")\n                ),\n                Downtime_Reason = Downtime_Reason\n            )\n        ),\n        Downtime_Total,\n        SortOrder.Descending\n    ),\n    Collect(collectPareto,\n        {\n            id: CountRows(collectPareto)+1,\n            \n            /*Debugging value*/\n            id_lookup: LookUp(collectPareto, id = CountRows(collectPareto)).id,\n            \n            reason: Downtime_Reason,\n\n            total: ThisRecord.Downtime_Total,\n\n            sum: Sum(collectTopDowntime,Downtime_Total),\n            \n            freq:\n                /*frequency = This record's downtime / sum of total downtime */\n                Round(\n                    ThisRecord.Downtime_Total /\n                    Sum(\n                        Filter(collectTopDowntime,\n                            If(\n                                oee_downtime.Selected.Value = \"Unplanned Only\", \n                                And(\n                                    Not(Downtime_Reason = \"No Scheduled Work\"),\n                                    Not(Downtime_Reason = \"Engineering DT\"),\n                                    Not(Downtime_Reason = \"Planned Downtime\")\n                                ),\n                                Downtime_Reason = Downtime_Reason\n                            )\n                        ),\n                        Downtime_Total\n                    ) * 100,0\n                ),\n\n            cumulative:\n                /*cumulative percentage = (this record's downtime / sum of total downtime) + the last record's cumulative percentage */\n                Round(\n                    ThisRecord.Downtime_Total / \n                    Sum(\n                        Filter(collectTopDowntime,\n                            If(\n                                oee_downtime.Selected.Value = \"Unplanned Only\", \n                                And(\n                                    Not(Downtime_Reason = \"No Scheduled Work\"),\n                                    Not(Downtime_Reason = \"Engineering DT\"),\n                                    Not(Downtime_Reason = \"Planned Downtime\")\n                                ),\n                                Downtime_Reason = Downtime_Reason\n                            )\n                        ),\n                        Downtime_Total\n                    ) * 100,0\n                ) + \n                If(\n                    CountRows(collectPareto) >= 1,\n                    LookUp(collectPareto, id = CountRows(collectPareto)).cumulative,\n                    0\n                )\n        }\n    )\n);\n\nUpdateContext({locLoading:{Visible: true, Value: 25, Text: \"Combining Databases\"}});\n/*Combine databases to find runtime*/\nClear(collectCombinedData);\nClearCollect(collectCombinedData,\n    Filter(\n        collectProduction,\n        And(\n            hour_starting >= DateAdd(oee_start_date.SelectedDate, -1, TimeUnit.Hours),\n            hour_ending <= DateAdd(oee_end_date.SelectedDate, 23, TimeUnit.Hours)\n        )\n    )\n);\nForAll(\n    collectLineSchema,\n    {\n        Line: SCH_Line,\n        \n        Value:\n        ForAll(\n            Filter(\n                collectDowntime,\n                And(\n                    started >= DateAdd(oee_start_date.SelectedDate, -1, TimeUnit.Hours),\n                    ended <= DateAdd(oee_end_date.SelectedDate, 23, TimeUnit.Hours)\n                ),\n                line = SCH_Line\n            ),\n            With(\n                {\n                    thisDowntime: ThisRecord,\n                    thisLine: SCH_Line\n                },\n                If(\n                    CountRows(\n                        Filter(\n                            collectProduction,\n                            And(\n                                hour_starting >= DateAdd(oee_start_date.SelectedDate, -1, TimeUnit.Hours),\n                                hour_ending <= DateAdd(oee_end_date.SelectedDate, 23, TimeUnit.Hours)\n                            ),\n                            line = SCH_Line,\n                            (hour_starting <= thisDowntime.started && hour_ending > thisDowntime.started) || \n                            (hour_starting < thisDowntime.ended && hour_ending >= thisDowntime.ended) ||\n                            (hour_starting >= thisDowntime.started && hour_ending <= thisDowntime.ended)\n                            )) = 0,\n                    Collect(collectCombinedData, thisDowntime)\n                )\n            )\n        )\n    }\n);\n\n\nUpdateContext({locLoading:{Visible: true, Value: 30, Text: \"Calculating Shift OEE2 Data\"}});\n/*For each catalog, for each line, for each shift, collect output, constraint, and runtime*/\nClearCollect(collectShiftOEE2Data, {shift: \"A\"});\nClear(collectShiftOEE2Data);\nWith(\n    {\n        theseLines:\n            If(\n                oee_line.Selected.Value = \"All\",\n                [\"XL1\", \"XL2\", \"XL3\", \"XL4\", \"XL5\", \"SSC\", \"SSC2\", \"XLT\", \"XLT2\", \"XLT3\"],\n                oee_line.Selected.Value = \"Only SSCs\",\n                [\"SSC\", \"SSC2\"],\n                oee_line.Selected.Value = \"Only XLs\",\n                [\"XL1\", \"XL2\", \"XL3\", \"XL4\", \"XL5\"],\n                oee_line.Selected.Value = \"Only XLTs\",\n                [\"XLT\", \"XLT2\", \"XLT3\"],\n                [oee_line.Selected.Value]\n            ),\n        theseCatalogs:\n            If(\n                oee_line.Selected.Value = \"All\",\n                [\"51\", \"02\", \"03\", \"04\", \"05\", \"10\", \"015\", \"003\", \"006\", \"1F\", \"1H\", \"1S\", \"1T\", \"1Z\", \"2F\", \"2H\", \"2S\", \"2T\", \"2Z\", \"3F\", \"3H\", \"3S\", \"3T\", \"3Z\"],\n                oee_line.Selected.Value = \"Only SSCs\",\n                [\"015\", \"003\", \"006\"],\n                oee_line.Selected.Value = \"Only XLs\",\n                [\"51\", \"02\", \"03\", \"04\", \"05\", \"10\"],\n                oee_line.Selected.Value = \"Only XLTs\",\n                [\"1F\", \"1H\", \"1S\", \"1T\", \"1Z\", \"2F\", \"2H\", \"2S\", \"2T\", \"2Z\", \"3F\", \"3H\", \"3S\", \"3T\", \"3Z\"],\n                [\"51\", \"02\", \"03\", \"04\", \"05\", \"10\", \"015\", \"003\", \"006\", \"1F\", \"1H\", \"1S\", \"1T\", \"1Z\", \"2F\", \"2H\", \"2S\", \"2T\", \"2Z\", \"3F\", \"3H\", \"3S\", \"3T\", \"3Z\"]\n            ),\n        theseShifts:\n            [\"A\",\"B\",\"C\"]\n    },\n    ForAll(theseShifts,\n        With({thisShift: ThisRecord.Value},\n            ForAll(theseLines,\n                With({thisLine: ThisRecord.Value},\n                    ForAll(theseCatalogs,\n                        With({thisCatalog: ThisRecord.Value},\n                            If(\n                                Sum(\n                                    Filter(collectProduction,\n                                        And(\n                                            hour_starting >= DateAdd(oee_start_date.SelectedDate, -1, TimeUnit.Hours),\n                                            hour_ending <= DateAdd(oee_end_date.SelectedDate, 23, TimeUnit.Hours)\n                                        ),\n                                        line = thisLine,\n                                        size = thisCatalog,\n                                        shift = thisShift\n                                    ),\n                                    amount_built\n                                ) > 0,\n                            \n                                Collect(collectShiftOEE2Data,\n                                    {\n                                        shift: thisShift,\n                                        \n                                        line: thisLine,\n                                        \n                                        catalog: thisCatalog,\n                                        \n                                        constraint_setting:\n                                            IfError(\n                                                Average(\n                                                    Filter(Goal_Settings,\n                                                        Line.Value = thisLine,\n                                                        Size.Value = thisCatalog,\n                                                        Constraint_Setting > 0\n                                                    ), Constraint_Setting\n                                                ),\n                                                0\n                                            ),\n                                            \n                                        output:\n                                            Sum(\n                                                Filter(collectProduction,\n                                                    And(\n                                                        hour_starting >= DateAdd(oee_start_date.SelectedDate, -1, TimeUnit.Hours),\n                                                        hour_ending <= DateAdd(oee_end_date.SelectedDate, 23, TimeUnit.Hours)\n                                                    ),\n                                                    line = thisLine,\n                                                    size = thisCatalog,\n                                                    shift = thisShift\n                                                ),\n                                                amount_built\n                                            ),\n                                        \n                                        runtime:\n                                            (\n                                                /*Collect Runtime Minutes From Production*/\n                                                (CountRows(\n                                                    Filter(collectCombinedData,\n                                                        amount_built > 0,\n                                                        line = thisLine,\n                                                        size = thisCatalog,\n                                                        shift = thisShift\n                                                    )\n                                                ) * 60) +\n                                                /*Collect Runtime Minues From Downtime*/\n                                                Sum(\n                                                    Filter(collectCombinedData,\n                                                        line = thisLine,\n                                                        size = thisCatalog,\n                                                        shift = thisShift,\n                                                        Not(reason = \"Planned Downtime\" || reason = \"No Scheduled Work\" || reason = \"Engineering DT\")\n                                                    ),\n                                                    total\n                                                )\n                                            )/60,\n                                    \n                                        constraint_goal:\n                                            /*Constraint *  Runtime*/\n                                            /*Constraint*/\n                                                IfError(\n                                                    Average(\n                                                        Filter(Goal_Settings,\n                                                            Line.Value = thisLine,\n                                                            Size.Value = thisCatalog,\n                                                            Constraint_Setting > 0\n                                                        ), Constraint_Setting\n                                                    ),\n                                                    0\n                                                )*\n                                            /* Runtime */\n                                                (\n                                                    /*Collect Runtime Minutes From Production*/\n                                                    (CountRows(\n                                                        Filter(collectCombinedData,\n                                                            amount_built > 0,\n                                                            line = thisLine,\n                                                            size = thisCatalog,\n                                                            shift = thisShift\n                                                        )\n                                                    ) * 60) +\n                                                    /*Collect Runtime Minues From Downtime*/\n                                                    Sum(\n                                                        Filter(collectCombinedData,\n                                                            line = thisLine,\n                                                            size = thisCatalog,\n                                                            shift = thisShift,\n                                                            Not(reason = \"Planned Downtime\" || reason = \"No Scheduled Work\" || reason = \"Engineering DT\")\n                                                        ),\n                                                        total\n                                                    )\n                                                ) / 60\n                                    }\n                                )\n                            )\n                        )\n                    )\n                )\n            )\n        )\n    )\n);\n\nUpdateContext({locLoading:{Visible: true, Value: 40, Text: \"Collecting Shift OEE2\"}});\n/*Collect Shift OEE2*/\nClear(collectShiftOEE);\nForAll(collectShiftSchema,\n    Collect(collectShiftOEE,\n        {\n            constraint_average:\n                IfError(\n                    Average(\n                        Filter(collectShiftOEE2Data,\n                            output > 0 ,\n                            shift = SCH_Shift\n                        ),\n                        constraint_setting\n                    ),\n                    0\n                ),\n\n            constraint_goal:\n                IfError(\n                    Sum(\n                        Filter(collectShiftOEE2Data,\n                            output > 0,\n                            shift = SCH_Shift\n                        ),\n                        constraint_goal\n                    ),\n                    0\n                ),\n            \n            downtime_planned:\n                Sum(\n                    Filter(locDefaultDowntimeFilter,\n                        shift = SCH_Shift,\n                        reason = \"No Scheduled Work\" || reason = \"Engineering DT\" || reason = \"Planned Downtime\"\n                    ),\n                    total\n                ),\n\n            OEE2:\n                IfError(\n                    Round(\n                        Sum(\n                            Filter(collectShiftOEE2Data, output > 0, shift = SCH_Shift),\n                            output\n                        ) /\n                        Sum(\n                            Filter(collectShiftOEE2Data, output > 0, shift = SCH_Shift),\n                            constraint_goal\n                        ) * 100,\n                        2\n                    ),\n                    0\n                ),\n\n            output:\n                IfError(\n                    Sum(\n                        Filter(collectShiftOEE2Data,\n                            output > 0,\n                            shift = SCH_Shift\n                        ),\n                        output\n                    ),\n                    0\n                ),\n\n            runtime_hours: \n                Sum(\n                    Filter(collectShiftOEE2Data,\n                        output > 0,\n                        shift = SCH_Shift\n                    ),\n                    runtime\n                ),\n\n            runtime_total:\n                (If(\n                oee_line.Selected.Value = \"All\",\n                count_of_days * 9,\n                oee_line.Selected.Value = \"Only SSCs\",\n                count_of_days * 2,\n                oee_line.Selected.Value = \"Only XLs\",\n                count_of_days * 5,\n                oee_line.Selected.Value = \"Only XLTs\",\n                count_of_days * 2,\n                count_of_days\n                ) * 480)/60, \n            \n            shift: SCH_Shift\n\n        }\n    )\n);\n\nUpdateContext({locLoading:{Visible: true, Value: 55, Text: \"Gathering OEE2 Data\"}});\n/*For each catalog, for each line, collect output, constraint, and runtime*/\nClear(collectOEE2Data);\nWith(\n    {\n        theseLines:\n            If(\n                oee_line.Selected.Value = \"All\",\n                [\"XL1\", \"XL2\", \"XL3\", \"XL4\", \"XL5\", \"SSC\", \"SSC2\", \"XLT\", \"XLT2\", \"XLT3\"],\n                oee_line.Selected.Value = \"Only SSCs\",\n                [\"SSC\", \"SSC2\"],\n                oee_line.Selected.Value = \"Only XLs\",\n                [\"XL1\", \"XL2\", \"XL3\", \"XL4\", \"XL5\"],\n                oee_line.Selected.Value = \"Only XLTs\",\n                [\"XLT\", \"XLT2\", \"XLT3\"],\n                [oee_line.Selected.Value]\n            ),\n        theseCatalogs:\n            If(\n                oee_line.Selected.Value = \"All\",\n                [\"51\", \"02\", \"03\", \"04\", \"05\", \"10\", \"015\", \"003\", \"006\", \"1F\", \"1H\", \"1S\", \"1T\", \"1Z\", \"2F\", \"2H\", \"2S\", \"2T\", \"2Z\", \"3F\", \"3H\", \"3S\", \"3T\", \"3Z\"],\n                oee_line.Selected.Value = \"Only SSCs\",\n                [\"015\", \"003\", \"006\"],\n                oee_line.Selected.Value = \"Only XLs\",\n                [\"51\", \"02\", \"03\", \"04\", \"05\", \"10\"],\n                oee_line.Selected.Value = \"Only XLTs\",\n                [\"1F\", \"1H\", \"1S\", \"1T\", \"1Z\", \"2F\", \"2H\", \"2S\", \"2T\", \"2Z\", \"3F\", \"3H\", \"3S\", \"3T\", \"3Z\"],\n                [\"51\", \"02\", \"03\", \"04\", \"05\", \"10\", \"015\", \"003\", \"006\", \"1F\", \"1H\", \"1S\", \"1T\", \"1Z\", \"2F\", \"2H\", \"2S\", \"2T\", \"2Z\", \"3F\", \"3H\", \"3S\", \"3T\", \"3Z\"]\n            )\n    },\n    ForAll(theseLines,\n        With({thisLine: ThisRecord.Value},\n            ForAll(theseCatalogs,\n                With({thisCatalog: ThisRecord.Value},\n                    If(\n                        Sum(\n                            Filter(collectProduction,\n                                And(\n                                    hour_starting >= DateAdd(oee_start_date.SelectedDate, -1, TimeUnit.Hours),\n                                    hour_ending <= DateAdd(oee_end_date.SelectedDate, 23, TimeUnit.Hours)\n                                ),\n                                line = thisLine,\n                                size = thisCatalog\n                            ),\n                            amount_built\n                        ) > 0,\n                    \n                        Collect(collectOEE2Data,\n                            {\n                                line: thisLine,\n                                \n                                catalog: thisCatalog,\n                                \n                                constraint_setting:\n                                    IfError(\n                                        First(Filter(Goal_Settings, Line.Value = thisLine, Size.Value = thisCatalog)).Constraint_Setting,\n                                        0\n                                    ),\n                                    \n                                output:\n                                    Sum(\n                                        Filter(collectProduction,\n                                            And(\n                                                hour_starting >= DateAdd(oee_start_date.SelectedDate, -1, TimeUnit.Hours),\n                                                hour_ending <= DateAdd(oee_end_date.SelectedDate, 23, TimeUnit.Hours)\n                                            ),\n                                            line = thisLine,\n                                            size = thisCatalog\n                                        ),\n                                        amount_built\n                                    ),\n                                \n                                runtime:\n                                    (\n                                        /*Collect runtime minutes from production*/\n                                        (CountRows(\n                                            Filter(collectCombinedData,\n                                                amount_built > 0,\n                                                line = thisLine,\n                                                size = thisCatalog\n                                            )\n                                        ) * 60) +\n                                        /*Collect runtime minutes from downtime*/\n                                        Sum(\n                                            Filter(collectCombinedData,\n                                                line = thisLine,\n                                                size = thisCatalog,\n                                                Not(reason = \"Planned Downtime\" || reason = \"No Scheduled Work\" || reason = \"Engineering DT\")\n                                            ),\n                                            total\n                                        )\n                                    )/60,\n                            \n                                constraint_goal:\n                                    /*Constraint *  Runtime*/\n                                    /*Constraint*/\n                                    IfError(\n                                        First(Filter(Goal_Settings, Line.Value = thisLine, Size.Value = thisCatalog)).Constraint_Setting,\n                                        0\n                                    ) *\n                                    /* Runtime */\n                                    (\n                                        /*Collect runtime minutes from production*/\n                                        (CountRows(\n                                            Filter(collectCombinedData,\n                                                amount_built > 0,\n                                                line = thisLine,\n                                                size = thisCatalog\n                                            )\n                                        ) * 60) +\n                                        /*Collect runtime minutes from downtime*/\n                                        Sum(\n                                            Filter(collectCombinedData,\n                                                line = thisLine,\n                                                size = thisCatalog,\n                                                Not(reason = \"Planned Downtime\" || reason = \"No Scheduled Work\" || reason = \"Engineering DT\")\n                                            ),\n                                            total\n                                        )\n                                    ) / 60\n                            }\n                        )\n                    )\n                )\n            )\n        )   \n    )\n);\n\n\nUpdateContext({locLoading:{Visible: true, Value: 75, Text: \"Calculating OEE2\"}});\n/*Collect OEE2*/\nClear(collectOEE2);\nWith(\n    {\n        constraint_average:\n            IfError(\n                Average(Filter(collectOEE2Data, constraint_setting > 0),\n                    constraint_setting\n                ),\n                0\n            ),\n\n        constraint_goal:\n            IfError(\n                Sum(collectOEE2Data,\n                    constraint_goal\n                ),\n                0\n            ),\n\n        output:\n            IfError(\n                Sum(collectOEE2Data,\n                    output\n                ),\n                0\n            ),\n\n        runtime_total:\n            If(\n                oee_line.Selected.Value = \"All\",\n                1440 * 9 * count_of_days,\n                oee_line.Selected.Value = \"Only SSCs\",\n                1440 * 2 * count_of_days,\n                oee_line.Selected.Value = \"Only XLs\",\n                1440 * 5 * count_of_days,\n                oee_line.Selected.Value = \"Only XLTs\",\n                1440 * 3 * count_of_days,\n                1440 * count_of_days\n            ),\n        \n        total:\n            Sum(\n                locDefaultProductionFilter,\n                reject_cartridges + reject_units + amount_built\n            ),\n        \n        uptime:\n            IfError(\n                Sum(collectOEE2Data,\n                    runtime\n                ),\n                0\n            )\n    },\n    Collect(collectOEE2,\n        {\n            availability:\n                IfError(\n                    Round(\n                        (uptime / (runtime_total / 60)) * 100,\n                        0\n                    ),\n                    0\n                ),\n            \n            constraint_goal: constraint_goal,\n\n            constraint_average: constraint_average,\n            \n            downtime_planned:\n                Sum(\n                    Filter(locDefaultDowntimeFilter,\n                        reason = \"No Scheduled Work\" || reason = \"Engineering DT\" || reason = \"Planned Downtime\"\n                    ),\n                    total\n                )*1,\n            \n            downtime_unplanned:\n                Sum(\n                    Filter(locDefaultDowntimeFilter,\n                        Not(reason = \"No Scheduled Work\" || reason = \"Engineering DT\" || reason = \"Planned Downtime\")\n                    ),\n                    total\n                )*1,\n            \n            /*Save this for sanity checks but removed from main view*/\n            OEE1:\n                IfError(\n                    Round(\n                        (output / (constraint_average * (runtime_total / 60))) * 100,\n                        0\n                    ),\n                    0\n                ),\n            \n            OEE2:\n                IfError(\n                    Round(\n                        (output / constraint_goal),\n                        2\n                    ) * 100,\n                    0\n                ),\n\n            \n            output: output,\n            \n            performance:\n                IfError(\n                    Round(\n                        (output / constraint_goal) * 100,\n                        0\n                    ),\n                    0\n                ),\n            \n            rejects:\n                Sum(\n                    locDefaultProductionFilter,\n                    reject_cartridges + reject_units\n                ),\n            \n            runtime_total: runtime_total/60,\n            \n            uptime: uptime,\n            \n            target:\n                If(\n                    oee_line.Selected.Value = \"All\",\n                    ((8000 + 2000 + 1090)/5) * count_of_days,\n                    oee_line.Selected.Value = \"Only SSCs\",\n                    (1090/5) * count_of_days,\n                    oee_line.Selected.Value = \"Only XLs\",\n                    (8000/5) * count_of_days,\n                    oee_line.Selected.Value = \"Only XLTs\",\n                    (2000/5) * count_of_days,\n                    \"SSC\" in oee_line.Selected.Value,\n                    ((1090 / 2)/5) * count_of_days,\n                    \"XLT\" in oee_line.Selected.Value,\n                    ((2000 / 2)/5) * count_of_days,\n                    ((8000 / 5)/5) * count_of_days\n                ),\n            \n            total: total,\n            \n            yield:\n                IfError(\n                    Round(\n                        (output / total) * 100,\n                        0\n                    ),\n                    0\n                )\n            \n        }\n    )\n);\n\n\n/*Garbage collection*/\nUpdateContext({locLoading:{Visible: true, Value: 95, Text: \"Finishing Up\"}});\nUpdateContext({\n    locDefaultProductionFilter: Blank(),\n    locDefaultDowntimeFilter: Blank()\n});\n\nClear(collectCombinedData);\nClear(collectShiftOEE2Data);\nClear(collectOEE2Data);\n\n\n/*End*/\nUpdateContext({locLoading:{Visible: true, Value: 100, Text: \"Completed\"}});\nUpdateContext({locLoading:{Visible: false, Value: -1, Text: \"Not Loading\"}});"
              Text: ="update"
              FillPortions: =1
              LayoutMinHeight: =10
              LayoutMinWidth: =10
              Visible: =false
        - oee_logo:
            Control: Image
            Properties:
              Image: =LOGO_MSIG_SBlue_FIT_ALPHA
              FillPortions: =1
              LayoutMinHeight: =10
              Width: =10
        - oee_h_title:
            Control: Text
            Properties:
              Align: ='TextCanvas.Align'.Center
              FontColor: =varColor5
              Size: =24
              Text: ="Encapsualtion Daily Management System"
              VerticalAlign: ='TextCanvas.VerticalAlign'.Middle
              FillPortions: =6
              LayoutMinHeight: =8
              LayoutMinWidth: =10
        - oee_h_nav:
            Control: GroupContainer
            Variant: horizontalAutoLayoutContainer
            Properties:
              AlignInContainer: =AlignInContainer.SetByContainer
              DropShadow: =DropShadow.None
              FillPortions: =0
              LayoutAlignItems: =LayoutAlignItems.Stretch
              LayoutGap: =locPadding
              LayoutJustifyContent: =LayoutJustifyContent.Center
              LayoutMinHeight: =10
              LayoutMinWidth: =10
              LayoutMode: =LayoutMode.Auto
              RadiusBottomLeft: =0
              RadiusBottomRight: =0
              RadiusTopLeft: =0
              RadiusTopRight: =0
              Width: =oee_h_n_reload.Width * 3 + locPadding*4
            Children:
            - oee_h_n_reload:
                Control: Image
                Properties:
                  OnSelect: =Select(oee_collect);
                  Image: |-
                    ="data:image/svg+xml;utf8, " & EncodeUrl("

                    <svg id='Icon' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 140.25 140.25'><defs><style>.cls-1{fill:"& varHexAccent &";}</style></defs><path class='cls-1' d='M70.12.12a69.87,69.87,0,0,0-23.37,4l0,0a13.17,13.17,0,0,0,4.65,25.49,39.54,39.54,0,0,0,6.18-1.18l2.92-.71a44.45,44.45,0,0,1,20.73.61,5.79,5.79,0,0,1,2.63,1.38A4.24,4.24,0,0,1,85,31.24,4.86,4.86,0,0,1,85,35l-.76,2a1.35,1.35,0,0,1-1.86.75l-.81-.3A35.56,35.56,0,1,0,100.25,53L97,65.75a1.33,1.33,0,0,1-1.31,1.14,1.64,1.64,0,0,1-.37,0l-2.08-.54a4.83,4.83,0,0,1-3.1-2.16,4.77,4.77,0,0,1-.37-3.75l4.59-17.7a6.23,6.23,0,0,1,3.62-4.28c1.69-.79,2.45-1,4.92-.08l17,7.84a4.53,4.53,0,0,1,2.34,6.45l-.9,1.93a1.28,1.28,0,0,1-1.19.79,1.68,1.68,0,0,1-.73-.17l-11-5.12a44.13,44.13,0,0,1-29.41,64c-7.34,1.6-17.83,1-25.16-1.89A44.11,44.11,0,0,1,34.37,44.47c.31-.42,1.57-2.06,1.87-2.48A13.07,13.07,0,0,0,15,26.8c-.36.49-1.79,2.65-2.18,3.21A70,70,0,1,0,70.12.12Z'/></svg>



                    ")
                  Height: =Parent.Height * 0.75
                  HoverBorderColor: =ColorFade(varColorYes, 20%)
                  HoverFill: =ColorFade(varColorAccent, 75%)
                  LayoutMinHeight: =10
                  LayoutMinWidth: =10
                  RadiusBottomLeft: =Self.Width/2
                  RadiusBottomRight: =Self.Width/2
                  RadiusTopLeft: =Self.Width/2
                  RadiusTopRight: =Self.Width/2
                  Width: =Self.Height
                  X: =oee_h_n_settings.X - Self.Width - Parent.Width * 0.015
                  Y: =Parent.Height/2 - Self.Height/2
            - oee_h_n_bugs:
                Control: Image
                Properties:
                  OnSelect: =Navigate(Bugs)
                  Image: |-
                    ="data:image/svg+xml;utf8, " & EncodeUrl("

                    <svg id='Icon' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 140 140'><defs><style>.cls-1{fill:" & varHexAccent & ";}</style></defs><path class='cls-1' d='M80.07,33.73a24.48,24.48,0,1,0,24.48,24.48A24.51,24.51,0,0,0,80.07,33.73ZM65,47.65a1.45,1.45,0,0,1,1.7-1.16l5.62,1.06a8.34,8.34,0,0,1,7.46-4.65h.47a8.37,8.37,0,0,1,7.47,4.65l5.62-1.06a1.45,1.45,0,0,1,.54,2.85l-5.35,1a8.46,8.46,0,0,1,0,.87.85.85,0,0,1-.85.85H72.28a.85.85,0,0,1-.85-.85,6.35,6.35,0,0,1,0-.87l-5.35-1A1.45,1.45,0,0,1,65,47.65Zm28.88,19.7a1.45,1.45,0,0,1-.27,2.88,1.24,1.24,0,0,1-.27,0l-5.62-1.06a7.74,7.74,0,0,1-3.43,3.79c-1.88.82-6.8.8-8.67-.07a7.64,7.64,0,0,1-3.3-3.72L66.67,70.2a1.24,1.24,0,0,1-.27,0A1.46,1.46,0,0,1,65,69a1.44,1.44,0,0,1,1.16-1.69l5.35-1a6.35,6.35,0,0,1,0-.87v-5.3H66.16a1.45,1.45,0,1,1,0-2.9h5.27V56.06A1.09,1.09,0,0,1,72.52,55H87.46a1.09,1.09,0,0,1,1.09,1.09v1.21h5.32a1.45,1.45,0,0,1,0,2.9H88.55v5.3a8.46,8.46,0,0,1,0,.87Z'/><path class='cls-1' d='M69.91-.08a70,70,0,0,0-66,93.27c.13.38.7,1.8.82,2.12a15.3,15.3,0,0,0,25.62,5c.37-.4,2.29-2.41,2.29-2.41L47.45,83.05a2,2,0,0,1,2.92.12,38.81,38.81,0,0,0,6.27,6,2,2,0,0,1,.2,3L43.62,105.34s-3,2.72-3.65,3.29a16.13,16.13,0,0,0,5,26.69c.49.21,2.5.88,3,1.05A70,70,0,1,0,69.91-.08ZM80.07,92a33.81,33.81,0,1,1,33.81-33.81A33.85,33.85,0,0,1,80.07,92Z'/></svg>



                    ")
                  Height: =Parent.Height * 0.75
                  HoverBorderColor: =ColorFade(varColorYes, 20%)
                  HoverFill: =ColorFade(varColorAccent, 75%)
                  LayoutMinHeight: =10
                  LayoutMinWidth: =10
                  RadiusBottomLeft: =Self.Width/2
                  RadiusBottomRight: =Self.Width/2
                  RadiusTopLeft: =Self.Width/2
                  RadiusTopRight: =Self.Width/2
                  Width: =Self.Height
                  X: =Parent.Width * 0.99 - Self.Width
                  Y: =Parent.Height/2 - Self.Height/2
            - oee_h_n_settings:
                Control: Image
                Properties:
                  OnSelect: =Navigate(Settings)
                  Image: |-
                    ="data:image/svg+xml;utf8, " & EncodeUrl("

                    <svg id='Icon' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 140 140'><defs><style>.cls-1{fill:" & varHexAccent & ";}</style></defs><path class='cls-1' d='M69.52,87.51a18,18,0,1,0,.11-36.06,18,18,0,1,0-.11,36.06'/><path class='cls-1' d='M139.42,64.6A64.36,64.36,0,0,0,131,36.05C119,15.24,101.24,2.84,77.23,0A66.63,66.63,0,0,0,37.54,7.27,70.36,70.36,0,0,0,5,42.45,68,68,0,0,0-.43,70.11,63.18,63.18,0,0,0,1.82,85.8c1,3.82,3.15,9.39,6,12.31A19.57,19.57,0,0,0,27,103.61c2.87-.81,9.71-3.83,6.85-10.42a1.66,1.66,0,0,1,0-1.31c1.44-2.11,3-4.21,4.59-6.18a1.52,1.52,0,0,0,.44-1.4l-1.47-3.54a1.5,1.5,0,0,0-1.29-.68c-2.5-.27-5.11-.65-7.61-1.11a1.51,1.51,0,0,1-.93-.93,38.11,38.11,0,0,1-.84-8.56,46.23,46.23,0,0,1,.84-8.55,1.48,1.48,0,0,1,.93-.93c2.5-.47,5.11-.84,7.61-1.12a1.48,1.48,0,0,0,1.29-.68l1.47-3.53a1.51,1.51,0,0,0-.44-1.4c-1.57-2-3.15-4.08-4.59-6.18a1.51,1.51,0,0,1,0-1.31,29.91,29.91,0,0,1,5.45-6.65,29.56,29.56,0,0,1,6.63-5.45,1.51,1.51,0,0,1,1.31,0c2.1,1.44,4.2,3,6.17,4.6a1.47,1.47,0,0,0,1.4.43l3.53-1.46A1.53,1.53,0,0,0,59,36c.27-2.5.65-5.11,1.11-7.62A1.53,1.53,0,0,1,61,27.4c1.48-.28,1.55-.84,8.54-.84s7.06.56,8.55.84a1.51,1.51,0,0,1,.92.93c.47,2.51.84,5.12,1.12,7.62a1.51,1.51,0,0,0,.68,1.3l3.53,1.46a1.46,1.46,0,0,0,1.39-.43c2-1.58,4.07-3.16,6.17-4.6a1.53,1.53,0,0,1,1.32,0c1.24.85,2.39,1.21,6.63,5.45s4.59,5.4,5.45,6.65a1.51,1.51,0,0,1,0,1.31c-1.44,2.1-3,4.21-4.6,6.18a1.5,1.5,0,0,0-.43,1.4l1.46,3.53a1.5,1.5,0,0,0,1.29.68c2.51.28,5.11.65,7.62,1.12a1.53,1.53,0,0,1,.93.93c.27,1.49.83,1.79.83,8.55s-.56,7.07-.83,8.56a1.56,1.56,0,0,1-.93.93c-2.51.46-5.11.84-7.62,1.11a1.53,1.53,0,0,0-1.29.68L100.3,84.3a1.51,1.51,0,0,0,.43,1.4c1.58,2,3.16,4.07,4.6,6.18a1.51,1.51,0,0,1,0,1.31,37.71,37.71,0,0,1-5.45,6.64,41.31,41.31,0,0,1-6.63,5.46,1.53,1.53,0,0,1-1.32,0c-2.1-1.45-4.2-3-6.17-4.6a1.5,1.5,0,0,0-1.39-.44l-3.53,1.47a1.48,1.48,0,0,0-.68,1.29c-.28,2.51-.65,5.12-1.12,7.63a1.54,1.54,0,0,1-.92.93,33.49,33.49,0,0,1-8.55.83,39.74,39.74,0,0,1-8.54-.83,1.56,1.56,0,0,1-.93-.93c-.46-2.51-.84-5.12-1.11-7.63a1.5,1.5,0,0,0-.68-1.29l-3.53-1.47a1.51,1.51,0,0,0-1.4.44c-2,1.57-4.07,3.15-6.17,4.6a1.5,1.5,0,0,1-1.31,0c-4-1.22-7.42-1.59-12.29,6.9-4.43,7.73-4,15.86,5.81,20.5a69.64,69.64,0,0,0,42.89,5.62,67.22,67.22,0,0,0,41-23.93c12-14.4,17.27-31.1,16.12-49.78'/></svg>



                    ")
                  Height: =Parent.Height * 0.75
                  HoverBorderColor: =ColorFade(varColorYes, 20%)
                  HoverFill: =ColorFade(varColorAccent, 75%)
                  LayoutMinHeight: =10
                  LayoutMinWidth: =10
                  RadiusBottomLeft: =Self.Width/2
                  RadiusBottomRight: =Self.Width/2
                  RadiusTopLeft: =Self.Width/2
                  RadiusTopRight: =Self.Width/2
                  Width: =Self.Height
                  X: =Parent.Width * 0.99 - Self.Width - oee_h_n_bugs.Width - Parent.Width * 0.015
                  Y: =Parent.Height/2 - Self.Height/2
    - oee_body:
        Control: GroupContainer
        Variant: horizontalAutoLayoutContainer
        Properties:
          AlignInContainer: =AlignInContainer.SetByContainer
          DropShadow: =DropShadow.None
          FillPortions: =11
          LayoutAlignItems: =LayoutAlignItems.Stretch
          LayoutMinHeight: =10
          LayoutMinWidth: =10
          LayoutMode: =LayoutMode.Auto
          RadiusBottomLeft: =0
          RadiusBottomRight: =0
          RadiusTopLeft: =0
          RadiusTopRight: =0
        Children:
        - oee_nav:
            Control: GroupContainer
            Variant: horizontalAutoLayoutContainer
            Properties:
              AlignInContainer: =AlignInContainer.SetByContainer
              DropShadow: =DropShadow.None
              Fill: =varColor3
              LayoutAlignItems: =LayoutAlignItems.Stretch
              LayoutDirection: =LayoutDirection.Vertical
              LayoutGap: =locPadding
              LayoutMinHeight: =10
              LayoutMinWidth: =10
              LayoutMode: =LayoutMode.Auto
              PaddingBottom: =locPadding
              PaddingLeft: =locPadding
              PaddingRight: =locPadding
              PaddingTop: =locPadding
              RadiusBottomLeft: =0
              RadiusBottomRight: =0
              RadiusTopLeft: =0
              RadiusTopRight: =0
            Children:
            - oee_n_title:
                Control: Text
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  Size: =Self.Height / 3
                  Text: ="OEE Analysis"
                  VerticalAlign: ='TextCanvas.VerticalAlign'.Middle
                  Weight: ='TextCanvas.Weight'.Semibold
                  FillPortions: =1
                  LayoutMinHeight: =10
                  LayoutMinWidth: =10
            - oee_n_seperator:
                Control: Rectangle
                Properties:
                  Height: =1
                  LayoutMinWidth: =10
            - oee_n_home:
                Control: Classic/Button
                Properties:
                  OnSelect: =Navigate(Home);
                  Text: ="Home"
                  Color: =varColor0
                  DisplayMode: =If(App.ActiveScreen.Name = "Home", DisplayMode.Disabled, DisplayMode.Edit)
                  Fill: =varColorAccent
                  FillPortions: =1
                  FontWeight: =FontWeight.Normal
                  LayoutMinHeight: =10
                  LayoutMinWidth: =10
                  Size: =Self.Width / 16
            - oee_n_dor:
                Control: Classic/Button
                Properties:
                  OnSelect: =Navigate(DOR);
                  Text: ="Daily Operations Report"
                  Color: =varColor0
                  DisplayMode: =If(App.ActiveScreen.Name = "DOR", DisplayMode.Disabled, DisplayMode.Edit)
                  Fill: =varColorAccent
                  FillPortions: =1
                  FontWeight: =FontWeight.Normal
                  LayoutMinHeight: =10
                  LayoutMinWidth: =10
                  Size: =Self.Width / 16
            - oee_n_outputs:
                Control: Classic/Button
                Properties:
                  OnSelect: =Navigate(Outputs);
                  Text: ="Outputs"
                  Color: =varColor0
                  DisplayMode: =If(App.ActiveScreen.Name = "Outputs", DisplayMode.Disabled, DisplayMode.Edit)
                  Fill: =varColorAccent
                  FillPortions: =1
                  FontWeight: =FontWeight.Normal
                  LayoutMinHeight: =10
                  LayoutMinWidth: =10
                  Size: =Self.Width / 16
            - oee_n_downtime:
                Control: Classic/Button
                Properties:
                  OnSelect: =Navigate(Downtime_Screen);
                  Text: ="Downtime"
                  Color: =varColor0
                  DisplayMode: =If(App.ActiveScreen.Name = "Downtime_View", DisplayMode.Disabled, DisplayMode.Edit)
                  Fill: =varColorAccent
                  FillPortions: =1
                  FontWeight: =FontWeight.Normal
                  LayoutMinHeight: =10
                  LayoutMinWidth: =10
                  Size: =Self.Width / 16
            - oee_n_hourly:
                Control: Classic/Button
                Properties:
                  OnSelect: =Navigate(Hourly);
                  Text: ="Hour by Hour"
                  Color: =varColor0
                  DisplayMode: =If(App.ActiveScreen.Name = "Hourly", DisplayMode.Disabled, DisplayMode.Edit)
                  Fill: =varColorAccent
                  FillPortions: =1
                  FontWeight: =FontWeight.Normal
                  LayoutMinHeight: =10
                  LayoutMinWidth: =10
                  Size: =Self.Width / 16
            - oee_n_errors:
                Control: Classic/Button
                Properties:
                  OnSelect: =Navigate(Errors);
                  Text: ="Error Tracking"
                  Color: =varColor0
                  DisplayMode: =If(App.ActiveScreen.Name = "Errors", DisplayMode.Disabled, DisplayMode.Edit)
                  Fill: =varColorAccent
                  FillPortions: =1
                  FontWeight: =FontWeight.Normal
                  LayoutMinHeight: =10
                  LayoutMinWidth: =10
                  Size: =Self.Width / 16
            - oee_n_oee:
                Control: Classic/Button
                Properties:
                  OnSelect: =Navigate(OEE);
                  Text: ="OEE Analysis"
                  Color: =varColor0
                  DisplayMode: =If(App.ActiveScreen.Name = "OEE", DisplayMode.Disabled, DisplayMode.Edit)
                  Fill: =varColorAccent
                  FillPortions: =1
                  FontWeight: =FontWeight.Normal
                  LayoutMinHeight: =10
                  LayoutMinWidth: =10
                  Size: =Self.Width / 16
            - oee_n_catalog:
                Control: Classic/Button
                Properties:
                  OnSelect: =Navigate(Catalog);
                  Text: ="Catalog Analysis"
                  Color: =varColor0
                  DisplayMode: =If(App.ActiveScreen.Name = "Catalog", DisplayMode.Disabled, DisplayMode.Edit)
                  Fill: =varColorAccent
                  FillPortions: =1
                  FontWeight: =FontWeight.Normal
                  LayoutMinHeight: =10
                  LayoutMinWidth: =10
                  Size: =Self.Width / 16
            - oee_n_trend:
                Control: Classic/Button
                Properties:
                  OnSelect: =Navigate(Trend);
                  Text: ="OEE Trend Analysis"
                  Color: =varColor0
                  DisplayMode: =If(App.ActiveScreen.Name = "Trend", DisplayMode.Disabled, DisplayMode.Edit)
                  Fill: =varColorAccent
                  FillPortions: =1
                  FontWeight: =FontWeight.Normal
                  LayoutMinHeight: =10
                  LayoutMinWidth: =10
                  Size: =Self.Width / 16
            - oee_n_footer:
                Control: GroupContainer
                Variant: manualLayoutContainer
                Properties:
                  AlignInContainer: =AlignInContainer.SetByContainer
                  DropShadow: =DropShadow.None
                  FillPortions: =6
                  LayoutMinHeight: =10
                  LayoutMinWidth: =10
                  RadiusBottomLeft: =0
                  RadiusBottomRight: =0
                  RadiusTopLeft: =0
                  RadiusTopRight: =0
                Children:
                - oee_n_f_text:
                    Control: Text
                    Properties:
                      Align: ='TextCanvas.Align'.Center
                      Size: =8
                      Text: ="MilliporeSigma is the U.S. and Canada Life Science business of Merck KGaA, Darmstadt, Germany."
                      VerticalAlign: ='TextCanvas.VerticalAlign'.Bottom
                      Height: =Parent.Height
                      Width: =Parent.Width
        - oee_main:
            Control: GroupContainer
            Variant: horizontalAutoLayoutContainer
            Properties:
              AlignInContainer: =AlignInContainer.SetByContainer
              DropShadow: =DropShadow.None
              FillPortions: =9
              LayoutAlignItems: =LayoutAlignItems.Stretch
              LayoutGap: =locPadding
              LayoutMinHeight: =10
              LayoutMinWidth: =10
              LayoutMode: =LayoutMode.Auto
              PaddingBottom: =locPadding
              PaddingLeft: =locPadding
              PaddingRight: =locPadding
              PaddingTop: =locPadding
              RadiusBottomLeft: =0
              RadiusBottomRight: =0
              RadiusTopLeft: =0
              RadiusTopRight: =0
            Children:
            - oee_controls:
                Control: GroupContainer
                Variant: horizontalAutoLayoutContainer
                Properties:
                  AlignInContainer: =AlignInContainer.SetByContainer
                  Fill: =varColor4
                  LayoutAlignItems: =LayoutAlignItems.Stretch
                  LayoutDirection: =LayoutDirection.Vertical
                  LayoutGap: =locPadding
                  LayoutMinHeight: =10
                  LayoutMinWidth: =10
                  LayoutMode: =LayoutMode.Auto
                  PaddingBottom: =locPadding
                  PaddingLeft: =locPadding
                  PaddingRight: =locPadding
                  PaddingTop: =locPadding
                Children:
                - oee_start_date_title:
                    Control: Text
                    Properties:
                      Align: ='TextCanvas.Align'.Center
                      Size: =Self.Height / 3
                      Text: ="Starting Date"
                      FillPortions: =1
                      LayoutMinHeight: =10
                      LayoutMinWidth: =10
                - oee_start_date:
                    Control: DatePicker
                    Properties:
                      FontSize: =Self.Width / 10
                      Format: ="Short"
                      SelectedDate: =varNowDay
                      FillPortions: =1
                      LayoutMinHeight: =10
                      LayoutMinWidth: =10
                - oee_seperator_0:
                    Control: Rectangle
                    Properties:
                      Height: =1
                      LayoutMinWidth: =10
                - oee_end_date_title:
                    Control: Text
                    Properties:
                      Align: ='TextCanvas.Align'.Center
                      Size: =Self.Height / 3
                      Text: ="Ending Date"
                      FillPortions: =1
                      LayoutMinHeight: =10
                      LayoutMinWidth: =10
                - oee_end_date:
                    Control: DatePicker
                    Properties:
                      FontSize: =Self.Width / 10
                      Format: ="Short"
                      SelectedDate: =varNowDay
                      FillPortions: =1
                      LayoutMinHeight: =10
                      LayoutMinWidth: =10
                - oee_seperator_1:
                    Control: Rectangle
                    Properties:
                      Height: =1
                      LayoutMinWidth: =10
                - oee_button:
                    Control: Classic/Button
                    Properties:
                      OnSelect: =Select(oee_collect);
                      Text: ="Update Date Range"
                      Color: =varColor0
                      Fill: =varColorAccent
                      FillPortions: =1
                      FontWeight: =FontWeight.Normal
                      LayoutMinHeight: =10
                      LayoutMinWidth: =10
                      Size: =Self.Width / 16
                - oee_seperator_2:
                    Control: Rectangle
                    Properties:
                      Height: =1
                      LayoutMinWidth: =10
                - oee_line_title:
                    Control: Text
                    Properties:
                      Align: ='TextCanvas.Align'.Center
                      Size: =Self.Height / 3
                      Text: ="Line"
                      FillPortions: =1
                      LayoutMinHeight: =10
                      LayoutMinWidth: =10
                - oee_line:
                    Control: DropDown
                    Variant: pcfdataset
                    Properties:
                      OnChange: =Select(oee_update);
                      Appearance: ='DropdownCanvas.Appearance'.FilledDarker
                      DefaultSelectedItems: |-
                        ={Value: "All"}
                      FontSize: =Self.Width / 10
                      Items: =["All", "Only SSCs", "Only XLs", "Only XLTs", "SSC", "SSC2", "XL1", "XL2", "XL3", "XL4", "XL5", "XLT", "XLT2", "XLT3"]
                      FillPortions: =1
                      LayoutMinHeight: =10
                      LayoutMinWidth: =10
                - oee_seperator_3:
                    Control: Rectangle
                    Properties:
                      Height: =1
                      LayoutMinWidth: =10
                - oee_downtime_title:
                    Control: Text
                    Properties:
                      Align: ='TextCanvas.Align'.Center
                      Size: =Self.Height / 3
                      Text: ="Downtime"
                      FillPortions: =1
                      LayoutMinHeight: =10
                      LayoutMinWidth: =10
                - oee_downtime:
                    Control: DropDown
                    Variant: pcfdataset
                    Properties:
                      Appearance: ='DropdownCanvas.Appearance'.FilledDarker
                      DefaultSelectedItems: |-
                        ={Value: "All Downtime"}
                      FontSize: =Self.Width / 10
                      Items: =["All Downtime", "Unplanned Only"]
                      FillPortions: =1
                      LayoutMinHeight: =10
                      LayoutMinWidth: =10
                - oee_c_footer:
                    Control: GroupContainer
                    Variant: manualLayoutContainer
                    Properties:
                      AlignInContainer: =AlignInContainer.SetByContainer
                      DropShadow: =DropShadow.None
                      FillPortions: =7
                      LayoutMinHeight: =10
                      LayoutMinWidth: =10
                      RadiusBottomLeft: =0
                      RadiusBottomRight: =0
                      RadiusTopLeft: =0
                      RadiusTopRight: =0
            - oee_section_0:
                Control: GroupContainer
                Variant: verticalAutoLayoutContainer
                Properties:
                  AlignInContainer: =AlignInContainer.SetByContainer
                  DropShadow: =DropShadow.None
                  FillPortions: =9
                  LayoutAlignItems: =LayoutAlignItems.Stretch
                  LayoutMinHeight: =10
                  LayoutMinWidth: =10
                  LayoutMode: =LayoutMode.Auto
                  PaddingLeft: =
                  RadiusBottomLeft: =0
                  RadiusBottomRight: =0
                  RadiusTopLeft: =0
                  RadiusTopRight: =0
                Children:
                - oee_section_1:
                    Control: GroupContainer
                    Variant: horizontalAutoLayoutContainer
                    Properties:
                      AlignInContainer: =AlignInContainer.SetByContainer
                      DropShadow: =DropShadow.None
                      FillPortions: =2.5
                      LayoutAlignItems: =LayoutAlignItems.Stretch
                      LayoutDirection: =LayoutDirection.Vertical
                      LayoutGap: =locPadding/2
                      LayoutMinHeight: =10
                      LayoutMinWidth: =10
                      LayoutMode: =LayoutMode.Auto
                      PaddingBottom: =Self.LayoutGap
                      PaddingLeft: =Self.LayoutGap
                      PaddingRight: =Self.LayoutGap
                      RadiusBottomLeft: =0
                      RadiusBottomRight: =0
                      RadiusTopLeft: =0
                      RadiusTopRight: =0
                    Children:
                    - oee_average:
                        Control: GroupContainer
                        Variant: verticalAutoLayoutContainer
                        Properties:
                          AlignInContainer: =AlignInContainer.SetByContainer
                          DropShadow: =DropShadow.Semilight
                          Fill: =varColor4
                          LayoutAlignItems: =LayoutAlignItems.Stretch
                          LayoutDirection: =LayoutDirection.Vertical
                          LayoutMinHeight: =10
                          LayoutMinWidth: =10
                          LayoutMode: =LayoutMode.Auto
                        Children:
                        - oee_average_title:
                            Control: Label
                            Properties:
                              Text: =Concatenate(oee_line.Selected.Value," OEE2")
                              Align: =Align.Center
                              Color: =varColor5
                              Fill: =varColor2
                              FillPortions: =1
                              Font: =Font.Verdana
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              Size: =Self.Height / 3
                        - oee_ave_layout:
                            Control: GroupContainer
                            Variant: horizontalAutoLayoutContainer
                            Properties:
                              FillPortions: =7
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              LayoutMode: =LayoutMode.Auto
                            Children:
                            - oee_average_graph:
                                Control: Image
                                Properties:
                                  Image: |-
                                    ="https://quickchart.io/chart?width=" &Self.Width& "&height=" &Self.Height*0.90& "&c=" & 
                                    EncodeUrl(
                                    "{
                                      type: 'radialGauge',
                                      data: {
                                        datasets: [{
                                          data: ["& Last(collectOEE2).OEE2 &"],
                                          backgroundColor: getGradientFillHelper('horizontal', ['blue','blue','blue','red','red','red']),
                                        }]
                                      },
                                      options: {
                                        domain: [0, "& If(Last(collectOEE2).OEE2 <= 100, 100, Last(collectOEE2).OEE2) &"],
                                        trackColor: 'white', 
                                        centerPercentage: 90,
                                        centerArea: {
                                          text: (val) => val + '%',
                                          fontColor: 'black'
                                        },
                                      }
                                    }"
                                    )
                                  AlignInContainer: =AlignInContainer.Stretch
                                  FillPortions: =2
                                  Height: =Self.Width
                                  PaddingLeft: =locPadding/2
                                  PaddingRight: =locPadding/2
                            - oee_ave_data:
                                Control: GroupContainer
                                Variant: verticalAutoLayoutContainer
                                Properties:
                                  AlignInContainer: =AlignInContainer.SetByContainer
                                  BorderThickness: =1
                                  DropShadow: =DropShadow.None
                                  FillPortions: =4
                                  LayoutAlignItems: =LayoutAlignItems.Stretch
                                  LayoutDirection: =LayoutDirection.Vertical
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: =10
                                  LayoutMode: =LayoutMode.Auto
                                  RadiusBottomLeft: =0
                                  RadiusBottomRight: =0
                                  RadiusTopLeft: =0
                                  RadiusTopRight: =0
                                Children:
                                - oee_ave_upper:
                                    Control: GroupContainer
                                    Variant: horizontalAutoLayoutContainer
                                    Properties:
                                      AlignInContainer: =AlignInContainer.SetByContainer
                                      DropShadow: =DropShadow.None
                                      LayoutAlignItems: =LayoutAlignItems.Stretch
                                      LayoutMinHeight: =10
                                      LayoutMinWidth: =10
                                      LayoutMode: =LayoutMode.Auto
                                      RadiusBottomLeft: =0
                                      RadiusBottomRight: =0
                                      RadiusTopLeft: =0
                                      RadiusTopRight: =0
                                    Children:
                                    - oee_ave_built_parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          BorderThickness: =1
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: '=10  '
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee_ave_built_title:
                                            Control: Label
                                            Properties:
                                              Text: ="Total Units"
                                              Align: =Align.Center
                                              Color: =varColor5
                                              Fill: =varColor3
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee_ave_built:
                                            Control: Label
                                            Properties:
                                              Text: =First(collectOEE2).total*1
                                              Align: =Align.Center
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              FontWeight: =FontWeight.Semibold
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 3
                                              Width: =10
                                    - oee_ave_good_parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          BorderThickness: =1
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee_ave_good_title:
                                            Control: Label
                                            Properties:
                                              Text: ="Good Units"
                                              Align: =Align.Center
                                              Color: =varColor5
                                              Fill: =varColor3
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee_ave_good:
                                            Control: Label
                                            Properties:
                                              Text: =First(collectOEE2).output
                                              Align: =Align.Center
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 3.5
                                              Width: =10
                                    - oee_ave_reject_parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          BorderThickness: =1
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee_ave_reject_title:
                                            Control: Label
                                            Properties:
                                              Text: ="Reject Units"
                                              Align: =Align.Center
                                              Color: =varColor5
                                              Fill: =varColor3
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee_ave_reject:
                                            Control: Label
                                            Properties:
                                              Text: =First(collectOEE2).rejects
                                              Align: =Align.Center
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 3.5
                                              Width: =10
                                - oee_average_middle:
                                    Control: GroupContainer
                                    Variant: horizontalAutoLayoutContainer
                                    Properties:
                                      AlignInContainer: =AlignInContainer.SetByContainer
                                      DropShadow: =DropShadow.None
                                      LayoutAlignItems: =LayoutAlignItems.Stretch
                                      LayoutMinHeight: =10
                                      LayoutMinWidth: =10
                                      LayoutMode: =LayoutMode.Auto
                                      RadiusBottomLeft: =0
                                      RadiusBottomRight: =0
                                      RadiusTopLeft: =0
                                      RadiusTopRight: =0
                                    Children:
                                    - oee_ave_constraint_parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          BorderThickness: =1
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: '=10  '
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee_ave_constraint_title:
                                            Control: Label
                                            Properties:
                                              Text: ="Constraint Goal Units"
                                              Align: =Align.Center
                                              Color: =varColor5
                                              Fill: =varColor3
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee_ave_constraint:
                                            Control: Label
                                            Properties:
                                              Text: =Round(First(collectOEE2).constraint_goal*1,0)
                                              Align: =Align.Center
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 3.5
                                              Width: =10
                                    - oee_ave_target_parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          BorderThickness: =1
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: '=10  '
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee_ave_target_title:
                                            Control: Label
                                            Properties:
                                              Text: ="Target Units"
                                              Align: =Align.Center
                                              Color: =varColor5
                                              Fill: =varColor3
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee_ave_target:
                                            Control: Label
                                            Properties:
                                              Text: =First(collectOEE2).target
                                              Align: =Align.Center
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 3.5
                                              Width: =10
                                - oee_average_lower:
                                    Control: GroupContainer
                                    Variant: horizontalAutoLayoutContainer
                                    Properties:
                                      AlignInContainer: =AlignInContainer.SetByContainer
                                      DropShadow: =DropShadow.None
                                      LayoutAlignItems: =LayoutAlignItems.Stretch
                                      LayoutMinHeight: =10
                                      LayoutMinWidth: =10
                                      LayoutMode: =LayoutMode.Auto
                                      RadiusBottomLeft: =0
                                      RadiusBottomRight: =0
                                      RadiusTopLeft: =0
                                      RadiusTopRight: =0
                                    Children:
                                    - oee_ave_unplanned_parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          BorderThickness: =1
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee_ave_unplanned_title:
                                            Control: Label
                                            Properties:
                                              Text: ="Unplanned Downtime"
                                              Align: =Align.Center
                                              Color: =varColor5
                                              Fill: =varColor3
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee_ave_unplanned:
                                            Control: Label
                                            Properties:
                                              Text: =RoundDown(First(collectOEE2).downtime_unplanned/60,0) &"H "& Mod(First(collectOEE2).downtime_unplanned*60,60) & "m"
                                              Align: =Align.Center
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4
                                              Width: =10
                                    - oee_ave_planned_parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          BorderThickness: =1
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee_ave_planned_title:
                                            Control: Label
                                            Properties:
                                              Text: ="Planned Downtime"
                                              Align: =Align.Center
                                              Color: =varColor5
                                              Fill: =varColor3
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee_ave_planned:
                                            Control: Label
                                            Properties:
                                              Text: =RoundDown(First(collectOEE2).downtime_planned/60,0) &"H "& Mod(First(collectOEE2).downtime_planned*60,60) & "m"
                                              Align: =Align.Center
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4
                                              Width: =10
                                    - oee_ave_possible_parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          BorderThickness: =1
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee_ave_possible_title:
                                            Control: Label
                                            Properties:
                                              Text: ="Possible Runtime"
                                              Align: =Align.Center
                                              Color: =varColor5
                                              Fill: =varColor3
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee_ave_possible:
                                            Control: Label
                                            Properties:
                                              Text: =First(collectOEE2).runtime_total*1 & "H"
                                              Align: =Align.Center
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4
                                              Width: =10
                    - oee_pareto:
                        Control: Image
                        Properties:
                          Image: |-
                            ="https://quickchart.io/chart?width=" & Self.Width & "&height=" & Self.Height*0.90 & "&c=" & 
                            EncodeUrl("
                            {
                              type: 'bar',
                              data: {
                                labels: " & Concatenate("['", Concat(Sort(Filter(collectTopDowntime, If(oee_downtime.Selected.Value = "Unplanned Only", And(Not(Downtime_Reason = "No Scheduled Work"),Not(Downtime_Reason = "Engineering DT"),Not(Downtime_Reason = "Planned Downtime")), Downtime_Reason = Downtime_Reason)), Downtime_Total, SortOrder.Descending), ThisRecord.Downtime_Reason, "', '"), "']") & ",
                                datasets: [{
                                  label: 'Frequency',
                                  data: " & Concatenate("['", Concat(Sort(Filter(collectTopDowntime, If(oee_downtime.Selected.Value = "Unplanned Only", And(Not(Downtime_Reason = "No Scheduled Work"),Not(Downtime_Reason = "Engineering DT"),Not(Downtime_Reason = "Planned Downtime")), Downtime_Reason = Downtime_Reason)), Downtime_Total, SortOrder.Descending), ThisRecord.Downtime_Total, "', '"), "']") & ",
                                  backgroundColor: 'rgba(0, 123, 255, 0.7)'
                                }, {
                                  label: 'Cumulative Percentage',
                                  data: " & Concatenate("['", Concat(Sort(collectPareto, freq, SortOrder.Descending), ThisRecord.cumulative, "', '"), "']") & ",
                                  type: 'line',
                                  borderColor: 'red',
                                  fill: false,
                                  yAxisID: 'right-y-axis' // Assign to the right Y-axis
                                }]
                              },
                              options: {
                                scales: {
                                  yAxes: [{
                                    id: 'left-y-axis',
                                    type: 'linear',
                                    position: 'left',
                                    ticks: {
                                      beginAtZero: true
                                    }
                                  }, {
                                    id: 'right-y-axis',
                                    type: 'linear',
                                    position: 'right',
                                    ticks: {
                                      beginAtZero: true,
                                      max: 100,
                                      stepSize: 20,
                                      callback: function(value, index, values) {
                                        return value + '%';
                                      }
                                    },
                                    gridLines: { 
                                      drawOnChartArea: false
                                    }
                                  }]
                                },
                                tooltips: {
                                  mode: 'index',
                                  intersect: false
                                },
                                annotation: {
                                  annotations: [{
                                    type: 'line',
                                    mode: 'horizontal',
                                    scaleID: 'right-y-axis',
                                    value: 80,
                                    borderColor: 'red',
                                    borderWidth: 2,
                                    label: {
                                      enabled: true,
                                      position: 'right',
                                      content: '80% Threshold'
                                    }
                                  },
                                  {
                                    type: 'line',
                                    mode: 'vertical',
                                    scaleID: 'x-axis-0',
                                    value: ["& First(Sort(Filter(collectPareto, cumulative >= 80), freq, SortOrder.Descending)).id-1 &"],
                                    borderColor: 'green',
                                    borderWidth: 2,
                                    label: {
                                      enabled: true,
                                      content: '80% Volume',
                                      position: 'top',
                                      backgroundColor: 'rgba(72, 72, 192, 0.5)'
                                    }
                                  }]
                                }
                              }
                            }")
                          FillPortions: =1
                          Height: =Parent.Height
                          LayoutMinHeight: =10
                          LayoutMinWidth: =10
                          Width: =Parent.Width
                          X: =Parent.Width/2 - Self.Width/2
                          Y: =Parent.Height/2 - Self.Height/2
                - oee_section_2:
                    Control: GroupContainer
                    Variant: horizontalAutoLayoutContainer
                    Properties:
                      AlignInContainer: =AlignInContainer.SetByContainer
                      DropShadow: =DropShadow.None
                      LayoutAlignItems: =LayoutAlignItems.Stretch
                      LayoutDirection: =LayoutDirection.Vertical
                      LayoutGap: =locPadding/2
                      LayoutMinHeight: =10
                      LayoutMinWidth: =10
                      LayoutMode: =LayoutMode.Auto
                      PaddingBottom: =Self.LayoutGap
                      PaddingLeft: =Self.LayoutGap
                      PaddingRight: =Self.LayoutGap
                      RadiusBottomLeft: =0
                      RadiusBottomRight: =0
                      RadiusTopLeft: =0
                      RadiusTopRight: =0
                    Children:
                    - oee_top_downtime:
                        Control: GroupContainer
                        Variant: verticalAutoLayoutContainer
                        Properties:
                          AlignInContainer: =AlignInContainer.SetByContainer
                          DropShadow: =DropShadow.Semilight
                          Height: =50
                          LayoutAlignItems: =LayoutAlignItems.Stretch
                          LayoutDirection: =LayoutDirection.Vertical
                          LayoutMinWidth: =10
                          LayoutMode: =LayoutMode.Auto
                          PaddingBottom: =
                          PaddingLeft: =
                          PaddingRight: =
                          PaddingTop: =
                          Width: =Parent.Width * 0.85
                        Children:
                        - oee_td_header:
                            Control: GroupContainer
                            Variant: manualLayoutContainer
                            Properties:
                              AlignInContainer: =AlignInContainer.SetByContainer
                              DropShadow: =DropShadow.None
                              Fill: =varColor2
                              LayoutMinHeight: =1
                              LayoutMinWidth: =1
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                              Width: =Parent.Width
                            Children:
                            - oee_td_h_title:
                                Control: Label
                                Properties:
                                  Text: ="Downtime Breakdown"
                                  Align: =Align.Center
                                  Color: =varColor5
                                  Font: =Font.Verdana
                                  Height: =Parent.Height
                                  Size: =Self.Height / 3
                                  Width: =Parent.Width
                        - oee_td_columns:
                            Control: GroupContainer
                            Variant: manualLayoutContainer
                            Properties:
                              AlignInContainer: =AlignInContainer.SetByContainer
                              DropShadow: =DropShadow.None
                              Fill: =varColor3
                              LayoutMinHeight: =1
                              LayoutMinWidth: =1
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                              Width: =Parent.Width
                            Children:
                            - oee_td_c_amount:
                                Control: Label
                                Properties:
                                  Text: ="Amount"
                                  Align: =Align.Center
                                  Color: =varColor5
                                  Font: =Font.Verdana
                                  Height: =Parent.Height
                                  Size: =Self.Width / 10
                                  Width: =Parent.Width / 2
                                  X: =oee_td_c_reason.X + oee_td_c_reason.Width
                            - oee_td_c_reason:
                                Control: Label
                                Properties:
                                  Text: ="Reason"
                                  Align: =Align.Center
                                  Color: =varColor5
                                  Font: =Font.Verdana
                                  Height: =Parent.Height
                                  Size: =Self.Width / 10
                                  Width: =Parent.Width / 2
                        - oee_td_gallery:
                            Control: Gallery
                            Variant: galleryVertical
                            Properties:
                              Items: |-
                                =Sort(
                                    Filter(
                                        collectTopDowntime,
                                        If(
                                            oee_downtime.Selected.Value = "Unplanned Only",
                                            And(Not(Downtime_Reason = "Planned Downtime"), Not(Downtime_Reason = "Engineering DT"), Not(Downtime_Reason = "No Scheduled Work")),
                                            true
                                        )
                                    ),
                                    Downtime_Total,
                                    SortOrder.Descending
                                )
                              AlignInContainer: =AlignInContainer.SetByContainer
                              DelayItemLoading: =true
                              FillPortions: =14
                              Layout: =Layout.Vertical
                              LayoutMinHeight: =1
                              LayoutMinWidth: =1
                              LoadingSpinner: =LoadingSpinner.Data
                              TemplatePadding: =0
                              TemplateSize: =Self.Height / 14
                            Children:
                            - oee_td_g_amount:
                                Control: Label
                                Properties:
                                  OnSelect: =Select(Parent)
                                  Text: =RoundDown(ThisItem.Downtime_Total/60,0) & "H " & Mod(ThisItem.Downtime_Total,60) & "m"
                                  Align: =Align.Center
                                  Font: =Font.Verdana
                                  Height: =Parent.TemplateHeight - oee_td_g_seperator.Height
                                  Size: =Self.Width / 12
                                  Width: =Parent.TemplateWidth/2
                                  X: =oee_td_g_reason.X + oee_td_g_reason.Width
                                  Y: =1-1
                            - oee_td_g_reason:
                                Control: Label
                                Properties:
                                  OnSelect: =Select(Parent)
                                  Text: =ThisItem.Downtime_Reason
                                  Align: =Align.Center
                                  Font: =Font.Verdana
                                  Height: =Parent.TemplateHeight - oee_td_g_seperator.Height
                                  Size: =Self.Width / 14
                                  Width: =Parent.TemplateWidth/2
                                  X: =1-1
                                  Y: =1-1
                            - oee_td_g_seperator:
                                Control: Rectangle
                                Properties:
                                  OnSelect: =Select(Parent)
                                  Fill: =varColor1
                                  Height: =Parent.TemplateHeight * 0.025
                                  Width: =Parent.Width
                                  Y: =Parent.TemplateHeight - Self.Height
                - oee_section_3:
                    Control: GroupContainer
                    Variant: horizontalAutoLayoutContainer
                    Properties:
                      AlignInContainer: =AlignInContainer.SetByContainer
                      DropShadow: =DropShadow.None
                      FillPortions: =2.5
                      LayoutAlignItems: =LayoutAlignItems.Stretch
                      LayoutDirection: =LayoutDirection.Vertical
                      LayoutGap: =locPadding/2
                      LayoutMinHeight: =10
                      LayoutMinWidth: =10
                      LayoutMode: =LayoutMode.Auto
                      PaddingBottom: =Self.LayoutGap
                      PaddingLeft: =Self.LayoutGap
                      PaddingRight: =Self.LayoutGap
                      RadiusBottomLeft: =0
                      RadiusBottomRight: =0
                      RadiusTopLeft: =0
                      RadiusTopRight: =0
                    Children:
                    - oee_shift_c:
                        Control: GroupContainer
                        Variant: verticalAutoLayoutContainer
                        Properties:
                          AlignInContainer: =AlignInContainer.SetByContainer
                          DropShadow: =DropShadow.Semilight
                          LayoutAlignItems: =LayoutAlignItems.Stretch
                          LayoutDirection: =LayoutDirection.Vertical
                          LayoutMinHeight: =10
                          LayoutMinWidth: =10
                          LayoutMode: =LayoutMode.Auto
                          PaddingLeft: =
                        Children:
                        - oee_c_title:
                            Control: Label
                            Properties:
                              Text: ="C Shift"
                              Align: =Align.Center
                              Color: =varColor5
                              Fill: =varColor2
                              FillPortions: =1
                              Font: =Font.Verdana
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              Size: =Self.Height / 3
                        - oee_c_layout:
                            Control: GroupContainer
                            Variant: horizontalAutoLayoutContainer
                            Properties:
                              AlignInContainer: =AlignInContainer.SetByContainer
                              DropShadow: =DropShadow.None
                              FillPortions: =5
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              LayoutMode: =LayoutMode.Auto
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                            Children:
                            - oee_c_graph:
                                Control: Image
                                Properties:
                                  Image: |-
                                    ="https://quickchart.io/chart?width=" &Self.Width& "&height=" &Self.Height*0.90& "&c=" & 
                                    EncodeUrl(
                                    "{
                                      type: 'radialGauge',
                                      data: {
                                        datasets: [{
                                          data: ["& LookUp(collectShiftOEE, shift = "C").OEE2 &"],
                                          backgroundColor: getGradientFillHelper('horizontal', ['blue', 'red']),
                                        }]
                                      },
                                      options: {
                                        domain: [0, "& If(LookUp(collectShiftOEE, shift = "C").OEE2 <= 100, 100, LookUp(collectShiftOEE, shift = "C").OEE2) &"],
                                        trackColor: 'lightgray', 
                                        centerPercentage: 90,
                                        centerArea: {
                                          text: (val) => val + '%',
                                        },
                                      }
                                    }"
                                    )
                                  FillPortions: =2
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: =10
                            - oee_c_data:
                                Control: GroupContainer
                                Variant: verticalAutoLayoutContainer
                                Properties:
                                  AlignInContainer: =AlignInContainer.SetByContainer
                                  DropShadow: =DropShadow.None
                                  FillPortions: =4
                                  LayoutAlignItems: =LayoutAlignItems.Stretch
                                  LayoutDirection: =LayoutDirection.Vertical
                                  LayoutGap: =
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: =10
                                  LayoutMode: =LayoutMode.Auto
                                  RadiusBottomLeft: =0
                                  RadiusBottomRight: =0
                                  RadiusTopLeft: =0
                                  RadiusTopRight: =0
                                Children:
                                - oee_c_upper:
                                    Control: GroupContainer
                                    Variant: horizontalAutoLayoutContainer
                                    Properties:
                                      AlignInContainer: =AlignInContainer.SetByContainer
                                      DropShadow: =DropShadow.None
                                      LayoutAlignItems: =LayoutAlignItems.Stretch
                                      LayoutMinHeight: =10
                                      LayoutMinWidth: =10
                                      LayoutMode: =LayoutMode.Auto
                                      RadiusBottomLeft: =0
                                      RadiusBottomRight: =0
                                      RadiusTopLeft: =0
                                      RadiusTopRight: =0
                                    Children:
                                    - oee_c_built_parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee_c_built_title:
                                            Control: Label
                                            Properties:
                                              Text: ="Units Built"
                                              Align: =Align.Center
                                              Color: =varColor5
                                              Fill: =varColor3
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee_c_built:
                                            Control: Label
                                            Properties:
                                              Text: =LookUp(collectShiftOEE, shift = "C").output*1
                                              Align: =Align.Center
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: '=Self.Height / 3 '
                                              Width: =10
                                    - oee_c_goal_parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee_c_goal_title:
                                            Control: Label
                                            Properties:
                                              Text: ="Build Goal"
                                              Align: =Align.Center
                                              Color: =varColor5
                                              Fill: =varColor3
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee_c_goal:
                                            Control: Label
                                            Properties:
                                              Text: =Round(LookUp(collectShiftOEE, shift="C").constraint_goal,2)
                                              Align: =Align.Center
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 3
                                              Width: =10
                                    - oee_c_constraint_parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee_c_constraint_title:
                                            Control: Label
                                            Properties:
                                              Text: ="Constraint / hr"
                                              Align: =Align.Center
                                              Color: =varColor5
                                              Fill: =varColor3
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 5
                                              Width: =10
                                        - oee_c_constraint:
                                            Control: Label
                                            Properties:
                                              Text: =Round(LookUp(collectShiftOEE, shift="C").constraint_average,2)
                                              Align: =Align.Center
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 3
                                              Width: =10
                                - oee_c_lower:
                                    Control: GroupContainer
                                    Variant: horizontalAutoLayoutContainer
                                    Properties:
                                      AlignInContainer: =AlignInContainer.SetByContainer
                                      DropShadow: =DropShadow.None
                                      LayoutAlignItems: =LayoutAlignItems.Stretch
                                      LayoutMinHeight: =10
                                      LayoutMinWidth: =10
                                      LayoutMode: =LayoutMode.Auto
                                      RadiusBottomLeft: =0
                                      RadiusBottomRight: =0
                                      RadiusTopLeft: =0
                                      RadiusTopRight: =0
                                    Children:
                                    - oee_c_runtime_parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee_c_runtime_title:
                                            Control: Label
                                            Properties:
                                              Text: ="Runtime"
                                              Align: =Align.Center
                                              Color: =varColor5
                                              Fill: =varColor3
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee_c_runtime:
                                            Control: Label
                                            Properties:
                                              Text: =RoundDown(LookUp(collectShiftOEE, shift = "C").runtime_hours,0) &"H "& Mod(LookUp(collectShiftOEE, shift = "C").runtime_hours*60,60) & "m"
                                              Align: =Align.Center
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 3.5
                                              Width: =10
                                    - oee_c_downtime_parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee_c_downtime_title:
                                            Control: Label
                                            Properties:
                                              Text: ="Planned Downtime"
                                              Align: =Align.Center
                                              Color: =varColor5
                                              Fill: =varColor3
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 5.5
                                              Width: =10
                                        - oee_c_downtime:
                                            Control: Label
                                            Properties:
                                              Text: =RoundDown(LookUp(collectShiftOEE, shift = "C").downtime_planned/60,0) &"H "& Mod(LookUp(collectShiftOEE, shift = "C").downtime_planned,60) & "m"
                                              Align: =Align.Center
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 3.5
                                              Width: =10
                                    - oee_c_possible_parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee_c_possible_title:
                                            Control: Label
                                            Properties:
                                              Text: ="Possible Runtime"
                                              Align: =Align.Center
                                              Color: =varColor5
                                              Fill: =varColor3
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4
                                              Width: =10
                                        - oee_c_possible:
                                            Control: Label
                                            Properties:
                                              Text: =LookUp(collectShiftOEE, shift = "C").runtime_total*1 & "H"
                                              Align: =Align.Center
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 3.5
                                              Width: =10
                    - oee_shift_a:
                        Control: GroupContainer
                        Variant: verticalAutoLayoutContainer
                        Properties:
                          AlignInContainer: =AlignInContainer.SetByContainer
                          DropShadow: =DropShadow.Semilight
                          LayoutAlignItems: =LayoutAlignItems.Stretch
                          LayoutDirection: =LayoutDirection.Vertical
                          LayoutMinHeight: =10
                          LayoutMinWidth: =10
                          LayoutMode: =LayoutMode.Auto
                          PaddingLeft: =
                        Children:
                        - oee_a_title:
                            Control: Label
                            Properties:
                              Text: ="A Shift"
                              Align: =Align.Center
                              Color: =varColor5
                              Fill: =varColor2
                              FillPortions: =1
                              Font: =Font.Verdana
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              Size: =Self.Height / 3
                        - oee_a_layout:
                            Control: GroupContainer
                            Variant: horizontalAutoLayoutContainer
                            Properties:
                              AlignInContainer: =AlignInContainer.SetByContainer
                              DropShadow: =DropShadow.None
                              FillPortions: =5
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              LayoutMode: =LayoutMode.Auto
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                            Children:
                            - oee_a_graph:
                                Control: Image
                                Properties:
                                  Image: |-
                                    ="https://quickchart.io/chart?width=" &Self.Width& "&height=" &Self.Height*0.90& "&c=" & 
                                    EncodeUrl(
                                    "{
                                      type: 'radialGauge',
                                      data: {
                                        datasets: [{
                                          data: ["& LookUp(collectShiftOEE, shift = "A").OEE2 &"],
                                          backgroundColor: getGradientFillHelper('horizontal', ['blue', 'red']),
                                        }]
                                      },
                                      options: {
                                        domain: [0, "& If(LookUp(collectShiftOEE, shift = "A").OEE2 <= 100, 100, LookUp(collectShiftOEE, shift = "A").OEE2) &"],
                                        trackColor: 'lightgray', 
                                        centerPercentage: 90,
                                        centerArea: {
                                          text: (val) => val + '%',
                                        },
                                      }
                                    }"
                                    )
                                  FillPortions: =2
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: =10
                            - oee_a_data:
                                Control: GroupContainer
                                Variant: verticalAutoLayoutContainer
                                Properties:
                                  AlignInContainer: =AlignInContainer.SetByContainer
                                  DropShadow: =DropShadow.None
                                  FillPortions: =4
                                  LayoutAlignItems: =LayoutAlignItems.Stretch
                                  LayoutDirection: =LayoutDirection.Vertical
                                  LayoutGap: =
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: =10
                                  LayoutMode: =LayoutMode.Auto
                                  RadiusBottomLeft: =0
                                  RadiusBottomRight: =0
                                  RadiusTopLeft: =0
                                  RadiusTopRight: =0
                                Children:
                                - oee_a_upper:
                                    Control: GroupContainer
                                    Variant: horizontalAutoLayoutContainer
                                    Properties:
                                      AlignInContainer: =AlignInContainer.SetByContainer
                                      DropShadow: =DropShadow.None
                                      LayoutAlignItems: =LayoutAlignItems.Stretch
                                      LayoutMinHeight: =10
                                      LayoutMinWidth: =10
                                      LayoutMode: =LayoutMode.Auto
                                      RadiusBottomLeft: =0
                                      RadiusBottomRight: =0
                                      RadiusTopLeft: =0
                                      RadiusTopRight: =0
                                    Children:
                                    - oee_a_built_parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee_a_built_title:
                                            Control: Label
                                            Properties:
                                              Text: ="Units Built"
                                              Align: =Align.Center
                                              Color: =varColor5
                                              Fill: =varColor3
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee_a_built:
                                            Control: Label
                                            Properties:
                                              Text: =LookUp(collectShiftOEE, shift = "A").output*1
                                              Align: =Align.Center
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: '=Self.Height / 3 '
                                              Width: =10
                                    - oee_a_goal_parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee_a_goal_title:
                                            Control: Label
                                            Properties:
                                              Text: ="Build Goal"
                                              Align: =Align.Center
                                              Color: =varColor5
                                              Fill: =varColor3
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee_a_goal:
                                            Control: Label
                                            Properties:
                                              Text: =Round(LookUp(collectShiftOEE, shift="A").constraint_goal,2)
                                              Align: =Align.Center
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 3
                                              Width: =10
                                    - oee_a_constraint_parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee_a_constraint_title:
                                            Control: Label
                                            Properties:
                                              Text: ="Constraint / hr"
                                              Align: =Align.Center
                                              Color: =varColor5
                                              Fill: =varColor3
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 5
                                              Width: =10
                                        - oee_a_constraint:
                                            Control: Label
                                            Properties:
                                              Text: =Round(LookUp(collectShiftOEE, shift="A").constraint_average,2)
                                              Align: =Align.Center
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 3
                                              Width: =10
                                - oee_a_lower:
                                    Control: GroupContainer
                                    Variant: horizontalAutoLayoutContainer
                                    Properties:
                                      AlignInContainer: =AlignInContainer.SetByContainer
                                      DropShadow: =DropShadow.None
                                      LayoutAlignItems: =LayoutAlignItems.Stretch
                                      LayoutMinHeight: =10
                                      LayoutMinWidth: =10
                                      LayoutMode: =LayoutMode.Auto
                                      RadiusBottomLeft: =0
                                      RadiusBottomRight: =0
                                      RadiusTopLeft: =0
                                      RadiusTopRight: =0
                                    Children:
                                    - oee_a_runtime_parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee_a_runtime_title:
                                            Control: Label
                                            Properties:
                                              Text: ="Runtime"
                                              Align: =Align.Center
                                              Color: =varColor5
                                              Fill: =varColor3
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee_a_runtime:
                                            Control: Label
                                            Properties:
                                              Text: =RoundDown(LookUp(collectShiftOEE, shift = "A").runtime_hours,0) &"H "& Mod(LookUp(collectShiftOEE, shift = "A").runtime_hours*60,60) & "m"
                                              Align: =Align.Center
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 3.5
                                              Width: =10
                                    - oee_a_downtime_parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee_a_downtime_title:
                                            Control: Label
                                            Properties:
                                              Text: ="Planned Downtime"
                                              Align: =Align.Center
                                              Color: =varColor5
                                              Fill: =varColor3
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 5.5
                                              Width: =10
                                        - oee_a_downtime:
                                            Control: Label
                                            Properties:
                                              Text: =RoundDown(LookUp(collectShiftOEE, shift = "A").downtime_planned/60,0) &"H "& Mod(LookUp(collectShiftOEE, shift = "A").downtime_planned,60) & "m"
                                              Align: =Align.Center
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 3.5
                                              Width: =10
                                    - oee_a_possible_parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee_a_possible_title:
                                            Control: Label
                                            Properties:
                                              Text: ="Possible Runtime"
                                              Align: =Align.Center
                                              Color: =varColor5
                                              Fill: =varColor3
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4
                                              Width: =10
                                        - oee_a_possible:
                                            Control: Label
                                            Properties:
                                              Text: =LookUp(collectShiftOEE, shift = "A").runtime_total*1 & "H"
                                              Align: =Align.Center
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 3.5
                                              Width: =10
                    - oee_shift_b:
                        Control: GroupContainer
                        Variant: verticalAutoLayoutContainer
                        Properties:
                          AlignInContainer: =AlignInContainer.SetByContainer
                          DropShadow: =DropShadow.Semilight
                          LayoutAlignItems: =LayoutAlignItems.Stretch
                          LayoutDirection: =LayoutDirection.Vertical
                          LayoutMinHeight: =10
                          LayoutMinWidth: =10
                          LayoutMode: =LayoutMode.Auto
                          PaddingLeft: =
                        Children:
                        - oee_b_title:
                            Control: Label
                            Properties:
                              Text: ="B Shift"
                              Align: =Align.Center
                              Color: =varColor5
                              Fill: =varColor2
                              FillPortions: =1
                              Font: =Font.Verdana
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              Size: =Self.Height / 3
                        - oee_b_layout:
                            Control: GroupContainer
                            Variant: horizontalAutoLayoutContainer
                            Properties:
                              AlignInContainer: =AlignInContainer.SetByContainer
                              DropShadow: =DropShadow.None
                              FillPortions: =5
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              LayoutMode: =LayoutMode.Auto
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                            Children:
                            - oee_b_graph:
                                Control: Image
                                Properties:
                                  Image: |-
                                    ="https://quickchart.io/chart?width=" &Self.Width& "&height=" &Self.Height*0.90& "&c=" & 
                                    EncodeUrl(
                                    "{
                                      type: 'radialGauge',
                                      data: {
                                        datasets: [{
                                          data: ["& LookUp(collectShiftOEE, shift = "B").OEE2 &"],
                                          backgroundColor: getGradientFillHelper('horizontal', ['blue', 'red']),
                                        }]
                                      },
                                      options: {
                                        domain: [0, "& If(LookUp(collectShiftOEE, shift = "B").OEE2 <= 100, 100, LookUp(collectShiftOEE, shift = "B").OEE2) &"],
                                        trackColor: 'lightgray', 
                                        centerPercentage: 90,
                                        centerArea: {
                                          text: (val) => val + '%',
                                        },
                                      }
                                    }"
                                    )
                                  FillPortions: =2
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: =10
                            - oee_b_data:
                                Control: GroupContainer
                                Variant: verticalAutoLayoutContainer
                                Properties:
                                  AlignInContainer: =AlignInContainer.SetByContainer
                                  DropShadow: =DropShadow.None
                                  FillPortions: =4
                                  LayoutAlignItems: =LayoutAlignItems.Stretch
                                  LayoutDirection: =LayoutDirection.Vertical
                                  LayoutGap: =
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: =10
                                  LayoutMode: =LayoutMode.Auto
                                  RadiusBottomLeft: =0
                                  RadiusBottomRight: =0
                                  RadiusTopLeft: =0
                                  RadiusTopRight: =0
                                Children:
                                - oee_b_upper:
                                    Control: GroupContainer
                                    Variant: horizontalAutoLayoutContainer
                                    Properties:
                                      AlignInContainer: =AlignInContainer.SetByContainer
                                      DropShadow: =DropShadow.None
                                      LayoutAlignItems: =LayoutAlignItems.Stretch
                                      LayoutMinHeight: =10
                                      LayoutMinWidth: =10
                                      LayoutMode: =LayoutMode.Auto
                                      RadiusBottomLeft: =0
                                      RadiusBottomRight: =0
                                      RadiusTopLeft: =0
                                      RadiusTopRight: =0
                                    Children:
                                    - oee_b_built_parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee_b_built_title:
                                            Control: Label
                                            Properties:
                                              Text: ="Units Built"
                                              Align: =Align.Center
                                              Color: =varColor5
                                              Fill: =varColor3
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee_b_built:
                                            Control: Label
                                            Properties:
                                              Text: =LookUp(collectShiftOEE, shift = "B").output*1
                                              Align: =Align.Center
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: '=Self.Height / 3 '
                                              Width: =10
                                    - oee_b_goal_parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee_b_goal_title:
                                            Control: Label
                                            Properties:
                                              Text: ="Build Goal"
                                              Align: =Align.Center
                                              Color: =varColor5
                                              Fill: =varColor3
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee_b_goal:
                                            Control: Label
                                            Properties:
                                              Text: =Round(LookUp(collectShiftOEE, shift="B").constraint_goal,2)
                                              Align: =Align.Center
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 3
                                              Width: =10
                                    - oee_b_constraint_parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee_b_constraint_title:
                                            Control: Label
                                            Properties:
                                              Text: ="Constraint / hr"
                                              Align: =Align.Center
                                              Color: =varColor5
                                              Fill: =varColor3
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 5
                                              Width: =10
                                        - oee_b_constraint:
                                            Control: Label
                                            Properties:
                                              Text: =Round(LookUp(collectShiftOEE, shift="B").constraint_average,2)
                                              Align: =Align.Center
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 3
                                              Width: =10
                                - oee_b_lower:
                                    Control: GroupContainer
                                    Variant: horizontalAutoLayoutContainer
                                    Properties:
                                      AlignInContainer: =AlignInContainer.SetByContainer
                                      DropShadow: =DropShadow.None
                                      LayoutAlignItems: =LayoutAlignItems.Stretch
                                      LayoutMinHeight: =10
                                      LayoutMinWidth: =10
                                      LayoutMode: =LayoutMode.Auto
                                      RadiusBottomLeft: =0
                                      RadiusBottomRight: =0
                                      RadiusTopLeft: =0
                                      RadiusTopRight: =0
                                    Children:
                                    - oee_b_runtime_parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee_b_runtime_title:
                                            Control: Label
                                            Properties:
                                              Text: ="Runtime"
                                              Align: =Align.Center
                                              Color: =varColor5
                                              Fill: =varColor3
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee_b_runtime:
                                            Control: Label
                                            Properties:
                                              Text: =RoundDown(LookUp(collectShiftOEE, shift = "B").runtime_hours,0) &"H "& Mod(LookUp(collectShiftOEE, shift = "B").runtime_hours*60,60) & "m"
                                              Align: =Align.Center
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 3.5
                                              Width: =10
                                    - oee_b_downtime_parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee_b_downtime_title:
                                            Control: Label
                                            Properties:
                                              Text: ="Planned Downtime"
                                              Align: =Align.Center
                                              Color: =varColor5
                                              Fill: =varColor3
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 5.5
                                              Width: =10
                                        - oee_b_downtime:
                                            Control: Label
                                            Properties:
                                              Text: =RoundDown(LookUp(collectShiftOEE, shift = "B").downtime_planned/60,0) &"H "& Mod(LookUp(collectShiftOEE, shift = "B").downtime_planned,60) & "m"
                                              Align: =Align.Center
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 3.5
                                              Width: =10
                                    - oee_b_possible_parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee_b_possible_title:
                                            Control: Label
                                            Properties:
                                              Text: ="Possible Runtime"
                                              Align: =Align.Center
                                              Color: =varColor5
                                              Fill: =varColor3
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4
                                              Width: =10
                                        - oee_b_possible:
                                            Control: Label
                                            Properties:
                                              Text: =LookUp(collectShiftOEE, shift = "B").runtime_total*1 & "H"
                                              Align: =Align.Center
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 3.5
                                              Width: =10
