- o_layout:
    Control: GroupContainer
    Variant: verticalAutoLayoutContainer
    Properties:
      Height: =Parent.Height
      LayoutAlignItems: =LayoutAlignItems.Stretch
      LayoutDirection: =LayoutDirection.Vertical
      LayoutGap: =
      LayoutMode: =LayoutMode.Auto
      Width: =Parent.Width
      X: =
    Children:
    - o_header:
        Control: GroupContainer
        Variant: horizontalAutoLayoutContainer
        Properties:
          AlignInContainer: =AlignInContainer.SetByContainer
          DropShadow: =DropShadow.None
          Fill: =varColor1
          LayoutAlignItems: =LayoutAlignItems.Stretch
          LayoutGap: =varPadding
          LayoutMinHeight: =10
          LayoutMinWidth: =10
          LayoutMode: =LayoutMode.Auto
          PaddingBottom: =varPadding
          PaddingLeft: =varPadding
          PaddingRight: =varPadding
          PaddingTop: =varPadding
          RadiusBottomLeft: =0
          RadiusBottomRight: =0
          RadiusTopLeft: =0
          RadiusTopRight: =0
        Children:
        - o_collect:
            Control: Classic/Button
            Properties:
              OnSelect: |-
                =/*Start*/
                Set(varLoading,{Visible: true, Value: 1, Text: "Loading"});

                /*Update Dates Variables*/
                UpdateContext({
                    locEndDate: o_end_date.SelectedDate,
                    locStartDate: o_start_date.SelectedDate
                    
                });

                /*Check if collections need updating*/
                Set(varLoading,{Visible: true, Value: 5, Text: "Checking for updates"});
                Set(varUpdateProduction,
                    Or(
                        Not(First(Sort(Production,ID,SortOrder.Descending)).ID = First(Sort(collectProduction,id,SortOrder.Descending)).id),
                        Not(varEndDate = locEndDate),
                        Not(varStartDate = locStartDate)
                    )
                );

                /*Set collection dates from selected local dates*/
                If( Not(varEndDate = locEndDate), Set(varEndDate, locEndDate));
                If( Not(varStartDate = locStartDate), Set(varStartDate, locStartDate));

                /*Collect Production*/
                Set(varLoading,{Visible: true, Value: 10, Text: "Collecting Production Data"});
                If(varUpdateProduction,
                    If(
                        DateDiff( varStartDate, varEndDate, TimeUnit.Days) <= 14,
                        Set(varLoading,{Visible: true, Value: 75, Text: "Retrieving Production Data"});
                        ClearCollect(collectProduction,
                            ForAll(
                                Filter(Production,
                                    Hour_Ending <= DateAdd(varEndDate, 23, TimeUnit.Hours),
                                    Hour_Starting >= DateAdd(varStartDate, -1, TimeUnit.Hours)
                                ),
                                {
                                    id: Value(ThisRecord.ID),
                                    shift: Text(ThisRecord.Shift_Letter),
                                    line: Text(ThisRecord.Line.Value),
                                    lot: Text(ThisRecord.Lot),
                                    catalog: Text(ThisRecord.Catalog),
                                    size: Text(ThisRecord.Size),
                                    hour_ending: DateTimeValue(ThisRecord.Hour_Ending),
                                    hour_starting: DateTimeValue(ThisRecord.Hour_Starting),
                                    goal: Value(ThisRecord.Hourly_Goal),
                                    amount_built: Value(ThisRecord.Amount_Built),
                                    unit_starting: Value(ThisRecord.Unit_Starting),
                                    unit_ending: Value(ThisRecord.Unit_Ending),
                                    reject_labels: Value(ThisRecord.Reject_Labels),
                                    reject_cartridges: Value(ThisRecord.Reject_Cartridges),
                                    reject_units: Value(ThisRecord.Reject_Units),
                                    qa_units: Value(ThisRecord.QA_Units)
                                }
                            )
                        ),

                        DateDiff( varStartDate, varEndDate, TimeUnit.Days) > 21,
                        Set(varLoading,{Visible: true, Value: 75, Text: "Parsing PowerAutomate Flow"});
                        ClearCollect(collectProduction,
                            ForAll(
                                Table(
                                    ParseJSON(
                                        flow_get_units_range_v2.Run(
                                            Text("All"),
                                            Text(DateAdd(varEndDate, 23,TimeUnit.Hours), "yyyy-mm-dd"),
                                            Text(DateAdd(varStartDate, -1, TimeUnit.Hours), "yyyy-mm-dd")
                                        ).output
                                    )
                                ),
                                {
                                    id: Value(Value._ID),
                                    shift: Text(Value._shift),
                                    line: Text(Value._line),
                                    lot: Text(Value._lot),
                                    catalog: Text(Value._catalog),
                                    size: Text(Value._size),
                                    hour_ending: DateTimeValue(Value._hour_ending),
                                    hour_starting: DateTimeValue(Value._hour_starting),
                                    goal: Value(Value._goal),
                                    amount_built: Value(Value._amount_built),
                                    unit_starting: Value(Value._unit_starting),
                                    unit_ending: Value(Value._unit_ending),
                                    reject_labels: Value(Value._reject_labels),
                                    reject_cartridges: Value(Value._reject_cartridges),
                                    reject_units: Value(Value._reject_units),
                                    qa_units: Value(Value._qa)
                                }
                            )
                        ),

                        DateDiff( varStartDate, varEndDate, TimeUnit.Days) <= 21,
                        Set(varLoading,{Visible: true, Value: 20, Text: "Collecting Dataset 1"});
                        Collect(material_1,
                            Sort(
                                Filter(Production,
                                    And(
                                        Hour_Ending <= DateAdd(varEndDate, 23, TimeUnit.Hours),
                                        Hour_Starting >= DateAdd(varStartDate, -1, TimeUnit.Hours)                        
                                    )
                                ),
                                Hour_Ending,
                                SortOrder.Ascending
                            )
                        );

                        Set(varLoading,{Visible: true, Value: 30, Text: "Collecting Dataset 2"});
                        Collect(material_2,
                            Sort(
                                Filter(Production,
                                    And(
                                        Hour_Ending <= DateAdd(varEndDate, 23, TimeUnit.Hours),
                                        Hour_Starting >= DateAdd(varStartDate, -1, TimeUnit.Hours)                        
                                    )
                                ),
                                Hour_Ending,
                                SortOrder.Descending
                            )
                        );

                        Set(varLoading,{Visible: true, Value: 40, Text: "Inserting Dataset 1"});
                        ClearCollect(fusion, material_1);

                        Set(varLoading,{Visible: true, Value: 50, Text: "Inserting Dataset 2"});
                        Collect(fusion,
                            Filter(material_2, Not(ID in material_1.ID))
                        );

                        Set(varLoading,{Visible: true, Value: 75, Text: "Collecting Production Data from Joined Data"});
                        ClearCollect(
                            collectProduction,
                            ForAll(
                                fusion,
                                {
                                    id: Value(ThisRecord.ID),
                                    shift: Text(ThisRecord.Shift_Letter),
                                    line: Text(ThisRecord.Line.Value),
                                    lot: Text(ThisRecord.Lot),
                                    catalog: Text(ThisRecord.Catalog),
                                    size: Text(ThisRecord.Size),
                                    hour_ending: DateTimeValue(ThisRecord.Hour_Ending),
                                    hour_starting: DateTimeValue(ThisRecord.Hour_Starting),
                                    goal: Value(ThisRecord.Hourly_Goal),
                                    amount_built: Value(ThisRecord.Amount_Built),
                                    unit_starting: Value(ThisRecord.Unit_Starting),
                                    unit_ending: Value(ThisRecord.Unit_Ending),
                                    reject_labels: Value(ThisRecord.Reject_Labels),
                                    reject_cartridges: Value(ThisRecord.Reject_Cartridges),
                                    reject_units: Value(ThisRecord.Reject_Units),
                                    qa_units: Value(ThisRecord.QA_Units)
                                }
                            )
                        );

                        Set(varLoading,{Visible: true, Value: 80, Text: "Garbage Collection"});
                        Clear(fusion);
                        Clear(material_1);
                        Clear(material_2);
                    )
                );

                /*Update*/
                Set(varLoading,{Visible: true, Value: 100, Text: "Finishing Collection"});
                Select(o_update);
              Text: ="collect"
              Visible: =false
              X: =20
              Y: =20
        - o_update:
            Control: Classic/Button
            Properties:
              OnSelect: |-
                =
                /*Continued from o_collect*/
                Set(varLoading,{Visible: true, Value: 10, Text: "Updating Values"});

                /*Join and Create Output Table*/
                Set(varLoading,{Visible: true, Value: 45, Text: "Collecting Output Data"});
                ClearCollect(
                    collectLocalOutputData,
                    ForAll(
                        collectLineSchema,
                        {
                            line: SCH_Line,
                            total:
                                /*Filter and Sum to get total amount built, per line, per selected shift*/
                                Sum(
                                    Filter(
                                        collectProduction,
                                        hour_starting >= DateAdd(locStartDate, -1, TimeUnit.Hours),
                                        hour_ending <= DateAdd(locEndDate, 23, TimeUnit.Hours),
                                        line = SCH_Line,
                                        If(
                                            o_shift.Selected.Value = "All",
                                            shift = shift,
                                            shift = o_shift.Selected.Value
                                        )
                                    ),
                                    amount_built
                                )
                        }
                    )
                );

                /*Join and Create Rejects Table*/
                Set(varLoading,{Visible: true, Value: 90, Text: "Collecting Reject Data"});
                ClearCollect(
                    collectLocalRejectData,
                    ForAll(
                        collectLineSchema,
                        {
                            line: SCH_Line,
                            total:
                                /*Filter and Sum to get total amount of rejects, per line, per selected shift*/
                                Sum(
                                    Filter(
                                        collectProduction,
                                        hour_starting >= DateAdd(locStartDate, -1, TimeUnit.Hours),
                                        hour_ending <= DateAdd(locEndDate, 23, TimeUnit.Hours),
                                        line = SCH_Line,
                                        If(
                                            o_shift.Selected.Value = "All",
                                            shift = shift,
                                            shift = o_shift.Selected.Value
                                        )
                                    ),
                                    reject_units + reject_cartridges
                                )
                        }
                    )
                );

                /*Garbage Collecting*/
                Set(varLoading,{Visible: true, Value: 95, Text: "Finishing Up"});


                /*End*/
                Set(varLoading,{Visible: true, Value: 100, Text: "Completed"});
                Set(varLoading,{Visible: false, Value: -1, Text: "Not Loading"});
              Text: ="update"
              Visible: =false
              X: =20
              Y: =20
        - o_logo:
            Control: Image
            Properties:
              Image: =LOGO_MSIG_SBlue_FIT_ALPHA
              FillPortions: =1
              LayoutMinHeight: =1
              LayoutMinWidth: =1
              Width: =10
        - o_h_title:
            Control: Label
            Properties:
              Text: ="Encapsualtion Daily Managmenet System"
              Align: =Align.Center
              Color: =varColor5
              FillPortions: =6
              LayoutMinHeight: =1
              LayoutMinWidth: =1
              Size: =Self.Height / 2
        - o_h_nav:
            Control: GroupContainer
            Variant: horizontalAutoLayoutContainer
            Properties:
              AlignInContainer: =AlignInContainer.SetByContainer
              DropShadow: =DropShadow.None
              LayoutAlignItems: =LayoutAlignItems.Stretch
              LayoutGap: =varPadding
              LayoutJustifyContent: =LayoutJustifyContent.Center
              LayoutMinHeight: =1
              LayoutMinWidth: =10
              LayoutMode: =LayoutMode.Auto
              RadiusBottomLeft: =0
              RadiusBottomRight: =0
              RadiusTopLeft: =0
              RadiusTopRight: =0
              Width: =o_h_n_reload.Width * 3 + varPadding * 4
            Children:
            - o_h_n_reload:
                Control: Image
                Properties:
                  OnSelect: |-
                    =/*Start*/
                    Set(varLoading,{Visible: true, Value: 1, Text: "Loading"});

                    UpdateContext({
                        locStartDate: o_start_date.SelectedDate,
                        locEndDate: o_end_date.SelectedDate
                    });

                    /*Collect Production*/
                    If(
                        DateDiff( locStartDate, locEndDate, TimeUnit.Days) <= 10,
                        Set(varLoading,{Visible: true, Value: 25, Text: "Collecting Production Data"});
                        ClearCollect(collectProduction,
                            ForAll(
                                Filter(Production,
                                    Hour_Ending <= DateAdd(locEndDate, 23, TimeUnit.Hours),
                                    Hour_Starting >= DateAdd(locStartDate, -1, TimeUnit.Hours)
                                ),
                                {
                                    id: Value(ThisRecord.ID),
                                    shift: Text(ThisRecord.Shift_Letter),
                                    line: Text(ThisRecord.Line.Value),
                                    lot: Text(ThisRecord.Lot),
                                    catalog: Text(ThisRecord.Catalog),
                                    size: Text(ThisRecord.Size),
                                    hour_ending: DateTimeValue(ThisRecord.Hour_Ending),
                                    hour_starting: DateTimeValue(ThisRecord.Hour_Starting),
                                    goal: Value(ThisRecord.Hourly_Goal),
                                    amount_built: Value(ThisRecord.Amount_Built),
                                    unit_starting: Value(ThisRecord.Unit_Starting),
                                    unit_ending: Value(ThisRecord.Unit_Ending),
                                    reject_labels: Value(ThisRecord.Reject_Labels),
                                    reject_cartridges: Value(ThisRecord.Reject_Cartridges),
                                    reject_units: Value(ThisRecord.Reject_Units),
                                    qa_units: Value(ThisRecord.QA_Units)
                                }
                            )
                        ),

                        DateDiff( locStartDate, locEndDate, TimeUnit.Days) > 20,
                        Set(varLoading,{Visible: true, Value: 25, Text: "Parsing PowerAutomate Flow for Production Data"});
                        ClearCollect(collectProduction,
                            ForAll(
                                Table(
                                    ParseJSON(
                                        flow_get_units_range_v2.Run(
                                            Text("All"),
                                            Text(DateAdd(locEndDate, 23,TimeUnit.Hours), "yyyy-mm-dd"),
                                            Text(DateAdd(locStartDate, -1, TimeUnit.Hours), "yyyy-mm-dd")
                                        ).output
                                    )
                                ),
                                {
                                    id: Value(Value._ID),
                                    shift: Text(Value._shift),
                                    line: Text(Value._line),
                                    lot: Text(Value._lot),
                                    catalog: Text(Value._catalog),
                                    size: Text(Value._size),
                                    hour_ending: DateTimeValue(Value._hour_ending),
                                    hour_starting: DateTimeValue(Value._hour_starting),
                                    goal: Value(Value._goal),
                                    amount_built: Value(Value._amount_built),
                                    unit_starting: Value(Value._unit_starting),
                                    unit_ending: Value(Value._unit_ending),
                                    reject_labels: Value(Value._reject_labels),
                                    reject_cartridges: Value(Value._reject_cartridges),
                                    reject_units: Value(Value._reject_units),
                                    qa_units: Value(Value._qa)
                                }
                            )
                        ),

                        DateDiff( locStartDate, locEndDate, TimeUnit.Days) <= 20,
                        Set(varLoading,{Visible: true, Value: 5, Text: "Collecting Production Dataset 1"});
                        Collect(material_1,
                            Sort(
                                Filter(Production,
                                    And(
                                        Hour_Starting >= DateAdd(locStartDate, -1, TimeUnit.Hours),
                                        Hour_Ending <= DateAdd(locEndDate, 23, TimeUnit.Hours)
                                    )
                                ),
                                Hour_Ending,
                                SortOrder.Ascending
                            )
                        );

                        Set(varLoading,{Visible: true, Value: 10, Text: "Collecting Production Dataset 2"});
                        Collect(material_2,
                            Sort(
                                Filter(Production,
                                    And(
                                        Hour_Starting >= DateAdd(locStartDate, -1, TimeUnit.Hours),
                                        Hour_Ending <= DateAdd(locEndDate, 23, TimeUnit.Hours)
                                    )
                                ),
                                Hour_Ending,
                                SortOrder.Descending
                            )
                        );

                        
                        Set(varLoading,{Visible: true, Value: 15, Text: "Joining Production Dataset 1"});
                        ClearCollect(fusion, material_1);

                        Set(varLoading,{Visible: true, Value: 20, Text: "Joining Production Dataset 2"});
                        Collect(fusion,
                            Filter(material_2, Not(ID in material_1.ID))
                        );

                        Set(varLoading,{Visible: true, Value: 25, Text: "Collecting Joined Production Data"});
                        ClearCollect(
                            collectProduction,
                            ForAll(
                                fusion,
                                {
                                    id: Value(ThisRecord.ID),
                                    shift: Text(ThisRecord.Shift_Letter),
                                    line: Text(ThisRecord.Line.Value),
                                    lot: Text(ThisRecord.Lot),
                                    catalog: Text(ThisRecord.Catalog),
                                    size: Text(ThisRecord.Size),
                                    hour_ending: DateTimeValue(ThisRecord.Hour_Ending),
                                    hour_starting: DateTimeValue(ThisRecord.Hour_Starting),
                                    goal: Value(ThisRecord.Hourly_Goal),
                                    amount_built: Value(ThisRecord.Amount_Built),
                                    unit_starting: Value(ThisRecord.Unit_Starting),
                                    unit_ending: Value(ThisRecord.Unit_Ending),
                                    reject_labels: Value(ThisRecord.Reject_Labels),
                                    reject_cartridges: Value(ThisRecord.Reject_Cartridges),
                                    reject_units: Value(ThisRecord.Reject_Units),
                                    qa_units: Value(ThisRecord.QA_Units)
                                }
                            )
                        );

                        Set(varLoading,{Visible: true, Value: 26, Text: "Garbage Collection"});
                        Clear(fusion);
                        Clear(material_1);
                        Clear(material_2);
                    );

                    Set(varLoading,{Visible: true, Value: 52, Text: "Finshing up"});

                    /*Update*/
                    Select(o_update);
                  Image: =gblAppIcons.Reload
                  Height: =Parent.Height * 0.75
                  HoverBorderColor: =ColorFade(varColorYes, 20%)
                  HoverFill: =ColorFade(varColorAccent, 75%)
                  LayoutMinHeight: =1
                  LayoutMinWidth: =10
                  RadiusBottomLeft: =Self.Width/2
                  RadiusBottomRight: =Self.Width/2
                  RadiusTopLeft: =Self.Width/2
                  RadiusTopRight: =Self.Width/2
                  Width: =Self.Height
                  X: =o_h_n_settings.X - Self.Width - Parent.Width * 0.015
                  Y: =Parent.Height/2 - Self.Height/2
            - o_h_n_bugs:
                Control: Image
                Properties:
                  OnSelect: =Navigate(Bugs)
                  Image: =gblAppIcons.Bug
                  Height: =Parent.Height * 0.75
                  HoverBorderColor: =ColorFade(varColorYes, 20%)
                  HoverFill: =ColorFade(varColorAccent, 75%)
                  LayoutMinHeight: =1
                  LayoutMinWidth: =10
                  RadiusBottomLeft: =Self.Width/2
                  RadiusBottomRight: =Self.Width/2
                  RadiusTopLeft: =Self.Width/2
                  RadiusTopRight: =Self.Width/2
                  Width: =Self.Height
                  X: =Parent.Width * 0.99 - Self.Width
                  Y: =Parent.Height/2 - Self.Height/2
            - o_h_n_settings:
                Control: Image
                Properties:
                  OnSelect: =Navigate(Settings)
                  Image: =gblAppIcons.Settings
                  Height: =Parent.Height * 0.75
                  HoverBorderColor: =ColorFade(varColorYes, 20%)
                  HoverFill: =ColorFade(varColorAccent, 75%)
                  LayoutMinHeight: =1
                  LayoutMinWidth: =10
                  RadiusBottomLeft: =Self.Width/2
                  RadiusBottomRight: =Self.Width/2
                  RadiusTopLeft: =Self.Width/2
                  RadiusTopRight: =Self.Width/2
                  Width: =Self.Height
                  X: =Parent.Width * 0.99 - Self.Width - o_h_n_bugs.Width - Parent.Width * 0.015
                  Y: =Parent.Height/2 - Self.Height/2
            - o_h_n_user:
                Control: Image
                Properties:
                  Image: |
                    =If(IsBlankOrError(User().Image), gblAppIcons.Employee, User().Image)
                  LayoutMinHeight: =1
                  LayoutMinWidth: =1
                  RadiusBottomLeft: =Self.Height / 2
                  RadiusBottomRight: =Self.Height / 2
                  RadiusTopLeft: =Self.Height / 2
                  RadiusTopRight: =Self.Height / 2
                  Width: =Self.Height
    - o_body:
        Control: GroupContainer
        Variant: horizontalAutoLayoutContainer
        Properties:
          AlignInContainer: =AlignInContainer.SetByContainer
          FillPortions: =15
          LayoutAlignItems: =LayoutAlignItems.Stretch
          LayoutMinHeight: =10
          LayoutMinWidth: =10
          LayoutMode: =LayoutMode.Auto
        Children:
        - o_nav:
            Control: GroupContainer
            Variant: horizontalAutoLayoutContainer
            Properties:
              AlignInContainer: =AlignInContainer.SetByContainer
              DropShadow: =DropShadow.None
              Fill: =varColor3
              LayoutAlignItems: =LayoutAlignItems.Stretch
              LayoutDirection: =LayoutDirection.Vertical
              LayoutGap: =varPadding
              LayoutMinHeight: =10
              LayoutMinWidth: =10
              LayoutMode: =LayoutMode.Auto
              PaddingBottom: =varPadding
              PaddingLeft: =varPadding
              PaddingRight: =varPadding
              PaddingTop: =varPadding
              RadiusBottomLeft: =0
              RadiusBottomRight: =0
              RadiusTopLeft: =0
              RadiusTopRight: =0
            Children:
            - o_n_title:
                Control: Text
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  Size: =Self.Height / 3
                  Text: =App.ActiveScreen.Name
                  VerticalAlign: ='TextCanvas.VerticalAlign'.Middle
                  Weight: ='TextCanvas.Weight'.Semibold
                  FillPortions: =1
            - o_n_seperator:
                Control: Rectangle
                Properties:
                  Height: =1
                  Width: =Parent.Width * 0.95
            - o_n_gallery:
                Control: Gallery
                Variant: galleryVertical
                Properties:
                  Items: =collectNavigation
                  DelayItemLoading: =true
                  FillPortions: =13
                  Layout: =Layout.Vertical
                  LayoutMinHeight: =1
                  LayoutMinWidth: =1
                  LoadingSpinner: =LoadingSpinner.Data
                  ShowScrollbar: =false
                  TemplatePadding: =0
                  TemplateSize: =(Self.Height - ((Self.AllItemsCount+1) * Self.TemplatePadding)) / Self.AllItemsCount
                Children:
                - o_n_button:
                    Control: Classic/Button
                    Properties:
                      OnSelect: =Navigate(ThisItem.ScreenName);
                      Text: =ThisItem.Title
                      Color: =varColor0
                      DisplayMode: =If(App.ActiveScreen = ThisItem.ScreenName, DisplayMode.Disabled, DisplayMode.Edit)
                      Fill: =varColorAccent
                      FontWeight: =FontWeight.Normal
                      Height: =Parent.TemplateHeight - varPadding
                      Size: =Self.Width / 16
                      Width: =Parent.TemplateWidth - Self.BorderThickness
                      X: =Center(Parent.TemplateWidth, Self.Width)
                      Y: =Center(Parent.TemplateHeight, Self.Height)
            - o_n_footer:
                Control: GroupContainer
                Variant: manualLayoutContainer
                Properties:
                  AlignInContainer: =AlignInContainer.SetByContainer
                  DropShadow: =DropShadow.None
                  FillPortions: =2
                  LayoutMinHeight: =1
                  LayoutMinWidth: =1
                  RadiusBottomLeft: =0
                  RadiusBottomRight: =0
                  RadiusTopLeft: =0
                  RadiusTopRight: =0
                Children:
                - o_n_f_text:
                    Control: Text
                    Properties:
                      Align: ='TextCanvas.Align'.Center
                      Size: =8
                      Text: ="MilliporeSigma is the U.S. and Canada Life Science business of Merck KGaA, Darmstadt, Germany."
                      VerticalAlign: ='TextCanvas.VerticalAlign'.Bottom
                      Height: =Parent.Height
                      Width: =Parent.Width
        - o_main:
            Control: GroupContainer
            Variant: horizontalAutoLayoutContainer
            Properties:
              AlignInContainer: =AlignInContainer.SetByContainer
              FillPortions: =11
              LayoutAlignItems: =LayoutAlignItems.Stretch
              LayoutGap: =varPadding
              LayoutMinHeight: =10
              LayoutMinWidth: =10
              LayoutMode: =LayoutMode.Auto
              PaddingBottom: =varPadding
              PaddingLeft: =varPadding
              PaddingRight: =varPadding
              PaddingTop: =varPadding
            Children:
            - o_controls:
                Control: GroupContainer
                Variant: horizontalAutoLayoutContainer
                Properties:
                  AlignInContainer: =AlignInContainer.SetByContainer
                  Fill: =varColor4
                  LayoutAlignItems: =LayoutAlignItems.Stretch
                  LayoutDirection: =LayoutDirection.Vertical
                  LayoutGap: =varPadding
                  LayoutMinHeight: =10
                  LayoutMinWidth: =10
                  LayoutMode: =LayoutMode.Auto
                  PaddingBottom: =varPadding
                  PaddingLeft: =varPadding
                  PaddingRight: =varPadding
                  PaddingTop: =varPadding
                Children:
                - o_start_date_title:
                    Control: Text
                    Properties:
                      Align: ='TextCanvas.Align'.Center
                      Size: =Self.Height / 3
                      Text: ="Starting Date"
                      FillPortions: =1
                      LayoutMinHeight: =10
                      LayoutMinWidth: =10
                - o_start_date:
                    Control: DatePicker
                    Properties:
                      FontSize: =Self.Width / 10
                      Format: ="Short"
                      SelectedDate: =varNowDay
                      FillPortions: =1
                      LayoutMinHeight: =10
                      LayoutMinWidth: =10
                - o_seperator_0:
                    Control: Rectangle
                    Properties:
                      Height: =1
                      LayoutMinWidth: =10
                - o_end_date_title:
                    Control: Text
                    Properties:
                      Align: ='TextCanvas.Align'.Center
                      Size: =Self.Height / 3
                      Text: ="Ending Date"
                      FillPortions: =1
                      LayoutMinHeight: =10
                      LayoutMinWidth: =10
                - o_end_date:
                    Control: DatePicker
                    Properties:
                      FontSize: =Self.Width / 10
                      Format: ="Short"
                      SelectedDate: =varNowDay
                      FillPortions: =1
                      LayoutMinHeight: =10
                      LayoutMinWidth: =10
                - o_seperator_1:
                    Control: Rectangle
                    Properties:
                      Height: =1
                      LayoutMinWidth: =10
                - o_button:
                    Control: Classic/Button
                    Properties:
                      OnSelect: =Select(o_collect);
                      Text: ="Update Date Range"
                      Color: =varColor0
                      Fill: =varColorAccent
                      FillPortions: =1
                      LayoutMinHeight: =10
                      LayoutMinWidth: =10
                      Size: =Self.Width / 16
                - o_seperator_2:
                    Control: Rectangle
                    Properties:
                      Height: =1
                      LayoutMinWidth: =10
                - o_shift_title:
                    Control: Text
                    Properties:
                      Align: ='TextCanvas.Align'.Center
                      Size: =Self.Height / 3
                      Text: ="Shift"
                      FillPortions: =1
                      LayoutMinHeight: =10
                      LayoutMinWidth: =10
                - o_shift:
                    Control: DropDown
                    Variant: pcfdataset
                    Properties:
                      OnChange: =Select(o_update)
                      Appearance: ='DropdownCanvas.Appearance'.FilledDarker
                      DefaultSelectedItems: |-
                        ={Value: "All"}
                      FontSize: =Self.Width / 10
                      Items: =["All", "C", "A", "B"]
                      FillPortions: =1
                      LayoutMinHeight: =10
                      LayoutMinWidth: =10
                - o_seperator_3:
                    Control: Rectangle
                    Properties:
                      Height: =1
                      LayoutMinWidth: =10
                - o_c_footer:
                    Control: GroupContainer
                    Variant: manualLayoutContainer
                    Properties:
                      AlignInContainer: =AlignInContainer.SetByContainer
                      DropShadow: =DropShadow.None
                      FillPortions: =10
                      LayoutMinHeight: =10
                      LayoutMinWidth: =10
                      RadiusBottomLeft: =0
                      RadiusBottomRight: =0
                      RadiusTopLeft: =0
                      RadiusTopRight: =0
            - o_section:
                Control: GroupContainer
                Variant: verticalAutoLayoutContainer
                Properties:
                  AlignInContainer: =AlignInContainer.SetByContainer
                  DropShadow: =DropShadow.None
                  FillPortions: =9
                  LayoutAlignItems: =LayoutAlignItems.Stretch
                  LayoutGap: =varPadding
                  LayoutMinHeight: =10
                  LayoutMinWidth: =10
                  LayoutMode: =LayoutMode.Auto
                  PaddingBottom: =varPadding
                  PaddingLeft: =varPadding
                  PaddingRight: =varPadding
                  PaddingTop: =varPadding
                  RadiusBottomLeft: =0
                  RadiusBottomRight: =0
                  RadiusTopLeft: =0
                  RadiusTopRight: =0
                Children:
                - o_outputs:
                    Control: GroupContainer
                    Variant: verticalAutoLayoutContainer
                    Properties:
                      AlignInContainer: =AlignInContainer.SetByContainer
                      BorderColor: =varColor4
                      DropShadow: =DropShadow.Semilight
                      FillPortions: =3.5
                      Height: =500
                      LayoutAlignItems: =LayoutAlignItems.Center
                      LayoutDirection: =LayoutDirection.Vertical
                      LayoutMinHeight: =1
                      LayoutMinWidth: =10
                      LayoutMode: =LayoutMode.Auto
                      PaddingBottom: =Self.Width * 0.01
                      Width: =Parent.Width/2
                    Children:
                    - o_o_header:
                        Control: GroupContainer
                        Variant: manualLayoutContainer
                        Properties:
                          AlignInContainer: =AlignInContainer.SetByContainer
                          DropShadow: =DropShadow.None
                          Fill: =varColor2
                          FillPortions: =0.5
                          LayoutMinHeight: =1
                          RadiusBottomLeft: =0
                          RadiusBottomRight: =0
                          RadiusTopLeft: =0
                          RadiusTopRight: =0
                          Width: =Parent.Width
                        Children:
                        - o_o_h_title:
                            Control: Label
                            Properties:
                              Text: ="Outputs"
                              Align: =Align.Center
                              Color: =varColor5
                              Font: =Font.Verdana
                              Height: =Parent.Height
                              Size: =Self.Height / 2
                              Width: =Parent.Width
                    - o_o_totals:
                        Control: GroupContainer
                        Variant: manualLayoutContainer
                        Properties:
                          AlignInContainer: =AlignInContainer.SetByContainer
                          DropShadow: =DropShadow.None
                          Fill: =varColor3
                          LayoutMinHeight: =1
                          RadiusBottomLeft: =0
                          RadiusBottomRight: =0
                          RadiusTopLeft: =0
                          RadiusTopRight: =0
                          Width: =Parent.Width
                        Children:
                        - o_o_t_daily_xlt:
                            Control: Label
                            Properties:
                              Text: |-
                                ="XLT: " &
                                Sum(
                                    Filter(
                                        collectProduction,
                                        
                                        hour_starting >= DateAdd(locStartDate, -1, TimeUnit.Hours),
                                        hour_ending <= DateAdd(locEndDate, 23, TimeUnit.Hours),
                                        
                                        /*find all XLT*/
                                        "XLT" in line
                                    ),
                                    amount_built

                                /*Multiply by 1 to get Zero amounts when nothing is present in the data for the filtered lines*/
                                ) * 1

                                & " / " &

                                Text(Round(LookUp(Universal_Variables, name = "UNI_MANAGE_TARGET_XLT").int/5,0))
                              Align: =Align.Center
                              Color: =varColor5
                              Font: =Font.Verdana
                              Height: =Parent.Height / 2
                              Size: =Self.Width / 12
                              Width: =Parent.Width * 0.25
                              X: '=o_o_t_daily_title.X + o_o_t_daily_title.Width * 3   '
                              Y: =o_o_t_shift_title.Y + o_o_t_shift_title.Height
                        - o_o_t_daily_xl:
                            Control: Label
                            Properties:
                              Text: |-
                                ="XL: " &
                                Sum(
                                    Filter(
                                        collectProduction,
                                        
                                        hour_starting >= DateAdd(locStartDate, -1, TimeUnit.Hours),
                                        hour_ending <= DateAdd(locEndDate, 23, TimeUnit.Hours),
                                        
                                        /*Finding XL is more annoying use nots to filter out XLT*/
                                        "XL" in line,
                                        Not("XLT" in line)
                                    ),
                                    amount_built

                                /*Multiply by 1 to get Zero amounts when nothing is present in the data for the filtered lines*/
                                ) * 1

                                & " / " &

                                Text(Round(LookUp(Universal_Variables, name = "UNI_MANAGE_TARGET_XL").int/5,0))
                              Align: =Align.Center
                              Color: =varColor5
                              Font: =Font.Verdana
                              Height: =Parent.Height / 2
                              Size: =Self.Width / 12
                              Width: =Parent.Width * 0.25
                              X: =o_o_t_daily_title.X + o_o_t_daily_title.Width * 2
                              Y: =o_o_t_shift_title.Y + o_o_t_shift_title.Height
                        - o_o_t_daily_ssc:
                            Control: Label
                            Properties:
                              Text: |-
                                ="SSC: " &
                                Sum(
                                    Filter(
                                        collectProduction,
                                        
                                        hour_starting >= DateAdd(locStartDate, -1, TimeUnit.Hours),
                                        hour_ending <= DateAdd(locEndDate, 23, TimeUnit.Hours),
                                        
                                        /*find all ssc*/
                                        "SSC" in line
                                    ),
                                    amount_built

                                /*Multiply by 1 to get Zero amounts when nothing is present in the data for the filtered lines*/
                                ) * 1

                                & " / " &

                                Text(Round(LookUp(Universal_Variables, name = "UNI_MANAGE_TARGET_SSC").int/5,0))
                              Align: =Align.Center
                              Color: =varColor5
                              Font: =Font.Verdana
                              Height: =Parent.Height / 2
                              Size: =Self.Width / 12
                              Width: =Parent.Width * 0.25
                              X: =o_o_t_daily_title.X + o_o_t_daily_title.Width
                              Y: =o_o_t_shift_title.Y + o_o_t_shift_title.Height
                        - o_o_t_daily_title:
                            Control: Label
                            Properties:
                              Text: ="Daily Totals"
                              Align: =Align.Center
                              Color: =varColor5
                              Font: =Font.Verdana
                              Height: =Parent.Height / 2
                              Size: =Self.Width / 12
                              Width: =Parent.Width * 0.25
                              Y: =o_o_t_shift_title.Y + o_o_t_shift_title.Height
                        - o_o_t_shift_xlt:
                            Control: Label
                            Properties:
                              Text: |-
                                ="XLT: " &
                                Sum(
                                    Filter(
                                        collectProduction,
                                        
                                        hour_starting >= DateAdd(locStartDate, -1, TimeUnit.Hours),
                                        hour_ending <= DateAdd(locEndDate, 23, TimeUnit.Hours),
                                        
                                        /*find all XLT*/
                                        "XLT" in line,
                                        If(
                                            o_shift.Selected.Value = "All",
                                            shift = shift,
                                            shift = o_shift.Selected.Value
                                        )
                                    ),
                                    amount_built

                                /*Multiply by 1 to get Zero amounts when nothing is present in the data for the filtered lines*/
                                ) * 1

                                & " / " &

                                Text(Round(LookUp(Universal_Variables, name = "UNI_MANAGE_TARGET_XLT").int/5/3,0))
                              Align: =Align.Center
                              Color: =varColor5
                              Font: =Font.Verdana
                              Height: =Parent.Height / 2
                              Size: =Self.Width / 12
                              Width: =Parent.Width * 0.25
                              X: '=o_o_t_shift_title.X + o_o_t_shift_title.Width * 3   '
                        - o_o_t_shift_xl:
                            Control: Label
                            Properties:
                              Text: |-
                                ="XL: " &
                                Sum(
                                    Filter(
                                        collectProduction,

                                        hour_starting >= DateAdd(locStartDate, -1, TimeUnit.Hours),
                                        hour_ending <= DateAdd(locEndDate, 23, TimeUnit.Hours),

                                        /*Finding XL is more annoying use nots to filter out XLT*/
                                        
                                        "XL" in line,
                                        Not("XLT" in line),
                                        
                                        If(
                                            o_shift.Selected.Value = "All",
                                            shift = shift,
                                            shift = o_shift.Selected.Value
                                        )
                                    ),
                                    amount_built

                                /*Multiply by 1 to get Zero amounts when nothing is present in the data for the filtered lines*/
                                ) * 1

                                & " / " &

                                Text(Round(LookUp(Universal_Variables, name = "UNI_MANAGE_TARGET_XL").int/5/3,0))
                              Align: =Align.Center
                              Color: =varColor5
                              Font: =Font.Verdana
                              Height: =Parent.Height / 2
                              Size: =Self.Width / 12
                              Width: =Parent.Width * 0.25
                              X: =o_o_t_shift_title.X + o_o_t_shift_title.Width * 2
                        - o_o_t_shift_ssc:
                            Control: Label
                            Properties:
                              Text: |-
                                ="SSC: " &

                                Sum(
                                    Filter(
                                        collectProduction,
                                        hour_starting >= DateAdd(locStartDate, -1, TimeUnit.Hours),
                                        hour_ending <= DateAdd(locEndDate, 23, TimeUnit.Hours),
                                        /*find all ssc*/
                                        "SSC" in line,
                                        If(
                                            o_shift.Selected.Value = "All",
                                            shift = shift,
                                            shift = o_shift.Selected.Value
                                        )
                                    ),
                                    amount_built

                                /*Multiply by 1 to get Zero amounts when nothing is present in the data for the filtered lines*/
                                ) * 1

                                & " / " &

                                Text(Round(LookUp(Universal_Variables, name = "UNI_MANAGE_TARGET_SSC").int/5/3,0))
                              Align: =Align.Center
                              Color: =varColor5
                              Font: =Font.Verdana
                              Height: =Parent.Height / 2
                              Size: =Self.Width / 12
                              Width: =Parent.Width * 0.25
                              X: =o_o_t_shift_title.X + o_o_t_shift_title.Width
                        - o_o_t_shift_title:
                            Control: Label
                            Properties:
                              Text: ="Shift Totals"
                              Align: =Align.Center
                              Color: =varColor5
                              Font: =Font.Verdana
                              Height: =Parent.Height / 2
                              Size: =Self.Width / 12
                              Width: =Parent.Width * 0.25
                    - o_o_columns:
                        Control: GroupContainer
                        Variant: manualLayoutContainer
                        Properties:
                          AlignInContainer: =AlignInContainer.SetByContainer
                          DropShadow: =DropShadow.None
                          Fill: =varColor4
                          FillPortions: =0.5
                          LayoutMinHeight: =1
                          RadiusBottomLeft: =0
                          RadiusBottomRight: =0
                          RadiusTopLeft: =0
                          RadiusTopRight: =0
                          Width: =Parent.Width
                        Children:
                        - o_o_c_outputs:
                            Control: Label
                            Properties:
                              Text: ="Outputs"
                              Align: =Align.Center
                              Color: =varColor0
                              Font: =Font.Verdana
                              Height: =Parent.Height
                              Size: =Self.Width / 18
                              Width: =Parent.Width / 2
                              X: =o_o_c_line.X + o_o_c_line.Width
                        - o_o_c_line:
                            Control: Label
                            Properties:
                              Text: ="Line"
                              Align: =Align.Center
                              Color: =varColor0
                              Font: =Font.Verdana
                              Height: =Parent.Height
                              Size: =Self.Width / 18
                              Width: =Parent.Width / 2
                    - o_o_gallery:
                        Control: Gallery
                        Variant: galleryVertical
                        Properties:
                          Items: =collectLocalOutputData
                          AlignInContainer: =AlignInContainer.SetByContainer
                          DelayItemLoading: =true
                          FillPortions: =6.5
                          Layout: =Layout.Vertical
                          LayoutMinHeight: =1
                          LoadingSpinner: =LoadingSpinner.Data
                          TemplatePadding: =0
                          TemplateSize: =Self.Height / 10
                          Width: =Parent.Width
                        Children:
                        - o_o_g_line:
                            Control: Label
                            Properties:
                              Text: =ThisItem.line
                              Align: =Align.Center
                              Color: =varColor0
                              Font: =Font.Verdana
                              Height: =Parent.TemplateHeight - o_o_g_seperator.Height
                              Size: =Self.Width / 16
                              Width: =Parent.TemplateWidth / 2
                        - o_o_g_outputs:
                            Control: Label
                            Properties:
                              Text: =ThisItem.total
                              Align: =Align.Center
                              Color: =varColor0
                              Font: =Font.Verdana
                              Height: =Parent.TemplateHeight - o_o_g_seperator.Height
                              Size: =Self.Width / 16
                              Width: =Parent.TemplateWidth / 2
                              X: =o_o_g_line.X + o_o_g_line.Width
                        - o_o_g_seperator:
                            Control: Rectangle
                            Properties:
                              OnSelect: =Select(Parent)
                              Fill: =varColor1
                              Height: =Parent.TemplateHeight * 0.025
                              Width: =Parent.Width
                              Y: =Parent.TemplateHeight - Self.Height
                    - o_o_copy:
                        Control: Classic/Button
                        Properties:
                          OnSelect: |-
                            =IfError(  
                                Copy(
                                    Concat(
                                        collectLocalOutputData,
                                        If(IsBlankOrError(total), 0, total),
                                        Char(9)
                                    )
                                ),
                                /*New bug with teams, cannot copy so show error*/
                                Notify("Cannot copy data from new Teams, or other embeded tools. Please open this app in a web browser.", NotificationType.Error)
                            );
                          Text: ="Copy Outputs"
                          Color: =varColor0
                          Fill: =varColorAccent
                          FillPortions: =0.5
                          Font: =Font.Verdana
                          HoverColor: =varColor5
                          LayoutMinHeight: =1
                          Size: =Self.Width / 20
                          Width: =Parent.Width * 0.50
                - o_rejects:
                    Control: GroupContainer
                    Variant: verticalAutoLayoutContainer
                    Properties:
                      AlignInContainer: =AlignInContainer.SetByContainer
                      BorderColor: =varColor4
                      DropShadow: =DropShadow.Semilight
                      FillPortions: =3.5
                      Height: =500
                      LayoutAlignItems: =LayoutAlignItems.Center
                      LayoutDirection: =LayoutDirection.Vertical
                      LayoutMinHeight: =1
                      LayoutMinWidth: =10
                      LayoutMode: =LayoutMode.Auto
                      PaddingBottom: =Self.Width * 0.01
                      Width: =Parent.Width/2
                    Children:
                    - o_r_header:
                        Control: GroupContainer
                        Variant: manualLayoutContainer
                        Properties:
                          AlignInContainer: =AlignInContainer.SetByContainer
                          DropShadow: =DropShadow.None
                          Fill: =varColor2
                          FillPortions: =0.5
                          LayoutMinHeight: =1
                          RadiusBottomLeft: =0
                          RadiusBottomRight: =0
                          RadiusTopLeft: =0
                          RadiusTopRight: =0
                          Width: =Parent.Width
                        Children:
                        - o_r_h_title:
                            Control: Label
                            Properties:
                              Text: ="Rejects"
                              Align: =Align.Center
                              Color: =varColor5
                              Font: =Font.Verdana
                              Height: =Parent.Height
                              Size: =Self.Height / 2
                              Width: =Parent.Width
                    - o_r_totals:
                        Control: GroupContainer
                        Variant: manualLayoutContainer
                        Properties:
                          AlignInContainer: =AlignInContainer.SetByContainer
                          DropShadow: =DropShadow.None
                          Fill: =varColor3
                          LayoutMinHeight: =1
                          RadiusBottomLeft: =0
                          RadiusBottomRight: =0
                          RadiusTopLeft: =0
                          RadiusTopRight: =0
                          Width: =Parent.Width
                        Children:
                        - o_r_t_daily_xlt:
                            Control: Label
                            Properties:
                              Text: |-
                                ="XLT: " &
                                Sum(
                                    Filter(
                                        collectProduction,
                                        
                                        hour_starting >= DateAdd(locStartDate, -1, TimeUnit.Hours),
                                        hour_ending <= DateAdd(locEndDate, 23, TimeUnit.Hours),
                                        /*find all XLT*/
                                        "XLT" in line
                                    ),
                                    reject_cartridges + reject_units

                                /*Multiply by 1 to get Zero amounts when nothing is present in the data for the filtered lines*/
                                ) * 1
                              Align: =Align.Center
                              Color: =varColor5
                              Font: =Font.Verdana
                              Height: =Parent.Height / 2
                              Size: =Self.Width / 12
                              Width: =Parent.Width * 0.25
                              X: '=o_r_t_daily_title.X + o_r_t_daily_title.Width * 3   '
                              Y: =o_r_t_shift_title.Y + o_r_t_shift_title.Height
                        - o_r_t_daily_xl:
                            Control: Label
                            Properties:
                              Text: |-
                                ="XL: " &
                                Sum(
                                    Filter(
                                        collectProduction,
                                        
                                        hour_starting >= DateAdd(locStartDate, -1, TimeUnit.Hours),
                                        hour_ending <= DateAdd(locEndDate, 23, TimeUnit.Hours),
                                        /*Finding XL is more annoying use nots to filter out XLT*/
                                        "XL" in line,
                                        Not("XLT" in line)
                                    ),
                                    reject_cartridges + reject_units

                                /*Multiply by 1 to get Zero amounts when nothing is present in the data for the filtered lines*/
                                ) * 1
                              Align: =Align.Center
                              Color: =varColor5
                              Font: =Font.Verdana
                              Height: =Parent.Height / 2
                              Size: =Self.Width / 12
                              Width: =Parent.Width * 0.25
                              X: =o_r_t_daily_title.X + o_r_t_daily_title.Width * 2
                              Y: =o_r_t_shift_title.Y + o_r_t_shift_title.Height
                        - o_r_t_daily_ssc:
                            Control: Label
                            Properties:
                              Text: |-
                                ="SSC: " &
                                Sum(
                                    Filter(
                                        collectProduction,
                                        
                                        hour_starting >= DateAdd(locStartDate, -1, TimeUnit.Hours),
                                        hour_ending <= DateAdd(locEndDate, 23, TimeUnit.Hours),
                                        "SSC" in line
                                    ),
                                    reject_cartridges + reject_units

                                /*Multiply by 1 to get Zero amounts when nothing is present in the data for the filtered lines*/
                                ) * 1
                              Align: =Align.Center
                              Color: =varColor5
                              Font: =Font.Verdana
                              Height: =Parent.Height / 2
                              Size: =Self.Width / 12
                              Width: =Parent.Width * 0.25
                              X: =o_r_t_daily_title.X + o_r_t_daily_title.Width
                              Y: =o_r_t_shift_title.Y + o_r_t_shift_title.Height
                        - o_r_t_daily_title:
                            Control: Label
                            Properties:
                              Text: ="Daily Totals"
                              Align: =Align.Center
                              Color: =varColor5
                              Font: =Font.Verdana
                              Height: =Parent.Height / 2
                              Size: =Self.Width / 12
                              Width: =Parent.Width * 0.25
                              Y: =o_r_t_shift_title.Y + o_r_t_shift_title.Height
                        - o_r_t_shift_xlt:
                            Control: Label
                            Properties:
                              Text: |-
                                ="XLT: " &
                                Sum(
                                    Filter(
                                        collectProduction,
                                        
                                        hour_starting >= DateAdd(locStartDate, -1, TimeUnit.Hours),
                                        hour_ending <= DateAdd(locEndDate, 23, TimeUnit.Hours),
                                        /*find all XLT*/
                                        "XLT" in line,
                                        If(
                                            o_shift.Selected.Value = "All",
                                            shift = shift,
                                            shift = o_shift.Selected.Value
                                        )
                                    ),
                                    reject_cartridges + reject_units

                                /*Multiply by 1 to get Zero amounts when nothing is present in the data for the filtered lines*/
                                ) * 1
                              Align: =Align.Center
                              Color: =varColor5
                              Font: =Font.Verdana
                              Height: =Parent.Height / 2
                              Size: =Self.Width / 12
                              Width: =Parent.Width * 0.25
                              X: '=o_r_t_shift_title.X + o_r_t_shift_title.Width * 3   '
                        - o_r_t_shift_xl:
                            Control: Label
                            Properties:
                              Text: |-
                                ="XL: " &
                                Sum(
                                    Filter(
                                        collectProduction,
                                        
                                        hour_starting >= DateAdd(locStartDate, -1, TimeUnit.Hours),
                                        hour_ending <= DateAdd(locEndDate, 23, TimeUnit.Hours),
                                        /*Finding XL is more annoying use nots to filter out XLT*/
                                        
                                        "XL" in line,
                                        Not("XLT" in line),
                                        
                                        If(
                                            o_shift.Selected.Value = "All",
                                            shift = shift,
                                            shift = o_shift.Selected.Value
                                        )
                                    ),
                                    reject_cartridges + reject_units

                                /*Multiply by 1 to get Zero amounts when nothing is present in the data for the filtered lines*/
                                ) * 1
                              Align: =Align.Center
                              Color: =varColor5
                              Font: =Font.Verdana
                              Height: =Parent.Height / 2
                              Size: =Self.Width / 12
                              Width: =Parent.Width * 0.25
                              X: =o_r_t_shift_title.X + o_r_t_shift_title.Width * 2
                        - o_r_t_shift_ssc:
                            Control: Label
                            Properties:
                              Text: |-
                                ="SSC: " &
                                Sum(
                                    Filter(
                                        collectProduction,
                                        
                                        hour_starting >= DateAdd(locStartDate, -1, TimeUnit.Hours),
                                        hour_ending <= DateAdd(locEndDate, 23, TimeUnit.Hours),
                                        
                                        /*find all ssc*/
                                        "SSC" in line,
                                        If(
                                            o_shift.Selected.Value = "All",
                                            shift = shift,
                                            shift = o_shift.Selected.Value
                                        )
                                    ),
                                    reject_cartridges + reject_units

                                /*Multiply by 1 to get Zero amounts when nothing is present in the data for the filtered lines*/
                                ) * 1
                              Align: =Align.Center
                              Color: =varColor5
                              Font: =Font.Verdana
                              Height: =Parent.Height / 2
                              Size: =Self.Width / 12
                              Width: =Parent.Width * 0.25
                              X: =o_r_t_shift_title.X + o_r_t_shift_title.Width
                        - o_r_t_shift_title:
                            Control: Label
                            Properties:
                              Text: ="Shift Totals"
                              Align: =Align.Center
                              Color: =varColor5
                              Font: =Font.Verdana
                              Height: =Parent.Height / 2
                              Size: =Self.Width / 12
                              Width: =Parent.Width * 0.25
                    - o_r_columns:
                        Control: GroupContainer
                        Variant: manualLayoutContainer
                        Properties:
                          AlignInContainer: =AlignInContainer.SetByContainer
                          DropShadow: =DropShadow.None
                          Fill: =varColor4
                          FillPortions: =0.5
                          LayoutMinHeight: =1
                          RadiusBottomLeft: =0
                          RadiusBottomRight: =0
                          RadiusTopLeft: =0
                          RadiusTopRight: =0
                          Width: =Parent.Width
                        Children:
                        - o_r_c_rejects:
                            Control: Label
                            Properties:
                              Text: ="Rejects"
                              Align: =Align.Center
                              Color: =varColor0
                              Font: =Font.Verdana
                              Height: =Parent.Height
                              Size: =Self.Width / 18
                              Width: =Parent.Width / 2
                              X: =o_r_c_line.X + o_r_c_line.Width
                        - o_r_c_line:
                            Control: Label
                            Properties:
                              Text: ="Line"
                              Align: =Align.Center
                              Color: =varColor0
                              Font: =Font.Verdana
                              Height: =Parent.Height
                              Size: =Self.Width / 18
                              Width: =Parent.Width / 2
                    - o_r_gallery:
                        Control: Gallery
                        Variant: galleryVertical
                        Properties:
                          Items: =collectLocalRejectData
                          AlignInContainer: =AlignInContainer.SetByContainer
                          DelayItemLoading: =true
                          FillPortions: =6.5
                          Layout: =Layout.Vertical
                          LayoutMinHeight: =1
                          LoadingSpinner: =LoadingSpinner.Data
                          TemplatePadding: =0
                          TemplateSize: =Self.Height / 10
                          Width: =Parent.Width
                        Children:
                        - o_r_g_line:
                            Control: Label
                            Properties:
                              Text: =ThisItem.line
                              Align: =Align.Center
                              Color: =varColor0
                              Font: =Font.Verdana
                              Height: =Parent.TemplateHeight - o_r_g_seperator.Height
                              Size: =Self.Width / 16
                              Width: =Parent.TemplateWidth / 2
                        - o_r_g_rejects:
                            Control: Label
                            Properties:
                              Text: =ThisItem.total
                              Align: =Align.Center
                              Color: =varColor0
                              Font: =Font.Verdana
                              Height: =Parent.TemplateHeight - o_r_g_seperator.Height
                              Size: =Self.Width / 16
                              Width: =Parent.TemplateWidth / 2
                              X: =o_r_g_line.X + o_r_g_line.Width
                        - o_r_g_seperator:
                            Control: Rectangle
                            Properties:
                              OnSelect: =Select(Parent)
                              Fill: =varColor1
                              Height: =Parent.TemplateHeight * 0.025
                              Width: =Parent.Width
                              Y: =Parent.TemplateHeight - Self.Height
                    - o_r_copy:
                        Control: Classic/Button
                        Properties:
                          OnSelect: |
                            =IfError(

                                Copy(
                                    Concat(
                                        collectLocalRejectData,
                                        If(IsBlankOrError(total), 0, total),
                                        Char(9)
                                    )
                                ),

                                /*New bug with teams, cannot copy so show error*/
                                Notify("Cannot copy data from New Teams, or other embeded tools. Please open this app in a web browser.", NotificationType.Error)
                            );
                          Text: ="Copy Rejects"
                          Color: =varColor0
                          Fill: =varColorAccent
                          FillPortions: =0.5
                          Font: =Font.Verdana
                          HoverColor: =varColor5
                          LayoutMinHeight: =1
                          Size: =Self.Width / 20
                          Width: =Parent.Width * 0.50
