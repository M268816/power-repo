- oeeLayout:
    Control: GroupContainer@1.3.0
    Variant: AutoLayout
    Properties:
      DropShadow: =DropShadow.None
      Fill: =gblTheme.Background
      Height: =Parent.Height
      LayoutAlignItems: =LayoutAlignItems.Stretch
      LayoutDirection: =LayoutDirection.Vertical
      RadiusBottomLeft: =0
      RadiusBottomRight: =0
      RadiusTopLeft: =0
      RadiusTopRight: =0
      Width: =Parent.Width
    Children:
      - oeeCollect:
          Control: Classic/Button@2.2.0
          Properties:
            AlignInContainer: =AlignInContainer.Start
            OnSelect: |-
              =/*Start*/
              Patch(recPopups,First(recPopups),{Visible: true, Value: 10, Popup: "loading", Display_Text: "Loading"});

              Set(gblTime,{Today:Today(),Now:Now()});

              /*Capture Local Date Selection*/
              UpdateContext({
                  locEndDate: oeeEndDate.SelectedDate,
                  locStartDate: oeeStartDate.SelectedDate
              });

              /*Collect Production*/
              Patch(recPopups,First(recPopups),{Value: 20, Display_Text: "Collecting Production Data"});

              ClearCollect(colProduction,
                  ForAll(
                      Filter(Production,
                          Hour_Ending <= DateAdd(locEndDate, 23, TimeUnit.Hours),
                          Hour_Starting >= DateAdd(locStartDate, -1, TimeUnit.Hours)
                      ),
                      {
                          Id: Value(ThisRecord.ID),
                          Shift: Text(ThisRecord.Shift_Letter),
                          Line: Text(ThisRecord.Line.Value),
                          Lot: Text(ThisRecord.Lot),
                          Catalog: Text(ThisRecord.Catalog),
                          Size: Text(ThisRecord.Size),
                          Hour_Ending: DateTimeValue(ThisRecord.Hour_Ending),
                          Hour_Starting: DateTimeValue(ThisRecord.Hour_Starting),
                          Goal: Value(ThisRecord.Hourly_Goal),
                          Amount_Built: Value(ThisRecord.Amount_Built),
                          Unit_Starting: Value(ThisRecord.Unit_Starting),
                          Unit_Ending: Value(ThisRecord.Unit_Ending),
                          Reject_Labels: Value(ThisRecord.Reject_Labels),
                          Reject_Cartridges: Value(ThisRecord.Reject_Cartridges),
                          Reject_Units: Value(ThisRecord.Reject_Units),
                          QA_Units: Value(ThisRecord.QA_Units)
                      }
                  )
              );

              /*Collect Downtime*/
              Patch(recPopups,First(recPopups),{Value: 30, Display_Text: "Collecting Downtime Data"});

              ClearCollect(colDowntime,
                  ForAll(
                      Filter(Downtime,
                          Ended <= DateAdd(locEndDate, 23, TimeUnit.Hours),
                          Started >= DateAdd(locStartDate, -1, TimeUnit.Hours)
                      ),
                      {
                          Id: Value(ThisRecord.ID),
                          Shift: Text(ThisRecord.Shift_Letter),
                          Line: Text(ThisRecord.Line.Value),
                          Lot: Text(ThisRecord.Lot),
                          Catalog: Text(ThisRecord.Catalog),
                          Size: Text(ThisRecord.Size),
                          Started: DateTimeValue(ThisRecord.Started),
                          Ended: DateTimeValue(ThisRecord.Ended),
                          Reason: Text(ThisRecord.Reason.Value),
                          Total_Downtime: Value(ThisRecord.Total_Downtime),
                          Comments: Text(ThisRecord.Comments)
                      }
                  )
              );

              Select(oeeUpdate);
            Text: ="collect"
            Visible: =false
      - oeeSequentialCollect:
          Control: Timer@2.1.0
          Properties:
            AlignInContainer: =AlignInContainer.Start
            Text: =Text(Time(0, 0, Self.Duration/1000 - Self.Value/1000), "hh:mm:ss")
            Visible: =false
      - oeeUpdate:
          Control: Classic/Button@2.2.0
          Properties:
            AlignInContainer: =AlignInContainer.Start
            OnSelect: "=Patch(recPopups,First(recPopups),{Visible: true, Value: 40, Popup: \"loading\", Display_Text: \"Creating Default Filters\"});\n\nUpdateContext({locProductionFilter:\n    Filter(colProduction,\n        Hour_Starting >= DateAdd(oeeStartDate.SelectedDate, -1, TimeUnit.Hours),\n        Hour_Ending <= DateAdd(oeeEndDate.SelectedDate, 23, TimeUnit.Hours),\n        If(\n            oeeLine.Selected.Value = \"All\",\n            Line = Line,\n            oeeLine.Selected.Value = \"Only SSCs\",\n            Line = \"SSC\" || Line = \"SSC2\",\n            oeeLine.Selected.Value = \"Only XLs\",\n            Line = \"XL1\" || Line = \"XL2\" || Line = \"XL3\" || Line = \"XL4\" || Line = \"XL5\",\n            oeeLine.Selected.Value = \"Only XLTs\",\n            Line = \"XLT\" || Line = \"XLT2\",\n            Line = oeeLine.Selected.Value\n        )\n    )\n});\n\nUpdateContext({locDowntimeFilter:\n    Filter(colDowntime,\n        Started >= DateAdd(DateValue(oeeStartDate.SelectedDate), -1, TimeUnit.Hours),\n        Ended <= DateAdd(DateValue(oeeEndDate.SelectedDate), 23, TimeUnit.Hours),\n        If(\n            oeeLine.Selected.Value = \"All\",\n            Line = Line,\n            oeeLine.Selected.Value = \"Only SSCs\",\n            Line = \"SSC\" || Line = \"SSC2\",\n            oeeLine.Selected.Value = \"Only XLs\",\n            Line = \"XL1\" || Line = \"XL2\" || Line = \"XL3\" || Line = \"XL4\" || Line = \"XL5\",\n            oeeLine.Selected.Value = \"Only XLTs\",\n            Line = \"XLT\" || Line = \"XLT2\",\n            Line = oeeLine.Selected.Value\n        )\n    )\n});\n\nUpdateContext({locGoalSettings:\n    ForAll(Goal_Settings,\n        {\n            Constraint_Setting: ThisRecord.Constraint_Setting,\n            Line: ThisRecord.Line,\n            Size: ThisRecord.Size\n        }\n    )\n});\n\nUpdateContext(\n    {        \n        locCountOfDays:\n            RoundDown(\n                DateDiff(oeeStartDate.SelectedDate, oeeEndDate.SelectedDate, TimeUnit.Days) / 7,\n                0\n            ) * 5 +\n            Mod(5 + Weekday(oeeEndDate.SelectedDate) - Weekday(oeeStartDate.SelectedDate), 5) + 1\n    }\n);\n\n\n/*Collect Top Downtime*/\nPatch(recPopups,First(recPopups),{Value: 50, Display_Text: \"Processing Top Downtime Reasons\"});\n\nClear(colTopDowntime);\n\nForAll(Distinct(locDowntimeFilter, Reason),\n    With({thisReason: ThisRecord.Value},\n        If(Sum(Filter(locDowntimeFilter, thisReason = Reason), Total_Downtime) > 0,\n            Collect(colTopDowntime,\n                {\n                    Downtime_Reason: thisReason,\n                    Total_Downtime: Sum(Filter(locDowntimeFilter, thisReason = Reason), Total_Downtime)\n                }\n            )            \n        )\n    )\n);\n\n/* Collect TPS OEE */\nPatch(recPopups,First(recPopups),{Value: 60, Display_Text: \"Processing TPS OEE\"});\n\nClear(APQTest);\nWith(\n    {\n        thisRuntime:\n            CountRows(\n                Filter(colProduction,\n                    Hour_Starting >= DateAdd(locStartDate, -1, TimeUnit.Hours),\n                    Hour_Ending < DateAdd(locEndDate, 23, TimeUnit.Hours),\n                    Unit_Starting > 0\n                )\n            )*60,\n        thisDowntime:\n            Sum(\n                Filter(colDowntime,\n                    Started >= DateAdd(locStartDate, -1, TimeUnit.Hours),\n                    Ended < DateAdd(locEndDate, 23, TimeUnit.Hours),\n                    Not(Reason in gblLists.Downtime_Reasons_Planned)\n                ),\n                Total_Downtime\n            ),\n        thisTotalTime:\n            DateDiff(\n                DateAdd(locStartDate, -1, TimeUnit.Hours),\n                DateAdd(locEndDate, 23, TimeUnit.Hours),\n                TimeUnit.Hours\n            ) *\n            60 *\n            If(oeeLine.Selected.Value = \"All\", 9, 1),\n        thisTotalUnits:\n            Sum(\n                Filter(colProduction,\n                    Hour_Starting >= DateAdd(locStartDate, -1, TimeUnit.Hours),\n                    Hour_Ending < DateAdd(locEndDate, 23, TimeUnit.Hours)\n                ),\n                Amount_Built + Reject_Units + Reject_Labels + QA_Units\n            ),\n        thisGoodUnits:\n            Sum(\n                Filter(colProduction,\n                    Hour_Starting >= DateAdd(locStartDate, -1, TimeUnit.Hours),\n                    Hour_Ending < DateAdd(locEndDate, 23, TimeUnit.Hours)\n                ),\n                Amount_Built\n            ),\n        thisConstraintPerHour:\n            Round(RoundUp(Average(locGoalSettings, Constraint_Setting),-1)/60,4)\n    },\n    Collect(APQTest,\n        {\n            Runtime: thisRuntime,\n            Downtime: thisDowntime,\n            Total_Time: thisTotalTime,\n            Total_Units: thisTotalUnits,\n            Good_Units: thisGoodUnits,\n            ConstraintPerHour: thisConstraintPerHour\n        }\n    );\n    Set(recAvailability,\n        IfError(\n            thisRuntime / (thisTotalTime - thisDowntime),\n            0\n        )\n    );\n    Set(recPerformance,\n        IfError(\n            (thisTotalUnits/thisRuntime)/thisConstraintPerHour,\n            0\n        )\n    );\n    Set(recQuality,\n        IfError(\n            thisGoodUnits/thisTotalUnits,\n            0\n        )\n    );\n    Set(recOEE, recAvailability * recPerformance * recQuality);\n);\n\n\n/*Collect data for pareto chart*/\nPatch(recPopups,First(recPopups),{Value: 70, Display_Text: \"Building Pareto Charts\"});\n\nClear(colPareto);\n/*\n    For all colTopDowntime,\n    Sorted and filtered by user selections,\n    Create pareto data in colPareto.\n*/\nForAll(\n    Sort(\n        Filter(colTopDowntime,\n            If(\n                oeeDowntime.Selected.Value = \"Unplanned Only\",\n                Not(Downtime_Reason in gblLists.Downtime_Reasons_Planned),\n                Downtime_Reason = Downtime_Reason\n            )\n        ),\n        Total_Downtime,\n        SortOrder.Descending\n    ),\n    Collect(colPareto,\n        {\n            Id: CountRows(colPareto)+1,\n            \n            /*Debugging value*/\n            Id_lookup: LookUp(colPareto, Id = CountRows(colPareto)).Id,\n            \n            Reason: Downtime_Reason,\n\n            Total_Downtime: ThisRecord.Total_Downtime,\n\n            Sum: Sum(colTopDowntime,Total_Downtime),\n            \n            Freq:\n                /*Frequency = This record's downtime / Sum of Total_Downtime downtime */\n                Round(\n                    ThisRecord.Total_Downtime /\n                    Sum(\n                        Filter(colTopDowntime,\n                            If(\n                                oeeDowntime.Selected.Value = \"Unplanned Only\", \n                                Not(Downtime_Reason in gblLists.Downtime_Reasons_Planned),\n                                Downtime_Reason = Downtime_Reason\n                            )\n                        ),\n                        Total_Downtime\n                    ) * 100,2\n                ),\n\n            Cumulative:\n                /*Cumulative percentage = (this record's downtime / Sum of Total_Downtime downtime) + the last record's Cumulative percentage */\n                Round(\n                    ThisRecord.Total_Downtime / \n                    Sum(\n                        Filter(colTopDowntime,\n                            If(\n                                oeeDowntime.Selected.Value = \"Unplanned Only\", \n                                Not(Downtime_Reason in gblLists.Downtime_Reasons_Planned),\n                                Downtime_Reason = Downtime_Reason\n                            )\n                        ),\n                        Total_Downtime\n                    ) * 100,0\n                ) + \n                If(\n                    CountRows(colPareto) >= 1,\n                    LookUp(colPareto, Id = CountRows(colPareto)).Cumulative,\n                    0\n                )\n        }\n    )\n);\n\n/*Combine production and downtime databases to find Runtime*/\nPatch(recPopups,First(recPopups),{Value: 80, Display_Text: \"Combining Production and Downtime Resources\"});\n\nClear(colCombinedData);\n\n/*Collect all Production Data*/\nClearCollect(colCombinedData,\n    Filter(\n        colProduction,\n        And(\n            Hour_Starting >= DateAdd(oeeStartDate.SelectedDate, -1, TimeUnit.Hours),\n            Hour_Ending <= DateAdd(oeeEndDate.SelectedDate, 23, TimeUnit.Hours)\n        )\n    )\n);\n/*Collect downtime data that does not fall within produciton data*/\nForAll(\n    gblLists.Lines,\n    {\n        Line: Value,\n        \n        Value:\n        ForAll(Filter(locDowntimeFilter, Line = Value),\n            With(\n                {\n                    thisDowntime: ThisRecord,\n                    thisLine: Value\n                },\n                If(\n                    CountRows(\n                        Filter(locProductionFilter,\n                            Line = Value,\n                            (Hour_Starting <= thisDowntime.Started && Hour_Ending > thisDowntime.Started) || \n                            (Hour_Starting < thisDowntime.Ended && Hour_Ending >= thisDowntime.Ended) ||\n                            (Hour_Starting >= thisDowntime.Started && Hour_Ending <= thisDowntime.Ended)\n                        )\n                    ) = 0,\n                    Collect(colCombinedData, thisDowntime)\n                )\n            )\n        )\n    }\n);\n\n/*Gather Shift Specific OEE Data*/\nPatch(recPopups,First(recPopups),{Value: 90, Display_Text: \"Calculating OEE2\"});\n\n/*Init this collection here or powerapps breaks*/\nClearCollect(colShiftOEE2Data, {Shift: \"A\"});\n/*\n    For each Shift,\n    for each Line,\n    for each Catalog,\n    collect Outputs, constraints, and Runtime.\n*/\nClear(colShiftOEE2Data);\nWith(\n    {\n        theseLines:\n            If(\n                oeeLine.Selected.Value = \"All\",\n                [\"XL1\", \"XL2\", \"XL3\", \"XL4\", \"XL5\", \"SSC\", \"SSC2\", \"XLT\", \"XLT2\"],\n                oeeLine.Selected.Value = \"Only SSCs\",\n                [\"SSC\", \"SSC2\"],\n                oeeLine.Selected.Value = \"Only XLs\",\n                [\"XL1\", \"XL2\", \"XL3\", \"XL4\", \"XL5\"],\n                oeeLine.Selected.Value = \"Only XLTs\",\n                [\"XLT\", \"XLT2\"],\n                [oeeLine.Selected.Value]\n            ),\n        theseCatalogs:\n            If(\n                oeeLine.Selected.Value = \"All\",\n                [\"51\", \"02\", \"03\", \"04\", \"05\", \"10\", \"015\", \"003\", \"006\", \"1F\", \"1H\", \"1S\", \"1T\", \"1Z\", \"2F\", \"2H\", \"2S\", \"2T\", \"2Z\", \"3F\", \"3H\", \"3S\", \"3T\", \"3Z\"],\n                oeeLine.Selected.Value = \"Only SSCs\",\n                [\"015\", \"003\", \"006\"],\n                oeeLine.Selected.Value = \"Only XLs\",\n                [\"51\", \"02\", \"03\", \"04\", \"05\", \"10\"],\n                oeeLine.Selected.Value = \"Only XLTs\",\n                [\"1F\", \"1H\", \"1S\", \"1T\", \"1Z\", \"2F\", \"2H\", \"2S\", \"2T\", \"2Z\", \"3F\", \"3H\", \"3S\", \"3T\", \"3Z\"],\n                [\"51\", \"02\", \"03\", \"04\", \"05\", \"10\", \"015\", \"003\", \"006\", \"1F\", \"1H\", \"1S\", \"1T\", \"1Z\", \"2F\", \"2H\", \"2S\", \"2T\", \"2Z\", \"3F\", \"3H\", \"3S\", \"3T\", \"3Z\"]\n            ),\n        theseShifts:\n            [\"A\",\"B\",\"C\"]\n    },\n    ForAll(theseShifts,\n        With({thisShift: ThisRecord.Value},\n            ForAll(theseLines,\n                With({thisLine: ThisRecord.Value},\n                    ForAll(theseCatalogs,\n                        With({thisCatalog: ThisRecord.Value},\n                            If(\n                                Sum(\n                                    Filter(colProduction,\n                                        And(\n                                            Hour_Starting >= DateAdd(oeeStartDate.SelectedDate, -1, TimeUnit.Hours),\n                                            Hour_Ending <= DateAdd(oeeEndDate.SelectedDate, 23, TimeUnit.Hours)\n                                        ),\n                                        Line = thisLine,\n                                        Size = thisCatalog,\n                                        Shift = thisShift\n                                    ),\n                                    Amount_Built\n                                ) > 0,\n                            \n                                Collect(colShiftOEE2Data,\n                                    {\n                                        Shift: thisShift,\n                                        \n                                        Line: thisLine,\n                                        \n                                        Catalog: thisCatalog,\n                                        \n                                        Constraint_Setting:\n                                            IfError(\n                                                Average(\n                                                    Filter(locGoalSettings,\n                                                        Line.Value = thisLine,\n                                                        Size.Value = thisCatalog,\n                                                        Constraint_Setting > 0\n                                                    ), Constraint_Setting\n                                                ),\n                                                0\n                                            ),\n                                            \n                                        Output:\n                                            Sum(\n                                                Filter(colProduction,\n                                                    And(\n                                                        Hour_Starting >= DateAdd(oeeStartDate.SelectedDate, -1, TimeUnit.Hours),\n                                                        Hour_Ending <= DateAdd(oeeEndDate.SelectedDate, 23, TimeUnit.Hours)\n                                                    ),\n                                                    Line = thisLine,\n                                                    Size = thisCatalog,\n                                                    Shift = thisShift\n                                                ),\n                                                Amount_Built\n                                            ),\n                                        \n                                        Rejects:\n                                            Sum(\n                                                Filter(colProduction,\n                                                    And(\n                                                        Hour_Starting >= DateAdd(oeeStartDate.SelectedDate, -1, TimeUnit.Hours),\n                                                        Hour_Ending <= DateAdd(oeeEndDate.SelectedDate, 23, TimeUnit.Hours)\n                                                    ),\n                                                    Line = thisLine,\n                                                    Size = thisCatalog,\n                                                    Shift = thisShift\n                                                ),\n                                                Reject_Cartridges + Reject_Units\n                                            ),\n                                        \n                                        Runtime:\n                                            (\n                                                /*Collect Runtime Minutes From Production*/\n                                                (CountRows(\n                                                    Filter(colCombinedData,\n                                                        Amount_Built > 0,\n                                                        Line = thisLine,\n                                                        Size = thisCatalog,\n                                                        Shift = thisShift\n                                                    )\n                                                ) * 60) +\n                                                /*Collect Runtime Minues From Downtime*/\n                                                Sum(\n                                                    Filter(colCombinedData,\n                                                        Line = thisLine,\n                                                        Size = thisCatalog,\n                                                        Shift = thisShift,\n                                                        Not(Reason in gblLists.Downtime_Reasons_Planned)\n                                                    ),\n                                                    Total_Downtime\n                                                )\n                                            )/60,\n                                    \n                                        Constraint_Goal:\n                                            /*Constraint *  Runtime*/\n                                            /*Constraint*/\n                                            IfError(\n                                                Average(\n                                                    Filter(locGoalSettings,\n                                                        Line.Value = thisLine,\n                                                        Size.Value = thisCatalog,\n                                                        Constraint_Setting > 0\n                                                    ), Constraint_Setting\n                                                ),\n                                                0\n                                            ) *\n                                            /* Runtime */\n                                            (\n                                                /*Collect Runtime Minutes From Production*/\n                                                (CountRows(\n                                                    Filter(colCombinedData,\n                                                        Amount_Built > 0,\n                                                        Line = thisLine,\n                                                        Size = thisCatalog,\n                                                        Shift = thisShift\n                                                    )\n                                                ) * 60) +\n                                                /*Collect Runtime Minues From Downtime*/\n                                                Sum(\n                                                    Filter(colCombinedData,\n                                                        Line = thisLine,\n                                                        Size = thisCatalog,\n                                                        Shift = thisShift,\n                                                        Not(Reason in gblLists.Downtime_Reasons_Planned)\n                                                    ),\n                                                    Total_Downtime\n                                                )\n                                            ) / 60\n                                    }\n                                )\n                            )\n                        )\n                    )\n                )\n            )\n        )\n    )\n);\n\n/*Calculate Shift Specific OEE Data*/\nClear(colShiftOEE);\n\nForAll(gblLists.Shifts,\n    Collect(colShiftOEE,\n        {\n            Constraint_Average:\n                IfError(\n                    Round(\n                        Average(\n                            Filter(colShiftOEE2Data,\n                                Output > 0 ,\n                                Shift = Value\n                            ),\n                            Constraint_Setting\n                        ),\n                        4\n                    ),\n                    0\n                ),\n\n            Constraint_Goal:\n                IfError(\n                    Round(\n                        Sum(\n                            Filter(colShiftOEE2Data,\n                                Output > 0,\n                                Shift = Value\n                            ),\n                            Constraint_Goal\n                        ),\n                        4\n                    ),\n                    0\n                ),\n            \n            Downtime_Planned:\n                Sum(\n                    Filter(locDowntimeFilter,\n                        Shift = Value,\n                        Reason in gblLists.Downtime_Reasons_Planned\n                    ),\n                    Total_Downtime\n                ),\n\n            Downtime_Unplanned:\n                Sum(\n                    Filter(locDowntimeFilter,\n                        Shift = Value,\n                        Not(Reason in gblLists.Downtime_Reasons_Planned)\n                    ),\n                    Total_Downtime\n                ),\n\n            Downtime_Total:\n                Sum(\n                    Filter(locDowntimeFilter,\n                        Shift = Value\n                    ),\n                    Total_Downtime\n                ),\n\n            OEE2:\n                IfError(\n                    Round(\n                        Sum(\n                            Filter(colShiftOEE2Data, Output > 0, Shift = Value),\n                            Output\n                        ) /\n                        Sum(\n                            Filter(colShiftOEE2Data, Output > 0, Shift = Value),\n                            Constraint_Goal\n                        ) * 100,\n                        2\n                    ),\n                    0\n                ),\n\n            Amount_Total:\n                IfError(\n                    Sum(\n                        Filter(colShiftOEE2Data,\n                            Output > 0,\n                            Shift = Value\n                        ),\n                        Output + Rejects\n                    ),\n                    0\n                ),\n            \n            Amount_Good:\n                IfError(\n                    Sum(\n                        Filter(colShiftOEE2Data,\n                            Output > 0,\n                            Shift = Value\n                        ),\n                        Output\n                    ),\n                    0\n                ),\n            \n            Amount_Rejected:\n                IfError(\n                    Sum(\n                        Filter(colShiftOEE2Data,\n                            Output > 0,\n                            Shift = Value\n                        ),\n                        Rejects\n                    ),\n                    0\n                ),\n\n            Runtime_Hours: \n                Sum(\n                    Filter(colShiftOEE2Data,\n                        Output > 0,\n                        Shift = Value\n                    ),\n                    Runtime\n                ),\n\n            Runtime_Total:\n                (If(\n                oeeLine.Selected.Value = \"All\",\n                locCountOfDays * 9,\n                oeeLine.Selected.Value = \"Only SSCs\",\n                locCountOfDays * 2,\n                oeeLine.Selected.Value = \"Only XLs\",\n                locCountOfDays * 5,\n                oeeLine.Selected.Value = \"Only XLTs\",\n                locCountOfDays * 2,\n                locCountOfDays\n                ) * 480)/60, \n            \n            Shift: Value\n\n        }\n    )\n);\n\n/*Gather OEE Data*/\nClear(colOEE2Data);\n\n/*\n    For all Lines,\n    For all Catalogs,\n    collect Output, constraints, and Runtime\n*/\nWith(\n    {\n        theseLines:\n            If(\n                oeeLine.Selected.Value = \"All\",\n                [\"XL1\", \"XL2\", \"XL3\", \"XL4\", \"XL5\", \"SSC\", \"SSC2\", \"XLT\", \"XLT2\"],\n                oeeLine.Selected.Value = \"Only SSCs\",\n                [\"SSC\", \"SSC2\"],\n                oeeLine.Selected.Value = \"Only XLs\",\n                [\"XL1\", \"XL2\", \"XL3\", \"XL4\", \"XL5\"],\n                oeeLine.Selected.Value = \"Only XLTs\",\n                [\"XLT\", \"XLT2\"],\n                [oeeLine.Selected.Value]\n            ),\n        theseCatalogs:\n            If(\n                oeeLine.Selected.Value = \"All\",\n                [\"51\", \"02\", \"03\", \"04\", \"05\", \"10\", \"015\", \"003\", \"006\", \"1F\", \"1H\", \"1S\", \"1T\", \"1Z\", \"2F\", \"2H\", \"2S\", \"2T\", \"2Z\", \"3F\", \"3H\", \"3S\", \"3T\", \"3Z\"],\n                oeeLine.Selected.Value = \"Only SSCs\",\n                [\"015\", \"003\", \"006\"],\n                oeeLine.Selected.Value = \"Only XLs\",\n                [\"51\", \"02\", \"03\", \"04\", \"05\", \"10\"],\n                oeeLine.Selected.Value = \"Only XLTs\",\n                [\"1F\", \"1H\", \"1S\", \"1T\", \"1Z\", \"2F\", \"2H\", \"2S\", \"2T\", \"2Z\", \"3F\", \"3H\", \"3S\", \"3T\", \"3Z\"],\n                [\"51\", \"02\", \"03\", \"04\", \"05\", \"10\", \"015\", \"003\", \"006\", \"1F\", \"1H\", \"1S\", \"1T\", \"1Z\", \"2F\", \"2H\", \"2S\", \"2T\", \"2Z\", \"3F\", \"3H\", \"3S\", \"3T\", \"3Z\"]\n            )\n    },\n    ForAll(theseLines,\n        With({thisLine: ThisRecord.Value},\n            ForAll(theseCatalogs,\n                With({thisCatalog: ThisRecord.Value},\n                    If(\n                        Sum(\n                            Filter(colProduction,\n                                And(\n                                    Hour_Starting >= DateAdd(oeeStartDate.SelectedDate, -1, TimeUnit.Hours),\n                                    Hour_Ending <= DateAdd(oeeEndDate.SelectedDate, 23, TimeUnit.Hours)\n                                ),\n                                Line = thisLine,\n                                Size = thisCatalog\n                            ),\n                            Amount_Built\n                        ) > 0,\n                    \n                        Collect(colOEE2Data,\n                            {\n                                Line: thisLine,\n                                \n                                Catalog: thisCatalog,\n                                \n                                Constraint_Setting:\n                                    IfError(\n                                        First(Filter(locGoalSettings, Line.Value = thisLine, Size.Value = thisCatalog)).Constraint_Setting,\n                                        0\n                                    ),\n                                    \n                                Output:\n                                    Sum(\n                                        Filter(locProductionFilter,\n                                            Line = thisLine,\n                                            Size = thisCatalog\n                                        ),\n                                        Amount_Built\n                                    ),\n                                \n                                Runtime:\n                                    (\n                                        /*Collect Runtime minutes from production*/\n                                        (CountRows(\n                                            Filter(colCombinedData,\n                                                Amount_Built > 0,\n                                                Line = thisLine,\n                                                Size = thisCatalog\n                                            )\n                                        ) * 60) +\n                                        /*Collect Runtime minutes from downtime*/\n                                        Sum(\n                                            Filter(colCombinedData,\n                                                Line = thisLine,\n                                                Size = thisCatalog,\n                                                Not(Reason in gblLists.Downtime_Reasons_Planned)\n                                            ),\n                                            Total_Downtime\n                                        )\n                                    )/60,\n                            \n                                Constraint_Goal:\n                                    /*Constraint *  Runtime*/\n                                    /*Constraint*/\n                                    IfError(\n                                        First(Filter(locGoalSettings, Line.Value = thisLine, Size.Value = thisCatalog)).Constraint_Setting,\n                                        0\n                                    ) *\n                                    /* Runtime */\n                                    (\n                                        /*Collect Runtime minutes from production*/\n                                        (CountRows(\n                                            Filter(colCombinedData,\n                                                Amount_Built > 0,\n                                                Line = thisLine,\n                                                Size = thisCatalog\n                                            )\n                                        ) * 60) +\n                                        /*Collect Runtime minutes from downtime*/\n                                        Sum(\n                                            Filter(colCombinedData,\n                                                Line = thisLine,\n                                                Size = thisCatalog,\n                                                Not(Reason in gblLists.Downtime_Reasons_Planned)\n                                            ),\n                                            Total_Downtime\n                                        )\n                                    ) / 60\n                            }\n                        )\n                    )\n                )\n            )\n        )   \n    )\n);\n\n/*Collect OEE2*/\nClear(recOEE2);\n\nWith(\n    {\n        thisConstraintAverage:\n            IfError(\n                Average(Filter(colOEE2Data, Constraint_Setting > 0),\n                    Constraint_Setting\n                ),\n                0\n            ),\n\n        thisConstraintGoal:\n            IfError(\n                Sum(colOEE2Data,\n                    Constraint_Goal\n                ),\n                0\n            ),\n\n        thisAmountGood:\n            IfError(\n                Sum(colOEE2Data,\n                    Output\n                ),\n                0\n            ),\n\n        thisAmountRejected:\n            Sum(locProductionFilter,\n                Reject_Cartridges + Reject_Units\n            ),\n        \n        thisRuntime:\n            /* This isnt accurate, taking runtime directly from downtime - total runtime instead\n            IfError(\n                Sum(colOEE2Data,\n                    Runtime\n                ),\n                0\n            )\n            */\n            \n            If(\n                oeeLine.Selected.Value = \"All\",\n                1440 * 9 * locCountOfDays,\n                oeeLine.Selected.Value = \"Only SSCs\",\n                1440 * 2 * locCountOfDays,\n                oeeLine.Selected.Value = \"Only XLs\",\n                1440 * 5 * locCountOfDays,\n                oeeLine.Selected.Value = \"Only XLTs\",\n                1440 * 3 * locCountOfDays,\n                1440 * locCountOfDays\n            ) - \n            Sum(locDowntimeFilter,\n                Total_Downtime\n            ),\n\n        thisRuntimeTotal:\n            If(\n                oeeLine.Selected.Value = \"All\",\n                1440 * 9 * locCountOfDays,\n                oeeLine.Selected.Value = \"Only SSCs\",\n                1440 * 2 * locCountOfDays,\n                oeeLine.Selected.Value = \"Only XLs\",\n                1440 * 5 * locCountOfDays,\n                oeeLine.Selected.Value = \"Only XLTs\",\n                1440 * 3 * locCountOfDays,\n                1440 * locCountOfDays\n            ),\n        \n        thisTotalDowntime:\n            Sum(locDowntimeFilter,\n                Total_Downtime\n            ),\n        \n        thisPlannedDowntime:\n            Sum(Filter(locDowntimeFilter, Reason in gblLists.Downtime_Reasons_Planned),\n                Total_Downtime\n            ),\n\n        thisUnplannedDowntime:\n            Sum(Filter(locDowntimeFilter, Not(Reason in gblLists.Downtime_Reasons_Planned)),\n                Total_Downtime\n            )\n    },\n    Collect(recOEE2,\n        {\n            Availability:\n                IfError(\n                    Round(\n                        (thisRuntime / (thisRuntimeTotal / 60)) * 100,\n                        0\n                    ),\n                    0\n                ),\n            \n            Constraint_Goal: thisConstraintGoal,\n\n            Constraint_Average: thisConstraintAverage,\n\n            Downtime_Total: thisTotalDowntime,\n            \n            Downtime_Planned: thisPlannedDowntime,\n            \n            Downtime_Unplanned: thisUnplannedDowntime,\n                            \n            OEE2:\n                IfError(\n                    Round(\n                        (thisAmountGood / thisConstraintGoal),\n                        2\n                    ) * 100,\n                    0\n                ),\n\n            \n            Amount_Total: thisAmountGood + thisAmountRejected,\n\n            Amount_Good: thisAmountGood,\n\n            Amount_Rejected: thisAmountRejected,\n\n            Runtime: thisRuntime,\n            \n            Runtime_Total: thisRuntimeTotal,\n            \n            Yield:\n                IfError(\n                    Round(\n                        (thisAmountGood / (thisAmountGood + thisAmountRejected)) * 100,\n                        0\n                    ),\n                    0\n                )\n            \n        }\n    )\n);\n\n\n/*Garbage collection*/\nPatch(recPopups,First(recPopups),{Value: 100, Display_Text: \"Garbage Collection\"});\n\n/*UpdateContext({\n    locProductionFilter: Blank(),\n    locDowntimeFilter: Blank(),\n    locGoalSettings: Blank()\n});\nClear(colCombinedData);\nClear(colShiftOEE2Data);\nClear(colOEE2Data);\n*/\n\n/*End*/\nPatch(recPopups,First(recPopups),{Visible: false, Value: -1, Popup: \"\", Display_Text: \"Finishing Up\"});"
            Text: ="update"
            Visible: =false
      - oeeHeader:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.None
            Fill: =gblTheme.Primary
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Horizontal
            LayoutGap: =gblPadding
            LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
            LayoutMinHeight: =10
            LayoutMinWidth: =10
            PaddingBottom: =gblPadding
            PaddingLeft: =gblPadding
            PaddingRight: =gblPadding
            PaddingTop: =gblPadding
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
          Children:
            - oeeLogo:
                Control: Image@2.2.3
                Properties:
                  Image: =If(gblTheme.Style = "Light", logo1, logo2)
                  LayoutMinHeight: =10
                  Width: =oeeNavigationTitle.Width
            - oeeTitle:
                Control: Label@2.5.1
                Properties:
                  Color: =gblTheme.Text_Light
                  FillPortions: =1
                  LayoutMinHeight: =10
                  LayoutMinWidth: =10
                  Size: =Self.Height / 3
                  Text: =APP_NAME
            - oeeMode:
                Control: Classic/Icon@2.5.0
                Properties:
                  Color: =gblTheme.Text_On_Dark
                  Height: =10
                  HoverColor: =gblTheme.Text_On_Light
                  Icon: =Icon.HalfFilledCircle
                  LayoutMinHeight: =10
                  OnSelect: =If(gblTheme.Style = "Light", Set(gblTheme, gblStyles.Dark),Set(gblTheme, gblStyles.Light))
                  PaddingBottom: =4
                  PaddingLeft: =4
                  PaddingRight: =4
                  PaddingTop: =4
                  Rotation: =If(gblTheme.Style = "Light", 0, 180)
                  Width: =Self.Height
            - oeeBugs:
                Control: Image@2.2.3
                Properties:
                  HoverFill: =gblTheme.Pri_Complement
                  Image: =gblIcons.Bug
                  ImagePosition: =ImagePosition.Fill
                  LayoutMinHeight: =10
                  OnSelect: =Navigate(Bugs,ScreenTransition.Fade)
                  PaddingLeft: =
                  RadiusBottomLeft: =Self.Width
                  RadiusBottomRight: =Self.RadiusBottomLeft
                  RadiusTopLeft: =Self.RadiusBottomLeft
                  RadiusTopRight: =Self.RadiusBottomLeft
                  Width: =Self.Height
            - oeeUserImg:
                Control: Image@2.2.3
                Properties:
                  Fill: =RGBA(0, 0, 0, 1)
                  Image: =User().Image
                  ImagePosition: =ImagePosition.Fill
                  LayoutMinHeight: =10
                  PaddingLeft: =
                  RadiusBottomLeft: =Self.Width
                  RadiusBottomRight: =Self.RadiusBottomLeft
                  RadiusTopLeft: =Self.RadiusBottomLeft
                  RadiusTopRight: =Self.RadiusBottomLeft
                  Width: =Self.Height
      - oeeMain:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.None
            FillPortions: =11
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Horizontal
            LayoutMinHeight: =10
            LayoutMinWidth: =10
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
          Children:
            - oeeNavigation:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  AlignInContainer: =AlignInContainer.SetByContainer
                  DropShadow: =DropShadow.None
                  Fill: =gblTheme.Midground
                  FillPortions: =If(App.Width < Index(App.SizeBreakpoints,3).Value, 4,3)
                  LayoutAlignItems: =LayoutAlignItems.Stretch
                  LayoutDirection: =LayoutDirection.Vertical
                  LayoutGap: =gblPadding
                  LayoutMinHeight: =10
                  LayoutMinWidth: =10
                  PaddingBottom: =gblPadding
                  PaddingLeft: =gblPadding
                  PaddingRight: =gblPadding
                  PaddingTop: =gblPadding
                  RadiusBottomLeft: =0
                  RadiusBottomRight: =0
                  RadiusTopLeft: =0
                  RadiusTopRight: =0
                Children:
                  - oeeNavigationTitle:
                      Control: Label@2.5.1
                      Properties:
                        Align: =Align.Center
                        Color: =gblTheme.Text_On_Light
                        LayoutMinWidth: =10
                        Size: =Self.Height / 3
                        Text: =App.ActiveScreen.Name
                  - oeeNavigationSeparator:
                      Control: Rectangle@2.3.0
                      Properties:
                        Fill: =gblTheme.Pri_Complement
                        Height: =Round(gblPadding/2,0)
                        LayoutMinWidth: =10
                        Width: =10
                  - oeeNavigationGallery:
                      Control: Gallery@2.15.0
                      Variant: Vertical
                      Properties:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        Items: =colNavigation
                        LayoutMinHeight: =10
                        LayoutMinWidth: =10
                        TemplatePadding: =gblPadding
                        TemplateSize: =40
                      Children:
                        - oeeNavigationGalleryButton:
                            Control: Classic/Button@2.2.0
                            Properties:
                              BorderThickness: =1
                              Color: =gblTheme.Text_Dark
                              DisplayMode: =If(App.ActiveScreen.Name = ThisItem.Screen.Name, DisplayMode.Disabled, DisplayMode.Edit)
                              Fill: =gblTheme.Accent
                              FontWeight: =FontWeight.Normal
                              Height: =Parent.TemplateHeight
                              OnSelect: =Navigate(ThisItem.Screen,ScreenTransition.Fade)
                              RadiusBottomLeft: =100
                              RadiusBottomRight: =100
                              RadiusTopLeft: =100
                              RadiusTopRight: =100
                              Size: =Self.Height / 4
                              Text: =ThisItem.Label
                              Width: =Parent.TemplateWidth
                  - oeeNavigationFooter:
                      Control: Label@2.5.1
                      Properties:
                        Align: =Align.Center
                        Color: =gblTheme.Text_On_Light
                        Height: =Parent.Height * 0.1
                        LayoutMinWidth: =10
                        Size: =Self.Height / 14
                        Text: |-
                          =
                          "MilliporeSigma is the U.S. and Canada Life Science business of Merck KGaA, Darmstadt, Germany."
                          &Char(13)&Char(13)&
                          "© 2025 EMD Millipore. All rights reserved."
                        VerticalAlign: =VerticalAlign.Bottom
            - oeeFilterParent:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  AlignInContainer: =AlignInContainer.SetByContainer
                  DropShadow: =DropShadow.None
                  Fill: =gblTheme.Background
                  FillPortions: =If(App.Width < Index(App.SizeBreakpoints,3).Value, 4,3)
                  LayoutAlignItems: =LayoutAlignItems.Stretch
                  LayoutDirection: =LayoutDirection.Vertical
                  LayoutGap: =gblPadding
                  LayoutMinHeight: =10
                  LayoutMinWidth: =10
                  PaddingBottom: =gblPadding
                  PaddingLeft: =gblPadding
                  PaddingRight: =gblPadding
                  PaddingTop: =gblPadding
                  RadiusBottomLeft: =0
                  RadiusBottomRight: =0
                  RadiusTopLeft: =0
                  RadiusTopRight: =0
                Children:
                  - oeeFilters:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        Fill: =gblTheme.Foreground
                        Height: =Parent.Height * 0.5
                        LayoutAlignItems: =LayoutAlignItems.Stretch
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutGap: =gblPadding
                        LayoutMinHeight: =10
                        LayoutMinWidth: =10
                        PaddingBottom: =gblPadding
                        PaddingLeft: =gblPadding
                        PaddingRight: =gblPadding
                      Children:
                        - oeeFilterTitle:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              AlignInContainer: =AlignInContainer.Center
                              Color: =gblTheme.Text_Light
                              Fill: =gblTheme.Secondary
                              LayoutMinWidth: =10
                              Size: =Self.Height / 4
                              Text: ="Filters"
                              Width: =Parent.Width
                        - oeeStartDateLabel:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              Color: =gblTheme.Text_On_Light
                              LayoutMinWidth: =10
                              Size: =Self.Height / 4
                              Text: ="Start Date"
                        - oeeStartDate:
                            Control: Classic/DatePicker@2.6.0
                            Properties:
                              BorderThickness: =1
                              Color: =gblTheme.Text_On_Light
                              Fill: =gblTheme.Background
                              FocusedBorderThickness: =1
                              IconBackground: =gblTheme.Sec_Complement
                              IconFill: =gblTheme.Text_On_Light
                              LayoutMinWidth: =10
                              Size: =Self.Height / 5
                        - oeeEndDateLabel:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              Color: =gblTheme.Text_On_Light
                              LayoutMinWidth: =10
                              Size: =Self.Height / 4
                              Text: ="End Date"
                        - oeeEndDate:
                            Control: Classic/DatePicker@2.6.0
                            Properties:
                              BorderThickness: =1
                              Color: =gblTheme.Text_On_Light
                              Fill: =gblTheme.Background
                              FocusedBorderThickness: =1
                              IconBackground: =gblTheme.Sec_Complement
                              IconFill: =gblTheme.Text_On_Light
                              LayoutMinWidth: =10
                              Size: =Self.Height / 5
                        - oee_button:
                            Control: Classic/Button@2.2.0
                            Properties:
                              Color: =gblTheme.Text_Dark
                              Fill: =gblTheme.Accent
                              FontWeight: =FontWeight.Normal
                              HoverColor: =RGBA(255, 255, 255, 1)
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              OnSelect: =Select(oeeCollect);
                              Size: =Self.Width / 16
                              Text: ="Update Date Range"
                        - oeeFilterSeparator0:
                            Control: Rectangle@2.3.0
                            Properties:
                              Fill: =gblTheme.Pri_Complement
                              Height: =Round(gblPadding/2,0)
                              LayoutMinWidth: =10
                              Width: =10
                        - oeeLineLabel:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              Color: =gblTheme.Text_On_Light
                              LayoutMinWidth: =10
                              Size: =Self.Height / 4
                              Text: ="Line"
                        - oeeLine:
                            Control: Classic/DropDown@2.3.1
                            Properties:
                              ChevronBackground: =gblTheme.Sec_Complement
                              ChevronFill: =gblTheme.Text_Dark
                              Color: =gblTheme.Text_On_Light
                              Fill: =gblTheme.Background
                              Items: =Table(["All","Only XLs","Only XLTs","Only SSCs"],gblLists.Lines)
                              LayoutMinWidth: =10
                              OnChange: =Select(oeeUpdate);
                              Size: =Self.Height / 5
                        - oeeFilterSeparator1:
                            Control: Rectangle@2.3.0
                            Properties:
                              Fill: =gblTheme.Pri_Complement
                              Height: =Round(gblPadding/2,0)
                              LayoutMinWidth: =10
                              Width: =10
                        - oeeDowntimeLabel:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              Color: =gblTheme.Text_On_Light
                              LayoutMinWidth: =10
                              Size: =Self.Height / 4
                              Text: ="Downtime Filter:"
                        - oeeDowntime:
                            Control: Classic/DropDown@2.3.1
                            Properties:
                              ChevronBackground: =gblTheme.Sec_Complement
                              ChevronFill: =gblTheme.Text_Dark
                              Color: =gblTheme.Text_On_Light
                              Fill: =gblTheme.Background
                              Items: =["All Downtime", "Unplanned Only"]
                              LayoutMinWidth: =10
                              OnChange: =Select(oeeCollect);
                              Size: =Self.Height / 5
                        - oeeFilterSeparator2:
                            Control: Rectangle@2.3.0
                            Properties:
                              Fill: =gblTheme.Pri_Complement
                              Height: =Round(gblPadding/2,0)
                              LayoutMinWidth: =10
                              Width: =10
            - oeeBody:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  AlignInContainer: =AlignInContainer.SetByContainer
                  DropShadow: =DropShadow.None
                  FillPortions: =If(App.Width < Index(App.SizeBreakpoints,3).Value, 16,18)
                  LayoutAlignItems: =LayoutAlignItems.Center
                  LayoutDirection: =LayoutDirection.Vertical
                  LayoutGap: =gblPadding
                  LayoutMinHeight: =10
                  LayoutMinWidth: =10
                  LayoutOverflowY: =LayoutOverflow.Scroll
                  PaddingBottom: =gblPadding * 5
                  PaddingLeft: =gblPadding
                  PaddingRight: =gblPadding
                  PaddingTop: =gblPadding
                  RadiusBottomLeft: =0
                  RadiusBottomRight: =0
                  RadiusTopLeft: =0
                  RadiusTopRight: =0
                Children:
                  - oeeTPSParent:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =Parent.Height * 0.28
                        LayoutAlignItems: =LayoutAlignItems.Stretch
                        LayoutDirection: =LayoutDirection.Horizontal
                        LayoutGap: =gblPadding * 2
                        LayoutJustifyContent: =LayoutJustifyContent.Center
                        PaddingBottom: =gblPadding
                        PaddingLeft: =gblPadding
                        PaddingRight: =gblPadding
                        PaddingTop: =gblPadding
                        Width: =Parent.Width * 0.65
                      Children:
                        - oeeAvailability:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              AlignInContainer: =AlignInContainer.SetByContainer
                              BorderColor: =gblTheme.Sec_Complement
                              BorderThickness: =If(gblTheme.Style = "Light", 0, 1)
                              DropShadow: =DropShadow.Regular
                              Fill: =gblTheme.Foreground
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                            Children:
                              - oeeAvailabilityTitle:
                                  Control: Label@2.5.1
                                  Properties:
                                    Align: =Align.Center
                                    Color: =gblTheme.Text_Light
                                    Fill: =gblTheme.Secondary
                                    LayoutMinWidth: =10
                                    Size: =Self.Height / 3
                                    Text: ="Availability"
                              - oeeAvailabilityChart:
                                  Control: Image@2.2.3
                                  Properties:
                                    FillPortions: =1
                                    Image: |-
                                      ="https://quickchart.io/chart?width=" &Self.Width& "&height=" &Self.Height*0.90& "&c=" &
                                      With({thisData: Round(recAvailability*100,2)},
                                          EncodeUrl(
                                              "{
                                                  type: 'radialGauge',
                                                  data: {
                                                      datasets: [{
                                                          data: ["& thisData &"],
                                                          backgroundColor: getGradientFillHelper('horizontal', [
                                                              '"& gblTheme.Chart_Blue &"',
                                                              '"& gblTheme.Chart_Blue &"',
                                                              '"& gblTheme.Chart_Blue &"',
                                                              '"& gblTheme.Chart_Red &"',
                                                              '"& gblTheme.Chart_Red &"',
                                                              '"& gblTheme.Chart_Red &"'
                                                          ]),
                                                      }]
                                                  },
                                                  options: {
                                                      domain: [0, "& If(thisData <= 100, 100, thisData) &"],
                                                      trackColor: '"& gblTheme.Chart_White &"', 
                                                      centerPercentage: 90,
                                                      centerArea: {
                                                          text: (val) => val + '%',
                                                          fontColor: '"& gblTheme.Chart_Black &"'
                                                      },
                                                  }
                                              }"
                                          )
                                      )
                                    LayoutMinHeight: =10
                                    LayoutMinWidth: =10
                        - oeePerformance:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              AlignInContainer: =AlignInContainer.SetByContainer
                              BorderColor: =gblTheme.Sec_Complement
                              BorderThickness: =If(gblTheme.Style = "Light", 0, 1)
                              DropShadow: =DropShadow.Regular
                              Fill: =gblTheme.Foreground
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                            Children:
                              - oeePerformanceTitle:
                                  Control: Label@2.5.1
                                  Properties:
                                    Align: =Align.Center
                                    Color: =gblTheme.Text_Light
                                    Fill: =gblTheme.Secondary
                                    Size: =Self.Height / 3
                                    Text: ="Performance"
                              - oeePerformanceChart:
                                  Control: Image@2.2.3
                                  Properties:
                                    FillPortions: =1
                                    Image: |-
                                      ="https://quickchart.io/chart?width=" &Self.Width& "&height=" &Self.Height*0.90& "&c=" &
                                      With({thisData: Round(recPerformance*100,2)},
                                          EncodeUrl(
                                              "{
                                                  type: 'radialGauge',
                                                  data: {
                                                      datasets: [{
                                                          data: ["& thisData &"],
                                                          backgroundColor: getGradientFillHelper('horizontal', [
                                                              '"& gblTheme.Chart_Blue &"',
                                                              '"& gblTheme.Chart_Blue &"',
                                                              '"& gblTheme.Chart_Blue &"',
                                                              '"& gblTheme.Chart_Red &"',
                                                              '"& gblTheme.Chart_Red &"',
                                                              '"& gblTheme.Chart_Red &"'
                                                          ]),
                                                      }]
                                                  },
                                                  options: {
                                                      domain: [0, "& If(thisData <= 100, 100, thisData) &"],
                                                      trackColor: '"& gblTheme.Chart_White &"', 
                                                      centerPercentage: 90,
                                                      centerArea: {
                                                          text: (val) => val + '%',
                                                          fontColor: '"& gblTheme.Chart_Black &"'
                                                      },
                                                  }
                                              }"
                                          )
                                      )
                                    LayoutMinHeight: =10
                                    LayoutMinWidth: =10
                        - oeeQuality:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              AlignInContainer: =AlignInContainer.SetByContainer
                              BorderColor: =gblTheme.Sec_Complement
                              BorderThickness: =If(gblTheme.Style = "Light", 0, 1)
                              DropShadow: =DropShadow.Regular
                              Fill: =gblTheme.Foreground
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                            Children:
                              - oeeQualityTitle:
                                  Control: Label@2.5.1
                                  Properties:
                                    Align: =Align.Center
                                    Color: =gblTheme.Text_Light
                                    Fill: =gblTheme.Secondary
                                    Size: =Self.Height / 3
                                    Text: ="Quality"
                              - oeeQualityChart:
                                  Control: Image@2.2.3
                                  Properties:
                                    FillPortions: =1
                                    Image: |-
                                      ="https://quickchart.io/chart?width=" &Self.Width& "&height=" &Self.Height*0.90& "&c=" &
                                      With({thisData: Round(recQuality*100,2)},
                                          EncodeUrl(
                                              "{
                                                  type: 'radialGauge',
                                                  data: {
                                                      datasets: [{
                                                          data: ["& thisData &"],
                                                          backgroundColor: getGradientFillHelper('horizontal', [
                                                              '"& gblTheme.Chart_Blue &"',
                                                              '"& gblTheme.Chart_Blue &"',
                                                              '"& gblTheme.Chart_Blue &"',
                                                              '"& gblTheme.Chart_Red &"',
                                                              '"& gblTheme.Chart_Red &"',
                                                              '"& gblTheme.Chart_Red &"'
                                                          ]),
                                                      }]
                                                  },
                                                  options: {
                                                      domain: [0, "& If(thisData <= 100, 100, thisData) &"],
                                                      trackColor: '"& gblTheme.Chart_White &"', 
                                                      centerPercentage: 90,
                                                      centerArea: {
                                                          text: (val) => val + '%',
                                                          fontColor: '"& gblTheme.Chart_Black &"'
                                                      },
                                                  }
                                              }"
                                          )
                                      )
                                    LayoutMinHeight: =10
                                    LayoutMinWidth: =10
                        - oeeTPSOEE:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              AlignInContainer: =AlignInContainer.SetByContainer
                              BorderColor: =gblTheme.Sec_Complement
                              BorderThickness: =If(gblTheme.Style = "Light", 0, 1)
                              DropShadow: =DropShadow.Regular
                              Fill: =gblTheme.Foreground
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                            Children:
                              - oeeOEETitle:
                                  Control: Label@2.5.1
                                  Properties:
                                    Align: =Align.Center
                                    Color: =gblTheme.Text_Light
                                    Fill: =gblTheme.Secondary
                                    Size: =Self.Height / 3
                                    Text: ="TPS OEE"
                              - oeeOEEChart:
                                  Control: Image@2.2.3
                                  Properties:
                                    FillPortions: =1
                                    Image: |-
                                      ="https://quickchart.io/chart?width=" &Self.Width& "&height=" &Self.Height*0.90& "&c=" &
                                      With({thisData: Round(recOEE*100,2)},
                                          EncodeUrl(
                                              "{
                                                  type: 'radialGauge',
                                                  data: {
                                                      datasets: [{
                                                          data: ["& thisData &"],
                                                          backgroundColor: getGradientFillHelper('horizontal', [
                                                              '"& gblTheme.Chart_Blue &"',
                                                              '"& gblTheme.Chart_Blue &"',
                                                              '"& gblTheme.Chart_Blue &"',
                                                              '"& gblTheme.Chart_Red &"',
                                                              '"& gblTheme.Chart_Red &"',
                                                              '"& gblTheme.Chart_Red &"'
                                                          ]),
                                                      }]
                                                  },
                                                  options: {
                                                      domain: [0, "& If(thisData <= 100, 100, thisData) &"],
                                                      trackColor: '"& gblTheme.Chart_White &"', 
                                                      centerPercentage: 90,
                                                      centerArea: {
                                                          text: (val) => val + '%',
                                                          fontColor: '"& gblTheme.Chart_Black &"'
                                                      },
                                                  }
                                              }"
                                          )
                                      )
                                    LayoutMinHeight: =10
                                    LayoutMinWidth: =10
                  - oeeOEE2Parent:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        BorderColor: =gblTheme.Sec_Complement
                        BorderThickness: =If(gblTheme.Style = "Light", 0,1)
                        DropShadow: =DropShadow.Regular
                        Fill: =gblTheme.Foreground
                        FillPortions: =0
                        Height: =Self.Width
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinWidth: =
                        Width: =Parent.Width * 0.35
                      Children:
                        - oeeOEE2Title:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              AlignInContainer: =AlignInContainer.Center
                              Color: =gblTheme.Text_Light
                              Fill: =gblTheme.Secondary
                              Size: =Round(Self.Height/3,0)
                              Text: ="OEE2"
                              Width: =Parent.Width
                        - oeeOEE2Layout:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutDirection: =LayoutDirection.Horizontal
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                            Children:
                              - oeeOEE2Graph:
                                  Control: Image@2.2.3
                                  Properties:
                                    FillPortions: =3
                                    Height: =Self.Width
                                    Image: |-
                                      ="https://quickchart.io/chart?width=" &Self.Width& "&height=" &Self.Height*0.90& "&c=" &
                                      With({thisData: First(recOEE2).OEE2},
                                          EncodeUrl(
                                              "{
                                                  type: 'radialGauge',
                                                  data: {
                                                      datasets: [{
                                                          data: ["& thisData &"],
                                                          backgroundColor: getGradientFillHelper('horizontal', [
                                                              '"& gblTheme.Chart_Blue &"',
                                                              '"& gblTheme.Chart_Blue &"',
                                                              '"& gblTheme.Chart_Blue &"',
                                                              '"& gblTheme.Chart_Red &"',
                                                              '"& gblTheme.Chart_Red &"',
                                                              '"& gblTheme.Chart_Red &"'
                                                          ]),
                                                      }]
                                                  },
                                                  options: {
                                                      domain: [0, "& If(thisData <= 100, 100, thisData) &"],
                                                      trackColor: '"& gblTheme.Chart_White &"', 
                                                      centerPercentage: 90,
                                                      centerArea: {
                                                          text: (val) => val + '%',
                                                          fontColor: '"& gblTheme.Chart_Black &"'
                                                      },
                                                  }
                                              }"
                                          )
                                      )
                                    PaddingBottom: =gblPadding
                                    PaddingLeft: =gblPadding
                                    PaddingRight: =gblPadding
                                    PaddingTop: =gblPadding
                              - oeeOEE2Table:
                                  Control: GroupContainer@1.3.0
                                  Variant: AutoLayout
                                  Properties:
                                    AlignInContainer: =AlignInContainer.SetByContainer
                                    DropShadow: =DropShadow.None
                                    FillPortions: =5
                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                    LayoutDirection: =LayoutDirection.Horizontal
                                    LayoutMinHeight: =10
                                    LayoutMinWidth: =10
                                    RadiusBottomLeft: =0
                                    RadiusBottomRight: =0
                                    RadiusTopLeft: =0
                                    RadiusTopRight: =0
                                  Children:
                                    - oeeOEE2Keys:
                                        Control: GroupContainer@1.3.0
                                        Variant: AutoLayout
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutGap: =gblPadding
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                          - oeeOEE2KeyOEE2:
                                              Control: Label@2.5.1
                                              Properties:
                                                Align: =Align.Right
                                                Color: =gblTheme.Text_On_Light
                                                Fill: =gblTheme.Midground
                                                FillPortions: =1
                                                LayoutMinHeight: =10
                                                LayoutMinWidth: =10
                                                Size: =Round(Self.Height/4,0)
                                                Text: ="OEE2"
                                          - oeeOEE2KeyAmount:
                                              Control: Label@2.5.1
                                              Properties:
                                                Align: =Align.Right
                                                Color: =gblTheme.Text_On_Light
                                                Fill: =gblTheme.Sec_Complement
                                                FillPortions: =1
                                                LayoutMinHeight: =10
                                                LayoutMinWidth: =10
                                                Size: =Round(Self.Height/4,0)
                                                Text: ="Amount Built"
                                          - oeeOEE2KeyAmountGood:
                                              Control: Label@2.5.1
                                              Properties:
                                                Align: =Align.Right
                                                Color: =gblTheme.Text_On_Light
                                                Fill: =gblTheme.Sec_Complement
                                                FillPortions: =1
                                                LayoutMinHeight: =10
                                                LayoutMinWidth: =10
                                                Size: =Round(Self.Height/4,0)
                                                Text: ="Good Units"
                                          - oeeOEE2KeyAmountRejected:
                                              Control: Label@2.5.1
                                              Properties:
                                                Align: =Align.Right
                                                Color: =gblTheme.Text_On_Light
                                                Fill: =gblTheme.Sec_Complement
                                                FillPortions: =1
                                                LayoutMinHeight: =10
                                                LayoutMinWidth: =10
                                                Size: =Round(Self.Height/4,0)
                                                Text: ="Rejected Units"
                                          - oeeOEE2KeyTarget:
                                              Control: Label@2.5.1
                                              Properties:
                                                Align: =Align.Right
                                                Color: =gblTheme.Text_On_Light
                                                Fill: =gblTheme.Sec_Complement
                                                FillPortions: =1
                                                LayoutMinHeight: =10
                                                LayoutMinWidth: =10
                                                Size: =Round(Self.Height/4,0)
                                                Text: ="Output Constraint"
                                          - oeeOEE2KeyDowntime:
                                              Control: Label@2.5.1
                                              Properties:
                                                Align: =Align.Right
                                                Color: =gblTheme.Text_On_Light
                                                Fill: =gblTheme.Pri_Complement
                                                FillPortions: =1
                                                LayoutMinHeight: =10
                                                LayoutMinWidth: =10
                                                Size: =Round(Self.Height/4,0)
                                                Text: ="Total Downtime"
                                          - oeeOEE2KeyDowntimePlanned:
                                              Control: Label@2.5.1
                                              Properties:
                                                Align: =Align.Right
                                                Color: =gblTheme.Text_On_Light
                                                Fill: =gblTheme.Pri_Complement
                                                FillPortions: =1
                                                LayoutMinHeight: =10
                                                LayoutMinWidth: =10
                                                Size: =Round(Self.Height/4,0)
                                                Text: ="Planned Downtime"
                                          - oeeOEE2KeyDowntimeUnplanned:
                                              Control: Label@2.5.1
                                              Properties:
                                                Align: =Align.Right
                                                Color: =gblTheme.Text_On_Light
                                                Fill: =gblTheme.Pri_Complement
                                                FillPortions: =1
                                                LayoutMinHeight: =10
                                                LayoutMinWidth: =10
                                                Size: =Round(Self.Height/4,0)
                                                Text: ="Unplanned Downtime"
                                          - oeeOEE2KeyRuntime:
                                              Control: Label@2.5.1
                                              Properties:
                                                Align: =Align.Right
                                                Color: =gblTheme.Text_On_Light
                                                Fill: =gblTheme.Pri_Complement
                                                FillPortions: =1
                                                LayoutMinHeight: =10
                                                LayoutMinWidth: =10
                                                Size: =Round(Self.Height/4,0)
                                                Text: ="Total Runtime"
                                          - oeeOEE2KeyTime:
                                              Control: Label@2.5.1
                                              Properties:
                                                Align: =Align.Right
                                                Color: =gblTheme.Text_On_Light
                                                Fill: =gblTheme.Pri_Complement
                                                FillPortions: =1
                                                LayoutMinHeight: =10
                                                LayoutMinWidth: =10
                                                Size: =Round(Self.Height/4,0)
                                                Text: ="Possible Runtime"
                                                Width: =10
                                    - oeeOEE2Values:
                                        Control: GroupContainer@1.3.0
                                        Variant: AutoLayout
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutGap: =gblPadding
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                          - oeeOEE2ValueOEE2:
                                              Control: Label@2.5.1
                                              Properties:
                                                Align: =Align.Center
                                                Color: =gblTheme.Text_On_Light
                                                Fill: =gblTheme.Background
                                                FillPortions: =1
                                                LayoutMinHeight: =10
                                                LayoutMinWidth: =10
                                                Size: =Round(Self.Height/4,0)
                                                Text: =First(recOEE2).OEE2 & "%"
                                          - oeeOEE2ValueAmount:
                                              Control: Label@2.5.1
                                              Properties:
                                                Align: =Align.Center
                                                Color: =gblTheme.Text_On_Light
                                                Fill: =gblTheme.Background
                                                FillPortions: =1
                                                LayoutMinHeight: =10
                                                LayoutMinWidth: =10
                                                Size: =Round(Self.Height/4,0)
                                                Text: =First(recOEE2).Amount_Total & " Units"
                                          - oeeOEE2ValueAmountGood:
                                              Control: Label@2.5.1
                                              Properties:
                                                Align: =Align.Center
                                                Color: =gblTheme.Text_On_Light
                                                Fill: =gblTheme.Background
                                                FillPortions: =1
                                                LayoutMinHeight: =10
                                                LayoutMinWidth: =10
                                                Size: =Round(Self.Height/4,0)
                                                Text: =First(recOEE2).Amount_Good & " Units"
                                          - oeeOEE2ValueAmountRejected:
                                              Control: Label@2.5.1
                                              Properties:
                                                Align: =Align.Center
                                                Color: =gblTheme.Text_On_Light
                                                Fill: =gblTheme.Background
                                                FillPortions: =1
                                                LayoutMinHeight: =10
                                                LayoutMinWidth: =10
                                                Size: =Round(Self.Height/4,0)
                                                Text: =First(recOEE2).Amount_Rejected & " Units"
                                          - oeeOEE2ValueTarget:
                                              Control: Label@2.5.1
                                              Properties:
                                                Align: =Align.Center
                                                Color: =gblTheme.Text_On_Light
                                                Fill: =gblTheme.Background
                                                FillPortions: =1
                                                LayoutMinHeight: =10
                                                LayoutMinWidth: =10
                                                Size: =Round(Self.Height/4,0)
                                                Text: =RoundUp(First(recOEE2).Constraint_Goal,0) & " Units"
                                          - oeeOEE2ValueDowntime:
                                              Control: Label@2.5.1
                                              Properties:
                                                Align: =Align.Center
                                                Color: =gblTheme.Text_On_Light
                                                Fill: =gblTheme.Background
                                                FillPortions: =1
                                                LayoutMinHeight: =10
                                                LayoutMinWidth: =10
                                                Size: =Round(Self.Height/4,0)
                                                Text: =RoundDown(First(recOEE2).Downtime_Total/60,0) & "H " & Mod(First(recOEE2).Downtime_Total,60) & "m"
                                          - oeeOEE2ValueDowntimePlanned:
                                              Control: Label@2.5.1
                                              Properties:
                                                Align: =Align.Center
                                                Color: =gblTheme.Text_On_Light
                                                Fill: =gblTheme.Background
                                                FillPortions: =1
                                                LayoutMinHeight: =10
                                                LayoutMinWidth: =10
                                                Size: =Round(Self.Height/4,0)
                                                Text: =RoundDown(First(recOEE2).Downtime_Planned/60,0) & "H " & Mod(First(recOEE2).Downtime_Planned,60) & "m"
                                          - oeeOEE2ValueDowntimeUnplanned:
                                              Control: Label@2.5.1
                                              Properties:
                                                Align: =Align.Center
                                                Color: =gblTheme.Text_On_Light
                                                Fill: =gblTheme.Background
                                                FillPortions: =1
                                                LayoutMinHeight: =10
                                                LayoutMinWidth: =10
                                                Size: =Round(Self.Height/4,0)
                                                Text: =RoundDown(First(recOEE2).Downtime_Unplanned/60,0) & "H " & Mod(First(recOEE2).Downtime_Unplanned,60) & "m"
                                          - oeeOEE2ValueRuntime:
                                              Control: Label@2.5.1
                                              Properties:
                                                Align: =Align.Center
                                                Color: =gblTheme.Text_On_Light
                                                Fill: =gblTheme.Background
                                                FillPortions: =1
                                                LayoutMinHeight: =10
                                                LayoutMinWidth: =10
                                                Size: =Round(Self.Height/4,0)
                                                Text: =RoundDown(First(recOEE2).Runtime/60,0) & "H " & Mod(First(recOEE2).Runtime,60) & "m"
                                          - oeeOEE2ValueTime:
                                              Control: Label@2.5.1
                                              Properties:
                                                Align: =Align.Center
                                                Color: =gblTheme.Text_On_Light
                                                Fill: =gblTheme.Background
                                                FillPortions: =1
                                                LayoutMinHeight: =10
                                                LayoutMinWidth: =10
                                                Size: =Round(Self.Height/4,0)
                                                Text: =RoundDown(First(recOEE2).Runtime_Total/60,0) & " Hours"
                                                Width: =10
                  - oeeShiftParent:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        BorderColor: =gblTheme.Sec_Complement
                        BorderThickness: =If(gblTheme.Style = "Light", 0,1)
                        DropShadow: =DropShadow.Regular
                        FillPortions: =0
                        Height: =1000
                        LayoutDirection: =LayoutDirection.Vertical
                        Width: =Parent.Width * 0.5
                      Children:
                        - oeeShiftTitle:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              AlignInContainer: =AlignInContainer.Center
                              Color: =gblTheme.Text_Light
                              Fill: =gblTheme.Secondary
                              Size: =Round(Self.Height/3,0)
                              Text: ="OEE2 per Shift"
                              Width: =Parent.Width
                        - oeeShiftGallery:
                            Control: Gallery@2.15.0
                            Variant: Vertical
                            Properties:
                              Items: =colShiftOEE
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              TemplatePadding: =0
                              TemplateSize: =Round(Self.Height/3,0)-1
                            Children:
                              - oeeShiftLayout:
                                  Control: GroupContainer@1.3.0
                                  Variant: AutoLayout
                                  Properties:
                                    BorderColor: =gblTheme.Pri_Complement
                                    DropShadow: =DropShadow.None
                                    Fill: =gblTheme.Foreground
                                    Height: =Parent.TemplateHeight - oeeShiftGallerySeparator.Height
                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                    LayoutDirection: =LayoutDirection.Horizontal
                                    RadiusBottomLeft: =0
                                    RadiusBottomRight: =0
                                    RadiusTopLeft: =0
                                    RadiusTopRight: =0
                                    Width: =Parent.TemplateWidth
                                  Children:
                                    - oeeShiftShift:
                                        Control: Label@2.5.1
                                        Properties:
                                          Align: =Align.Center
                                          Color: =gblTheme.Text_On_Light
                                          Fill: =gblTheme.Sec_Complement
                                          FillPortions: =1
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          Size: =Round(Self.Height/10,0)
                                          Text: =ThisItem.Shift
                                    - oeeShiftGraph:
                                        Control: Image@2.2.3
                                        Properties:
                                          Fill: =RGBA(0,0,0,0)
                                          FillPortions: =3
                                          Height: =Self.Width
                                          Image: |-
                                            ="https://quickchart.io/chart?width=" &Self.Width& "&height=" &Self.Height*0.90& "&c=" &
                                            With({thisData: ThisItem.OEE2},
                                                EncodeUrl(
                                                    "{
                                                        type: 'radialGauge',
                                                        data: {
                                                            datasets: [{
                                                                data: ["& thisData &"],
                                                                backgroundColor: getGradientFillHelper('horizontal', [
                                                                    '"& gblTheme.Chart_Blue &"',
                                                                    '"& gblTheme.Chart_Blue &"',
                                                                    '"& gblTheme.Chart_Blue &"',
                                                                    '"& gblTheme.Chart_Red &"',
                                                                    '"& gblTheme.Chart_Red &"',
                                                                    '"& gblTheme.Chart_Red &"'
                                                                ]),
                                                            }]
                                                        },
                                                        options: {
                                                            domain: [0, "& If(thisData <= 100, 100, thisData) &"],
                                                            trackColor: '"& gblTheme.Chart_White &"', 
                                                            centerPercentage: 90,
                                                            centerArea: {
                                                                text: (val) => val + '%',
                                                                fontColor: '"& gblTheme.Chart_Black &"'
                                                            },
                                                        }
                                                    }"
                                                )
                                            )
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          PaddingBottom: =gblPadding
                                          PaddingLeft: =gblPadding
                                          PaddingRight: =gblPadding
                                          PaddingTop: =gblPadding
                                    - oeeShiftTable:
                                        Control: GroupContainer@1.3.0
                                        Variant: AutoLayout
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          FillPortions: =4
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Horizontal
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                          - oeeShiftKeys:
                                              Control: GroupContainer@1.3.0
                                              Variant: AutoLayout
                                              Properties:
                                                AlignInContainer: =AlignInContainer.SetByContainer
                                                DropShadow: =DropShadow.None
                                                LayoutAlignItems: =LayoutAlignItems.Stretch
                                                LayoutDirection: =LayoutDirection.Vertical
                                                LayoutGap: =gblPadding/2
                                                LayoutMinHeight: =10
                                                LayoutMinWidth: =10
                                                RadiusBottomLeft: =0
                                                RadiusBottomRight: =0
                                                RadiusTopLeft: =0
                                                RadiusTopRight: =0
                                              Children:
                                                - oeeShiftKeyOEE2:
                                                    Control: Label@2.5.1
                                                    Properties:
                                                      Align: =Align.Right
                                                      Color: =gblTheme.Text_On_Light
                                                      Fill: =gblTheme.Midground
                                                      FillPortions: =1
                                                      LayoutMinHeight: =10
                                                      LayoutMinWidth: =10
                                                      Size: =Round(Self.Height/4,0)
                                                      Text: ="OEE2"
                                                - oeeShiftKeyAmount:
                                                    Control: Label@2.5.1
                                                    Properties:
                                                      Align: =Align.Right
                                                      Color: =gblTheme.Text_On_Light
                                                      Fill: =gblTheme.Sec_Complement
                                                      FillPortions: =1
                                                      LayoutMinHeight: =10
                                                      LayoutMinWidth: =10
                                                      Size: =Round(Self.Height/4,0)
                                                      Text: ="Amount Built"
                                                - oeeShiftKeyAmountGood:
                                                    Control: Label@2.5.1
                                                    Properties:
                                                      Align: =Align.Right
                                                      Color: =gblTheme.Text_On_Light
                                                      Fill: =gblTheme.Sec_Complement
                                                      FillPortions: =1
                                                      LayoutMinHeight: =10
                                                      LayoutMinWidth: =10
                                                      Size: =Round(Self.Height/4,0)
                                                      Text: ="Good Units"
                                                - oeeShiftKeyAmountRejected:
                                                    Control: Label@2.5.1
                                                    Properties:
                                                      Align: =Align.Right
                                                      Color: =gblTheme.Text_On_Light
                                                      Fill: =gblTheme.Sec_Complement
                                                      FillPortions: =1
                                                      LayoutMinHeight: =10
                                                      LayoutMinWidth: =10
                                                      Size: =Round(Self.Height/4,0)
                                                      Text: ="Rejected Units"
                                                - oeeShiftKeyTarget:
                                                    Control: Label@2.5.1
                                                    Properties:
                                                      Align: =Align.Right
                                                      Color: =gblTheme.Text_On_Light
                                                      Fill: =gblTheme.Sec_Complement
                                                      FillPortions: =1
                                                      LayoutMinHeight: =10
                                                      LayoutMinWidth: =10
                                                      Size: =Round(Self.Height/4,0)
                                                      Text: ="Output Constraint"
                                                - oeeShiftKeyDowntime:
                                                    Control: Label@2.5.1
                                                    Properties:
                                                      Align: =Align.Right
                                                      Color: =gblTheme.Text_On_Light
                                                      Fill: =gblTheme.Pri_Complement
                                                      FillPortions: =1
                                                      LayoutMinHeight: =10
                                                      LayoutMinWidth: =10
                                                      Size: =Round(Self.Height/4,0)
                                                      Text: ="Total Downtime"
                                                - oeeShiftKeyDowntimePlanned:
                                                    Control: Label@2.5.1
                                                    Properties:
                                                      Align: =Align.Right
                                                      Color: =gblTheme.Text_On_Light
                                                      Fill: =gblTheme.Pri_Complement
                                                      FillPortions: =1
                                                      LayoutMinHeight: =10
                                                      LayoutMinWidth: =10
                                                      Size: =Round(Self.Height/4,0)
                                                      Text: ="Planned Downtime"
                                                - oeeShiftKeyDowntimeUnplanned:
                                                    Control: Label@2.5.1
                                                    Properties:
                                                      Align: =Align.Right
                                                      Color: =gblTheme.Text_On_Light
                                                      Fill: =gblTheme.Pri_Complement
                                                      FillPortions: =1
                                                      LayoutMinHeight: =10
                                                      LayoutMinWidth: =10
                                                      Size: =Round(Self.Height/4,0)
                                                      Text: ="Unplanned Downtime"
                                                - oeeShiftKeyRuntime:
                                                    Control: Label@2.5.1
                                                    Properties:
                                                      Align: =Align.Right
                                                      Color: =gblTheme.Text_On_Light
                                                      Fill: =gblTheme.Pri_Complement
                                                      FillPortions: =1
                                                      LayoutMinHeight: =10
                                                      LayoutMinWidth: =10
                                                      Size: =Round(Self.Height/4,0)
                                                      Text: ="Total Runtime"
                                          - oeeShiftValues:
                                              Control: GroupContainer@1.3.0
                                              Variant: AutoLayout
                                              Properties:
                                                AlignInContainer: =AlignInContainer.SetByContainer
                                                DropShadow: =DropShadow.None
                                                LayoutAlignItems: =LayoutAlignItems.Stretch
                                                LayoutDirection: =LayoutDirection.Vertical
                                                LayoutGap: =gblPadding/2
                                                LayoutMinHeight: =10
                                                LayoutMinWidth: =10
                                                RadiusBottomLeft: =0
                                                RadiusBottomRight: =0
                                                RadiusTopLeft: =0
                                                RadiusTopRight: =0
                                              Children:
                                                - oeeShiftValueOEE2:
                                                    Control: Label@2.5.1
                                                    Properties:
                                                      Align: =Align.Center
                                                      Color: =gblTheme.Text_On_Light
                                                      Fill: =gblTheme.Background
                                                      FillPortions: =1
                                                      LayoutMinHeight: =10
                                                      LayoutMinWidth: =10
                                                      Size: =Round(Self.Height/4,0)
                                                      Text: =ThisItem.OEE2 & "%"
                                                - oeeShiftValueAmount:
                                                    Control: Label@2.5.1
                                                    Properties:
                                                      Align: =Align.Center
                                                      Color: =gblTheme.Text_On_Light
                                                      Fill: =gblTheme.Background
                                                      FillPortions: =1
                                                      LayoutMinHeight: =10
                                                      LayoutMinWidth: =10
                                                      Size: =Round(Self.Height/4,0)
                                                      Text: =ThisItem.Amount_Total & " Units"
                                                - oeeShiftValueAmountGood:
                                                    Control: Label@2.5.1
                                                    Properties:
                                                      Align: =Align.Center
                                                      Color: =gblTheme.Text_On_Light
                                                      Fill: =gblTheme.Background
                                                      FillPortions: =1
                                                      LayoutMinHeight: =10
                                                      LayoutMinWidth: =10
                                                      Size: =Round(Self.Height/4,0)
                                                      Text: =ThisItem.Amount_Good & " Units"
                                                - oeeShiftValueAmountRejected:
                                                    Control: Label@2.5.1
                                                    Properties:
                                                      Align: =Align.Center
                                                      Color: =gblTheme.Text_On_Light
                                                      Fill: =gblTheme.Background
                                                      FillPortions: =1
                                                      LayoutMinHeight: =10
                                                      LayoutMinWidth: =10
                                                      Size: =Round(Self.Height/4,0)
                                                      Text: =ThisItem.Amount_Rejected & " Units"
                                                - oeeShiftValueTarget:
                                                    Control: Label@2.5.1
                                                    Properties:
                                                      Align: =Align.Center
                                                      Color: =gblTheme.Text_On_Light
                                                      Fill: =gblTheme.Background
                                                      FillPortions: =1
                                                      LayoutMinHeight: =10
                                                      LayoutMinWidth: =10
                                                      Size: =Round(Self.Height/4,0)
                                                      Text: =RoundUp(ThisItem.Constraint_Goal,0) & " Units"
                                                - oeeShiftValueDowntime:
                                                    Control: Label@2.5.1
                                                    Properties:
                                                      Align: =Align.Center
                                                      Color: =gblTheme.Text_On_Light
                                                      Fill: =gblTheme.Background
                                                      FillPortions: =1
                                                      LayoutMinHeight: =10
                                                      LayoutMinWidth: =10
                                                      Size: =Round(Self.Height/4,0)
                                                      Text: =RoundDown(ThisItem.Downtime_Total/60,0) & "H " & Mod(ThisItem.Downtime_Total,60) & "m"
                                                - oeeShiftValueDowntimePlanned:
                                                    Control: Label@2.5.1
                                                    Properties:
                                                      Align: =Align.Center
                                                      Color: =gblTheme.Text_On_Light
                                                      Fill: =gblTheme.Background
                                                      FillPortions: =1
                                                      LayoutMinHeight: =10
                                                      LayoutMinWidth: =10
                                                      Size: =Round(Self.Height/4,0)
                                                      Text: =RoundDown(ThisItem.Downtime_Planned/60,0) & "H " & Mod(ThisItem.Downtime_Planned,60) & "m"
                                                - oeeShiftValueDowntimeUnplanned:
                                                    Control: Label@2.5.1
                                                    Properties:
                                                      Align: =Align.Center
                                                      Color: =gblTheme.Text_On_Light
                                                      Fill: =gblTheme.Background
                                                      FillPortions: =1
                                                      LayoutMinHeight: =10
                                                      LayoutMinWidth: =10
                                                      Size: =Round(Self.Height/4,0)
                                                      Text: =RoundDown(ThisItem.Downtime_Unplanned/60,0) & "H " & Mod(ThisItem.Downtime_Unplanned,60) & "m"
                                                - oeeShiftValueRuntime:
                                                    Control: Label@2.5.1
                                                    Properties:
                                                      Align: =Align.Center
                                                      Color: =gblTheme.Text_On_Light
                                                      Fill: =gblTheme.Background
                                                      FillPortions: =1
                                                      LayoutMinHeight: =10
                                                      LayoutMinWidth: =10
                                                      Size: =Round(Self.Height/4,0)
                                                      Text: =RoundDown(ThisItem.Runtime_Hours,0) & "H " & Mod(ThisItem.Runtime_Hours*60,60) & "m"
                              - oeeShiftGallerySeparator:
                                  Control: Rectangle@2.3.0
                                  Properties:
                                    Fill: =gblTheme.Accent
                                    Height: =gblPadding
                                    Width: =Parent.TemplateWidth
                                    Y: =Parent.TemplateHeight - Self.Height
                  - oeeDowntimeParent:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =Parent.Height * 0.5
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutDirection: =LayoutDirection.Horizontal
                        LayoutGap: =gblPadding*2
                        LayoutJustifyContent: =LayoutJustifyContent.Center
                        LayoutMinWidth: =10
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                      Children:
                        - oeeTopDowntimeParent:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              AlignInContainer: =AlignInContainer.SetByContainer
                              BorderColor: =gblTheme.Sec_Complement
                              BorderThickness: =If(gblTheme.Style = "Light", 0,1)
                              DropShadow: =DropShadow.Regular
                              Fill: =gblTheme.Foreground
                              FillPortions: =0
                              Height: =oeeParetoParent.Height
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              Width: =Parent.Width*0.25
                            Children:
                              - oeeTopDowntimeTitle:
                                  Control: Label@2.5.1
                                  Properties:
                                    Align: =Align.Center
                                    Color: =gblTheme.Text_Light
                                    Fill: =gblTheme.Secondary
                                    Font: =Font.Verdana
                                    Size: =Round(Self.Height / 3,0)
                                    Text: ="Downtime Breakdown"
                                    Width: =Parent.Width
                              - oeeTopDowntimeColumns:
                                  Control: GroupContainer@1.3.0
                                  Variant: ManualLayout
                                  Properties:
                                    AlignInContainer: =AlignInContainer.SetByContainer
                                    DropShadow: =DropShadow.None
                                    Fill: =gblTheme.Sec_Complement
                                    FillPortions: =0
                                    Height: =40
                                    LayoutMinHeight: =1
                                    LayoutMinWidth: =1
                                    RadiusBottomLeft: =0
                                    RadiusBottomRight: =0
                                    RadiusTopLeft: =0
                                    RadiusTopRight: =0
                                    Width: =Parent.Width
                                  Children:
                                    - oeeTopDopwntimeColumnsAmount:
                                        Control: Label@2.5.1
                                        Properties:
                                          Align: =Align.Center
                                          Color: =gblTheme.Text_On_Light
                                          Font: =Font.Verdana
                                          Height: =Parent.Height
                                          Size: =Round(Self.Height / 4,0)
                                          Text: ="Minutes"
                                          Width: =Parent.Width / 2
                                          X: =oeeTopDowntimeColumnsReason.X + oeeTopDowntimeColumnsReason.Width
                                    - oeeTopDowntimeColumnsReason:
                                        Control: Label@2.5.1
                                        Properties:
                                          Align: =Align.Center
                                          Color: =gblTheme.Text_On_Light
                                          Font: =Font.Verdana
                                          Height: =Parent.Height
                                          Size: =Round(Self.Height / 4,0)
                                          Text: ="Reason"
                                          Width: =Parent.Width / 2
                              - oeeTopDowntimeGallery:
                                  Control: Gallery@2.15.0
                                  Variant: Vertical
                                  Properties:
                                    Items: |-
                                      =Sort(
                                          Filter(
                                              colTopDowntime,
                                              If(
                                                  oeeDowntime.Selected.Value = "All Downtime",
                                                  true,
                                                  Not(Downtime_Reason in gblLists.Downtime_Reasons_Planned)
                                              )
                                          ),
                                          Total_Downtime,
                                          SortOrder.Descending
                                      )
                                    LayoutMinHeight: =1
                                    LayoutMinWidth: =1
                                    TemplatePadding: =0
                                    TemplateSize: =Self.Height / 6
                                  Children:
                                    - oeeTopDowntimeGallerySeparator:
                                        Control: Rectangle@2.3.0
                                        Properties:
                                          Fill: =gblTheme.Pri_Complement
                                          Height: =Parent.TemplateHeight * 0.025
                                          OnSelect: =Select(Parent)
                                          Width: =Parent.Width
                                          Y: =Parent.TemplateHeight - Self.Height
                                    - oeeTopDowntimeGalleryReason:
                                        Control: Label@2.5.1
                                        Properties:
                                          Align: =Align.Center
                                          Color: =gblTheme.Text_On_Light
                                          Font: =Font.Verdana
                                          Height: =Parent.TemplateHeight - oeeTopDowntimeGallerySeparator.Height
                                          OnSelect: =Select(Parent)
                                          Size: =Round(Self.Height/4.5,0)
                                          Text: =ThisItem.Downtime_Reason
                                          Width: =Parent.TemplateWidth/2
                                          X: =1-1
                                          Y: =1-1
                                    - oeeTopDowntimeGalleryAmount:
                                        Control: Label@2.5.1
                                        Properties:
                                          Align: =Align.Center
                                          Color: =gblTheme.Text_On_Light
                                          Font: =Font.Verdana
                                          Height: =Parent.TemplateHeight - oeeTopDowntimeGallerySeparator.Height
                                          OnSelect: =Select(Parent)
                                          Size: =Round(Self.Height/4.5,0)
                                          Text: =ThisItem.Total_Downtime
                                          Width: =Parent.TemplateWidth/2
                                          X: =oeeTopDowntimeGalleryReason.X + oeeTopDowntimeGalleryReason.Width
                                          Y: =1-1
                        - oeeParetoParent:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              AlignInContainer: =AlignInContainer.SetByContainer
                              BorderColor: =gblTheme.Sec_Complement
                              BorderThickness: =If(gblTheme.Style = "Light", 0,1)
                              DropShadow: =DropShadow.Regular
                              Fill: =gblTheme.Foreground
                              FillPortions: =0
                              Height: =Parent.Height * 0.9
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutDirection: =LayoutDirection.Horizontal
                              LayoutGap: =gblPadding*2
                              PaddingBottom: =gblPadding
                              PaddingLeft: =gblPadding
                              PaddingRight: =gblPadding
                              PaddingTop: =gblPadding
                              Width: =Parent.Width * 0.6
                            Children:
                              - oeePareto:
                                  Control: Image@2.2.3
                                  Properties:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    FillPortions: =1
                                    Height: =Parent.Height/2
                                    Image: |-
                                      ="https://quickchart.io/chart?width=" & Self.Width & "&height=" & Self.Height*0.90 & "&c=" & 
                                      EncodeUrl("
                                      {
                                        type: 'bar',
                                        data: {
                                          labels: " & Concatenate("['", Concat(Sort(Filter(colTopDowntime, If(oeeDowntime.Selected.Value = "Unplanned Only", And(Not(Downtime_Reason = "No Scheduled Work"),Not(Downtime_Reason = "Engineering DT"),Not(Downtime_Reason = "Planned Downtime")), Downtime_Reason = Downtime_Reason)), Total_Downtime, SortOrder.Descending), ThisRecord.Downtime_Reason, "', '"), "']") & ",
                                          datasets: [{
                                            label: 'Frequency',
                                            data: " & Concatenate("['", Concat(Sort(Filter(colTopDowntime, If(oeeDowntime.Selected.Value = "Unplanned Only", And(Not(Downtime_Reason = "No Scheduled Work"),Not(Downtime_Reason = "Engineering DT"),Not(Downtime_Reason = "Planned Downtime")), Downtime_Reason = Downtime_Reason)), Total_Downtime, SortOrder.Descending), ThisRecord.Total_Downtime, "', '"), "']") & ",
                                            backgroundColor: 'rgba(0, 123, 255, 0.7)'
                                          }, {
                                            label: 'Cumulative Percentage',
                                            data: " & Concatenate("['", Concat(Sort(colPareto, Freq, SortOrder.Descending), ThisRecord.Cumulative, "', '"), "']") & ",
                                            type: 'line',
                                            borderColor: 'red',
                                            fill: false,
                                            yAxisID: 'right-y-axis' // Assign to the right Y-axis
                                          }]
                                        },
                                        options: {
                                          scales: {
                                            yAxes: [{
                                              id: 'left-y-axis',
                                              type: 'linear',
                                              position: 'left',
                                              ticks: {
                                                beginAtZero: true
                                              }
                                            }, {
                                              id: 'right-y-axis',
                                              type: 'linear',
                                              position: 'right',
                                              ticks: {
                                                beginAtZero: true,
                                                max: 100,
                                                stepSize: 20,
                                                callback: function(value, index, values) {
                                                  return value + '%';
                                                }
                                              },
                                              gridLines: { 
                                                drawOnChartArea: false
                                              }
                                            }]
                                          },
                                          tooltips: {
                                            mode: 'index',
                                            intersect: false
                                          },
                                          annotation: {
                                            annotations: [{
                                              type: 'line',
                                              mode: 'horizontal',
                                              scaleID: 'right-y-axis',
                                              value: 80,
                                              borderColor: 'red',
                                              borderWidth: 2,
                                              label: {
                                                enabled: true,
                                                position: 'right',
                                                content: '80% Threshold'
                                              }
                                            },
                                            {
                                              type: 'line',
                                              mode: 'vertical',
                                              scaleID: 'x-axis-0',
                                              value: ["& First(Sort(Filter(colPareto, Cumulative >= 80), Freq, SortOrder.Descending)).Id-1 &"],
                                              borderColor: 'green',
                                              borderWidth: 2,
                                              label: {
                                                enabled: true,
                                                content: '80% Volume',
                                                position: 'top',
                                                backgroundColor: 'rgba(72, 72, 192, 0.5)'
                                              }
                                            }]
                                          }
                                        }
                                      }")
                                    LayoutMinHeight: =10
                                    LayoutMinWidth: =10
                                    Width: =Parent.Width
                                    X: =Parent.Width/2 - Self.Width/2
                                    Y: =Parent.Height/2 - Self.Height/2
                  - oeeBodyPadding:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =Parent.Height * 0.1
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
