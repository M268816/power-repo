- dor_layout:
    Control: GroupContainer
    Variant: verticalAutoLayoutContainer
    Properties:
      DropShadow: =DropShadow.None
      Height: =Parent.Height
      LayoutAlignItems: =LayoutAlignItems.Stretch
      LayoutDirection: =LayoutDirection.Vertical
      LayoutGap: =
      LayoutMode: =LayoutMode.Auto
      RadiusBottomLeft: =0
      RadiusBottomRight: =0
      RadiusTopLeft: =0
      RadiusTopRight: =0
      Width: =Parent.Width
      X: =
    Children:
    - dor_header:
        Control: GroupContainer
        Variant: horizontalAutoLayoutContainer
        Properties:
          AlignInContainer: =AlignInContainer.SetByContainer
          DropShadow: =DropShadow.None
          Fill: =varColor1
          LayoutAlignItems: =LayoutAlignItems.Stretch
          LayoutGap: =varPadding
          LayoutMinHeight: =10
          LayoutMinWidth: =10
          LayoutMode: =LayoutMode.Auto
          PaddingBottom: =varPadding
          PaddingLeft: =varPadding
          PaddingRight: =varPadding
          PaddingTop: =varPadding
          RadiusBottomLeft: =0
          RadiusBottomRight: =0
          RadiusTopLeft: =0
          RadiusTopRight: =0
        Children:
        - dor_collect:
            Control: Classic/Button
            Properties:
              OnSelect: |-
                =/*Start*/
                Set(varLoading,{Visible: true, Value: 1, Text: "Loading"});

                /*Capture Local Date Selection*/
                UpdateContext({
                    locEndDate: dor_date.SelectedDate,
                    locStartDate: dor_date.SelectedDate
                });

                Set(varLoading,{Visible: true, Value: 5, Text: "Checking for Updates"});
                /*Check if collections need updating*/
                Set(varUpdateProduction,
                    Or(
                        Not(First(Sort(Production,ID,SortOrder.Descending)).ID = First(Sort(collectProduction,id,SortOrder.Descending)).id),
                        Not(varEndDate = locEndDate),
                        Not(varStartDate = locStartDate)
                    )
                );
                Set(varUpdateDowntime,
                    Or(    
                        Not(First(Sort(Downtime,ID,SortOrder.Descending)).ID = First(Sort(collectDowntime,id,SortOrder.Descending)).id),
                        Not(varEndDate = locEndDate),
                        Not(varStartDate = locStartDate)
                    )
                );

                /*Set collection dates from selected local dates*/
                If( Not(varEndDate = locEndDate), Set(varEndDate, locEndDate));
                If( Not(varStartDate = locStartDate), Set(varStartDate, locStartDate));


                /*Collect Production*/
                Set(varLoading,{Visible: true, Value: 10, Text: "Collecting Production Data"});
                If(varUpdateProduction,
                    If(
                        DateDiff( varStartDate, varEndDate, TimeUnit.Days) <= 14,
                        Set(varLoading,{Visible: true, Value: 40, Text: "Retrieving Production Data"});
                        ClearCollect(collectProduction,
                            ForAll(
                                Filter(Production,
                                    Hour_Ending <= DateAdd(varEndDate, 23, TimeUnit.Hours),
                                    Hour_Starting >= DateAdd(varStartDate, -1, TimeUnit.Hours)
                                ),
                                {
                                    id: Value(ThisRecord.ID),
                                    shift: Text(ThisRecord.Shift_Letter),
                                    line: Text(ThisRecord.Line.Value),
                                    lot: Text(ThisRecord.Lot),
                                    catalog: Text(ThisRecord.Catalog),
                                    size: Text(ThisRecord.Size),
                                    hour_ending: DateTimeValue(ThisRecord.Hour_Ending),
                                    hour_starting: DateTimeValue(ThisRecord.Hour_Starting),
                                    goal: Value(ThisRecord.Hourly_Goal),
                                    amount_built: Value(ThisRecord.Amount_Built),
                                    unit_starting: Value(ThisRecord.Unit_Starting),
                                    unit_ending: Value(ThisRecord.Unit_Ending),
                                    reject_labels: Value(ThisRecord.Reject_Labels),
                                    reject_cartridges: Value(ThisRecord.Reject_Cartridges),
                                    reject_units: Value(ThisRecord.Reject_Units),
                                    qa_units: Value(ThisRecord.QA_Units)
                                }
                            )
                        ),

                        DateDiff( varStartDate, varEndDate, TimeUnit.Days) > 21,
                        Set(varLoading,{Visible: true, Value: 40, Text: "Parsing PowerAutomate Flow for Production Data"});
                        ClearCollect(collectProduction,
                            ForAll(
                                Table(
                                    ParseJSON(
                                        flow_get_units_range_v2.Run(
                                            Text("All"),
                                            Text(DateAdd(varEndDate, 23,TimeUnit.Hours), "yyyy-mm-dd"),
                                            Text(DateAdd(varStartDate, -1, TimeUnit.Hours), "yyyy-mm-dd")
                                        ).output
                                    )
                                ),
                                {
                                    id: Value(Value._ID),
                                    shift: Text(Value._shift),
                                    line: Text(Value._line),
                                    lot: Text(Value._lot),
                                    catalog: Text(Value._catalog),
                                    size: Text(Value._size),
                                    hour_ending: DateTimeValue(Value._hour_ending),
                                    hour_starting: DateTimeValue(Value._hour_starting),
                                    goal: Value(Value._goal),
                                    amount_built: Value(Value._amount_built),
                                    unit_starting: Value(Value._unit_starting),
                                    unit_ending: Value(Value._unit_ending),
                                    reject_labels: Value(Value._reject_labels),
                                    reject_cartridges: Value(Value._reject_cartridges),
                                    reject_units: Value(Value._reject_units),
                                    qa_units: Value(Value._qa)
                                }
                            )
                        ),

                        DateDiff( varStartDate, varEndDate, TimeUnit.Days) <= 21,
                        Set(varLoading,{Visible: true, Value: 15, Text: "Collecting Production Dataset 1"});
                        Collect(material_1,
                            Sort(
                                Filter(Production,
                                    And(
                                        Hour_Ending <= DateAdd(varEndDate, 23, TimeUnit.Hours),
                                        Hour_Starting >= DateAdd(varStartDate, -1, TimeUnit.Hours)                        
                                    )
                                ),
                                Hour_Ending,
                                SortOrder.Ascending
                            )
                        );

                        Set(varLoading,{Visible: true, Value: 20, Text: "Collecting Production Dataset 2"});
                        Collect(material_2,
                            Sort(
                                Filter(Production,
                                    And(
                                        Hour_Ending <= DateAdd(varEndDate, 23, TimeUnit.Hours),
                                        Hour_Starting >= DateAdd(varStartDate, -1, TimeUnit.Hours)                        
                                    )
                                ),
                                Hour_Ending,
                                SortOrder.Descending
                            )
                        );

                        Set(varLoading,{Visible: true, Value: 25, Text: "Joining Production Dataset 1"});
                        ClearCollect(fusion, material_1);

                        Set(varLoading,{Visible: true, Value: 30, Text: "Joining Production Dataset 2"});
                        Collect(fusion,
                            Filter(material_2, Not(ID in material_1.ID))
                        );

                        Set(varLoading,{Visible: true, Value: 35, Text: "Collecting Joined Production Data"});
                        ClearCollect(
                            collectProduction,
                            ForAll(
                                fusion,
                                {
                                    id: Value(ThisRecord.ID),
                                    shift: Text(ThisRecord.Shift_Letter),
                                    line: Text(ThisRecord.Line.Value),
                                    lot: Text(ThisRecord.Lot),
                                    catalog: Text(ThisRecord.Catalog),
                                    size: Text(ThisRecord.Size),
                                    hour_ending: DateTimeValue(ThisRecord.Hour_Ending),
                                    hour_starting: DateTimeValue(ThisRecord.Hour_Starting),
                                    goal: Value(ThisRecord.Hourly_Goal),
                                    amount_built: Value(ThisRecord.Amount_Built),
                                    unit_starting: Value(ThisRecord.Unit_Starting),
                                    unit_ending: Value(ThisRecord.Unit_Ending),
                                    reject_labels: Value(ThisRecord.Reject_Labels),
                                    reject_cartridges: Value(ThisRecord.Reject_Cartridges),
                                    reject_units: Value(ThisRecord.Reject_Units),
                                    qa_units: Value(ThisRecord.QA_Units)
                                }
                            )
                        );

                        Set(varLoading,{Visible: true, Value: 40, Text: "Garbage Collection"});
                        Clear(fusion);
                        Clear(material_1);
                        Clear(material_2);
                    )
                );

                /*Collect Downtime*/
                Set(varLoading,{Visible: true, Value: 45, Text: "Collecting Downtime Data"});
                If(varUpdateDowntime,
                    If(
                        DateDiff( varStartDate, varEndDate, TimeUnit.Days) <= 14,
                        Set(varLoading,{Visible: true, Value: 75, Text: "Retrieving Downtime Data"});
                        ClearCollect(collectDowntime,
                            ForAll(
                                Filter(Downtime,
                                    Ended <= DateAdd(varEndDate, 23, TimeUnit.Hours),
                                    Started >= DateAdd(varStartDate, -1, TimeUnit.Hours)
                                ),
                                {
                                    id: Value(ThisRecord.ID),
                                    shift: Text(ThisRecord.Shift_Letter),
                                    line: Text(ThisRecord.Line.Value),
                                    lot: Text(ThisRecord.Lot),
                                    catalog: Text(ThisRecord.Catalog),
                                    size: Text(ThisRecord.Size),
                                    started: DateTimeValue(ThisRecord.Started),
                                    ended: DateTimeValue(ThisRecord.Ended),
                                    reason: Text(ThisRecord.Reason.Value),
                                    total: Value(ThisRecord.Total_Downtime),
                                    comments: Text(ThisRecord.Comments)
                                }
                            )
                        ),

                        DateDiff( varStartDate, varEndDate, TimeUnit.Days) > 21,
                        Set(varLoading,{Visible: true, Value: 75, Text: "Parsing PowerAutomate Flow for Downtime Data"});
                        ClearCollect(collectDowntime,
                            ForAll(
                                Table(
                                    ParseJSON(
                                        flow_get_downtime_range_v2.Run(
                                            Text("All"),
                                            Text(DateAdd(varEndDate, 23,TimeUnit.Hours), "yyyy-mm-dd"),
                                            Text(DateAdd(varStartDate, -1, TimeUnit.Hours), "yyyy-mm-dd")
                                        ).output
                                    )
                                ),
                                {
                                    id: Value(Value._ID),
                                    shift: Text(Value._shift),
                                    line: Text(Value._line),
                                    lot: Text(Value._lot),
                                    catalog: Text(Value._catalog),
                                    size: Text(Value._size),
                                    started: DateTimeValue(Value._started),
                                    ended: DateTimeValue(Value._ended),
                                    reason: Text(Value._reason),
                                    total: Value(Value._total),
                                    comments: Text(Value._comments)
                                }
                            )
                        ),

                        DateDiff( varStartDate, varEndDate, TimeUnit.Days) <= 21,
                        Set(varLoading,{Visible: true, Value: 50, Text: "Collecting Downtime Dataset 1"});
                        Collect(material_1,
                            Sort(
                                Filter(Downtime,
                                    And(
                                        Ended <= DateAdd(varEndDate, 23, TimeUnit.Hours),
                                        Started >= DateAdd(varStartDate, -1, TimeUnit.Hours)
                                    )
                                ),
                                Ended,
                                SortOrder.Ascending
                            )
                        );

                        Set(varLoading,{Visible: true, Value: 55, Text: "Collecting Downtime Dataset 2"});
                        Collect(material_2,
                            Sort(
                                Filter(Downtime,
                                    And(
                                        Ended <= DateAdd(varEndDate, 23, TimeUnit.Hours),
                                        Started >= DateAdd(varStartDate, -1, TimeUnit.Hours)                        
                                    )
                                ),
                                Ended,
                                SortOrder.Descending
                            )
                        );

                        Set(varLoading,{Visible: true, Value: 60, Text: "Joining Downtime Dataset 1"});
                        ClearCollect(fusion, material_1);

                        Set(varLoading,{Visible: true, Value: 65, Text: "Joining Downtime Dataset 2"});
                        Collect(fusion,
                            Filter(material_2, Not(ID in material_1.ID))
                        );

                        Set(varLoading,{Visible: true, Value: 70, Text: "Collecting Joined Downtime Data"});
                        ClearCollect(
                            collectDowntime,
                            ForAll(
                                fusion,
                                {
                                    id: Value(ThisRecord.ID),
                                    shift: Text(ThisRecord.Shift_Letter),
                                    line: Text(ThisRecord.Line.Value),
                                    lot: Text(ThisRecord.Lot),
                                    catalog: Text(ThisRecord.Catalog),
                                    size: Text(ThisRecord.Size),
                                    started: DateTimeValue(ThisRecord.Started),
                                    ended: DateTimeValue(ThisRecord.Ended),
                                    reason: Text(ThisRecord.Reason.Value),
                                    total: Value(ThisRecord.Total_Downtime),
                                    comments: Text(ThisRecord.Comments)
                                }
                            )
                        );

                        Set(varLoading,{Visible: true, Value: 75, Text: "Garbage Collection"});
                        Clear(fusion);
                        Clear(material_1);
                        Clear(material_2);
                    )
                );

                /*Update the UI Elements*/
                Select(dor_update);
              Text: ="collect"
              Visible: =false
              X: =20
              Y: =20
        - dor_update:
            Control: Classic/Button
            Properties:
              OnSelect: |-
                =/*Start*/
                Set(varLoading,{Visible: true, Value: 80, Text: "Updating"});

                /*Create Default Filters*/
                Set(varLoading,{Visible: true, Value: 85, Text: "Creating default filters"});

                UpdateContext({
                    locDORFilter:
                        Filter(Digital_DOR, Date = dor_date.SelectedDate),
                    
                    locDefaultProductionFilter:
                        Filter(collectProduction,
                            And(
                                hour_starting >= DateAdd(dor_date.SelectedDate, -1, TimeUnit.Hours),
                                hour_ending <= DateAdd(dor_date.SelectedDate, 23, TimeUnit.Hours)
                            )
                        ),
                    
                    locDefaultDowntimeFilter:
                        Filter(collectDowntime,
                            And(
                                started >= DateAdd(DateValue(dor_date.SelectedDate), -1, TimeUnit.Hours),
                                ended <= DateAdd(DateValue(dor_date.SelectedDate), 23, TimeUnit.Hours)
                            )
                        )
                });

                /*Collect Labor Hours*/
                Set(varLoading,{Visible: true, Value: 88, Text: "Collecting Labor Hours"});
                Clear(collectLaborHours);
                With(
                    {
                        Record:
                            [
                                {Line: "SSC", Value:Sum(locDORFilter, Labor_SSC)},
                                {Line: "SSC2", Value:Sum(locDORFilter, Labor_SSC2)},
                                {Line: "XL1", Value:Sum(locDORFilter, Labor_XL1)},
                                {Line: "XL2", Value:Sum(locDORFilter, Labor_XL2)},
                                {Line: "XL3", Value:Sum(locDORFilter, Labor_XL3)},
                                {Line: "XL4", Value:Sum(locDORFilter, Labor_XL4)},
                                {Line: "XL5", Value:Sum(locDORFilter, Labor_XL5)},
                                {Line: "XLT", Value:Sum(locDORFilter, Labor_XLT)},
                                {Line: "XLT2", Value:Sum(locDORFilter, Labor_XLT2)},
                                {Line: "XLT3", Value:Sum(locDORFilter, Labor_XLT3)},
                                {Line: "Indirect", Value:Sum(locDORFilter, Labor_Indirect)}
                            ]
                    },
                    ForAll(ThisRecord.Record, Collect(collectLaborHours, {Line: ThisRecord.Line, Value: ThisRecord.Value}))
                );

                /*Collect Outputs*/
                Set(varLoading,{Visible: true, Value: 86, Text: "Calculating Outputs"});
                ClearCollect(collectDOR,
                    {
                        OEE_Target: 59,
                        
                        Downtime_Allowance: 3450,

                        Target_Yield: 98,

                        Target_Labor: 12.8,

                        SSC_Output:
                            Sum(
                                Filter(locDefaultProductionFilter,
                                    line = "SSC" || line = "SSC2"
                                ),
                                amount_built
                            ),

                        XL_Output:
                            Sum(
                                Filter(locDefaultProductionFilter,
                                    line = "XL1" || line = "XL2" || line = "XL3" || line = "XL4" || line = "XL5"
                                ),
                                amount_built
                            ),

                        XLT_Output:
                            Sum(
                                Filter(locDefaultProductionFilter,
                                    line = "XLT" || line = "XLT2" || line = "XLT3"
                                ),
                                amount_built
                            ),

                        Total_Labor_Hours: Sum(collectLaborHours, Value),

                        Stretches: Sum(locDORFilter, Safety_Stretches),

                        Excercises: Sum(locDORFilter, Safety_Exercises),

                        Near_Miss: Sum(locDORFilter, Safety_NearMiss),

                        First_Aid: Sum(locDORFilter, Safety_FirstAid),
                        
                        Incidents: Sum(locDORFilter, Safety_Incidents),
                        
                        ROEs: Sum(locDORFilter, Quality_ROEs),
                        
                        Deviations: Sum(locDORFilter, Quality_Deviations),

                        A_Tie_Off: LookUp(locDORFilter, Shift.Value = "A").Tie_Off,

                        B_Tie_Off: LookUp(locDORFilter, Shift.Value = "B").Tie_Off,

                        C_Tie_Off: LookUp(locDORFilter, Shift.Value = "C").Tie_Off
                    }
                );


                /*Collect Top Downtime*/
                Set(varLoading,{Visible: true, Value: 89, Text: "Processing Top Downtime Reasons"});
                /*For all lines, for all downtime reasons, collect the total sum of downtime, if downtime is greater than 0, add to collectTopDowntimePerLine*/
                Clear(collectTopDowntimePerLine);
                ForAll(collectLineSchema,
                    With({thisLine: ThisRecord.SCH_Line},
                        ForAll(collectDowntimeReasons,
                            With({thisReason: ThisRecord.Downtime_Reason},
                                If(
                                    Sum(
                                        Filter(locDefaultDowntimeFilter,
                                            reason = thisReason,
                                            line = thisLine
                                        ),
                                        total
                                    ) > 0,
                                    Collect(collectTopDowntimePerLine,
                                        {
                                            Line: thisLine,
                                            
                                            Downtime_Reason: thisReason,

                                            Downtime_Total: 
                                                Sum(
                                                    Filter(locDefaultDowntimeFilter,
                                                        reason = thisReason,
                                                        line = thisLine
                                                    ),
                                                    total
                                                ),
                                            
                                            Comments:
                                                Concat(Filter(locDefaultDowntimeFilter,reason = thisReason, line = thisLine), comments, "...")
                                        }

                                    )
                                )
                            )
                        )
                    )
                );

                /*Combine databases to find total runtime*/
                Set(varLoading,{Visible: true, Value: 90, Text: "Combining Databases"});
                Clear(collectCombinedData);
                ClearCollect(collectCombinedData,
                    Filter(
                        collectProduction,
                        And(
                            hour_starting >= DateAdd(dor_date.SelectedDate, -1, TimeUnit.Hours),
                            hour_ending <= DateAdd(dor_date.SelectedDate, 23, TimeUnit.Hours)
                        )
                    )
                );
                ForAll(
                    collectLineSchema,
                    {
                        Line: SCH_Line,
                        
                        Value:
                        ForAll(
                            Filter(
                                collectDowntime,
                                And(
                                    started >= DateAdd(dor_date.SelectedDate, -1, TimeUnit.Hours),
                                    ended <= DateAdd(dor_date.SelectedDate, 23, TimeUnit.Hours)
                                ),
                                line = SCH_Line
                            ),
                            With(
                                {
                                    thisDowntime: ThisRecord,
                                    thisLine: SCH_Line
                                },
                                If(
                                    CountRows(
                                        Filter(
                                            collectProduction,
                                            And(
                                                hour_starting >= DateAdd(dor_date.SelectedDate, -1, TimeUnit.Hours),
                                                hour_ending <= DateAdd(dor_date.SelectedDate, 23, TimeUnit.Hours)
                                            ),
                                            line = SCH_Line,
                                            (hour_starting <= thisDowntime.started && hour_ending > thisDowntime.started) || 
                                            (hour_starting < thisDowntime.ended && hour_ending >= thisDowntime.ended) ||
                                            (hour_starting >= thisDowntime.started && hour_ending <= thisDowntime.ended)
                                        )
                                    ) = 0,
                                    Collect(collectCombinedData, thisDowntime)
                                )
                            )
                        )
                    }
                );

                /*For each catalog, for each line, collect output, constraint, and runtime*/
                Set(varLoading,{Visible: true, Value: 91, Text: "Calculating Line OEE2 Data"});
                Clear(collectLineOEE2Data);
                With(
                    {
                        theseLines:
                            ["XL1", "XL2", "XL3", "XL4", "XL5", "SSC", "SSC2", "XLT", "XLT2", "XLT3"],
                        
                        theseCatalogs:
                            ["51", "02", "03", "04", "05", "10", "015", "003", "006", "1F", "1H", "1S", "1T", "1Z", "2F", "2H", "2S", "2T", "2Z", "3F", "3H", "3S", "3T", "3Z"]
                    },
                    ForAll(theseLines,
                        With({thisLine: ThisRecord.Value},
                            ForAll(theseCatalogs,
                                With({thisCatalog: ThisRecord.Value},
                                    If(
                                        Sum(
                                            Filter(collectProduction,
                                                And(
                                                    hour_starting >= DateAdd(dor_date.SelectedDate, -1, TimeUnit.Hours),
                                                    hour_ending <= DateAdd(dor_date.SelectedDate, 23, TimeUnit.Hours)
                                                ),
                                                line = thisLine,
                                                size = thisCatalog
                                            ),
                                            amount_built
                                        ) > 0,
                                    
                                        Collect(collectLineOEE2Data,
                                            {                                        
                                                line: thisLine,
                                                
                                                catalog: thisCatalog,
                                                    
                                                output:
                                                    Sum(
                                                        Filter(collectProduction,
                                                            And(
                                                                hour_starting >= DateAdd(dor_date.SelectedDate, -1, TimeUnit.Hours),
                                                                hour_ending <= DateAdd(dor_date.SelectedDate, 23, TimeUnit.Hours)
                                                            ),
                                                            line = thisLine,
                                                            size = thisCatalog
                                                        ),
                                                        amount_built
                                                    ),

                                                total:
                                                    Sum(
                                                        Filter(collectProduction,
                                                            And(
                                                                hour_starting >= DateAdd(dor_date.SelectedDate, -1, TimeUnit.Hours),
                                                                hour_ending <= DateAdd(dor_date.SelectedDate, 23, TimeUnit.Hours)
                                                            ),
                                                            line = thisLine,
                                                            size = thisCatalog
                                                        ),
                                                        amount_built + reject_units + reject_cartridges
                                                    ),
                                            
                                                constraint_goal:
                                                    /*Constraint *  Runtime*/
                                                    /*Constraint*/
                                                        IfError(
                                                            Average(
                                                                Filter(Goal_Settings,
                                                                    Line.Value = thisLine,
                                                                    Size.Value = thisCatalog,
                                                                    Constraint_Setting > 0
                                                                ), Constraint_Setting
                                                            ),
                                                            0
                                                        )*
                                                    /* Runtime */
                                                        (
                                                            /*Collect Runtime Minutes From Production*/
                                                            (CountRows(
                                                                Filter(collectCombinedData,
                                                                    amount_built > 0,
                                                                    line = thisLine,
                                                                    size = thisCatalog
                                                                )
                                                            ) * 60) +
                                                            /*Collect Runtime Minues From Downtime*/
                                                            Sum(
                                                                Filter(collectCombinedData,
                                                                    line = thisLine,
                                                                    size = thisCatalog,
                                                                    Not(reason = "Planned Downtime" || reason = "No Scheduled Work" || reason = "Engineering DT")
                                                                ),
                                                                total
                                                            )
                                                        ) / 60
                                            }
                                        )
                                    )
                                )
                            )
                        )
                    )
                );

                /*Collect Line OEE2*/
                Set(varLoading,{Visible: true, Value: 92, Text: "Creating OEE2 per Line"});
                Clear(collectLineOEE);
                ForAll(collectLineSchema,
                    Collect(collectLineOEE,
                        {
                            line: SCH_Line,
                            
                            OEE2:
                                IfError(
                                    Round(
                                        Sum(
                                            Filter(collectLineOEE2Data, output > 0, line = SCH_Line),
                                            output
                                        ) /
                                        Sum(
                                            Filter(collectLineOEE2Data, output > 0, line = SCH_Line),
                                            constraint_goal
                                        ) * 100,
                                        2
                                    ),
                                    0
                                ),

                            output:
                                IfError(
                                    Sum(
                                        Filter(collectLineOEE2Data,
                                            output > 0,
                                            line = SCH_Line
                                        ),
                                        output
                                    ),
                                    0
                                ),

                            constraint_goal:
                                IfError(
                                    Sum(
                                        Filter(collectLineOEE2Data,
                                            output > 0,
                                            line = SCH_Line
                                        ),
                                        constraint_goal
                                    ),
                                    0
                                ),
                            
                            total:
                                IfError(
                                    Sum(
                                        Filter(collectLineOEE2Data,
                                            total > 0,
                                            line = SCH_Line
                                        ),
                                        total
                                    ),
                                    0
                                ),

                            downtime_total:
                                Sum(
                                    Filter(locDefaultDowntimeFilter,
                                        line = SCH_Line
                                    ),
                                    total
                                )

                        }
                    )
                );

                /*For each catalog, for each line, collect output, constraint, and runtime*/
                Set(varLoading,{Visible: true, Value: 93, Text: "Gathering Overall OEE2 Data"});
                Clear(collectOEE2Data);
                With(
                    {
                        theseLines:
                            ["XL1", "XL2", "XL3", "XL4", "XL5", "SSC", "SSC2", "XLT", "XLT2", "XLT3"],

                        theseCatalogs:
                            ["51", "02", "03", "04", "05", "10", "015", "003", "006", "1F", "1H", "1S", "1T", "1Z", "2F", "2H", "2S", "2T", "2Z", "3F", "3H", "3S", "3T", "3Z"]
                    },
                    ForAll(theseLines,
                        With({thisLine: ThisRecord.Value},
                            ForAll(theseCatalogs,
                                With({thisCatalog: ThisRecord.Value},
                                    If(
                                        Sum(
                                            Filter(collectProduction,
                                                And(
                                                    hour_starting >= DateAdd(dor_date.SelectedDate, -1, TimeUnit.Hours),
                                                    hour_ending <= DateAdd(dor_date.SelectedDate, 23, TimeUnit.Hours)
                                                ),
                                                line = thisLine,
                                                size = thisCatalog
                                            ),
                                            amount_built
                                        ) > 0,
                                    
                                        Collect(collectOEE2Data,
                                            {
                                                line: thisLine,
                                                
                                                catalog: thisCatalog,
                                                    
                                                output:
                                                    Sum(
                                                        Filter(collectProduction,
                                                            And(
                                                                hour_starting >= DateAdd(dor_date.SelectedDate, -1, TimeUnit.Hours),
                                                                hour_ending <= DateAdd(dor_date.SelectedDate, 23, TimeUnit.Hours)
                                                            ),
                                                            line = thisLine,
                                                            size = thisCatalog
                                                        ),
                                                        amount_built
                                                    ),
                                            
                                                constraint_goal:
                                                    /*Constraint *  Runtime*/
                                                    /*Constraint*/
                                                    IfError(
                                                        First(Filter(Goal_Settings, Line.Value = thisLine, Size.Value = thisCatalog)).Constraint_Setting,
                                                        0
                                                    ) *
                                                    /* Runtime */
                                                    (
                                                        /*Collect runtime minutes from production*/
                                                        (CountRows(
                                                            Filter(collectCombinedData,
                                                                amount_built > 0,
                                                                line = thisLine,
                                                                size = thisCatalog
                                                            )
                                                        ) * 60) +
                                                        /*Collect runtime minutes from downtime*/
                                                        Sum(
                                                            Filter(collectCombinedData,
                                                                line = thisLine,
                                                                size = thisCatalog,
                                                                Not(reason = "Planned Downtime" || reason = "No Scheduled Work" || reason = "Engineering DT")
                                                            ),
                                                            total
                                                        )
                                                    ) / 60
                                            }
                                        )
                                    )
                                )
                            )
                        )   
                    )
                );

                /*Collect OEE2*/
                Set(varLoading,{Visible: true, Value: 94, Text: "Calculating OEE2"});
                Clear(collectOEE2);
                With(
                    {
                        constraint_goal:
                            IfError(
                                Sum(collectOEE2Data,
                                    constraint_goal
                                ),
                                0
                            ),

                        output:
                            IfError(
                                Sum(collectOEE2Data,
                                    output
                                ),
                                0
                            ),
                        
                        total:
                            Sum(
                                locDefaultProductionFilter,
                                reject_cartridges + reject_units + amount_built
                            )
                    },
                    Collect(collectOEE2,
                        {
                            SSC_Target:
                                Sum(
                                    Filter(collectOEE2Data,
                                        line = "SSC" || line = "SSC2"
                                    ),
                                    constraint_goal
                                ),
                            XL_Target:
                                Sum(
                                    Filter(collectOEE2Data,
                                        line = "XL1" || line = "XL2" || line = "XL3" || line = "XL4" || line = "XL5"
                                    ),
                                    constraint_goal
                                ),
                            XLT_Target:
                                Sum(
                                    Filter(collectOEE2Data,
                                        line = "XLT" || line = "XLT2" || line = "XLT3"
                                    ),
                                    constraint_goal
                                ),

                            OEE2:
                                IfError(
                                    Round(
                                        (output / constraint_goal),
                                        2
                                    ) * 100,
                                    0
                                ),

                            downtime_total:
                                Sum(
                                    locDefaultDowntimeFilter,
                                    total
                                )*1,
                            
                            total: total,

                            constraint_goal: constraint_goal,

                            yield:
                                IfError(
                                    Round(
                                        (output / total) * 100,
                                        0
                                    ),
                                    0
                                )
                        }
                    )
                );


                /*Garbage collection*/
                Set(varLoading,{Visible: true, Value: 95, Text: "Finishing Up"});

                UpdateContext({
                    locDefaultProductionFilter: Blank(),
                    locDefaultDowntimeFilter: Blank()
                });
                Clear(collectCombinedData);
                Clear(collectLineOEE2Data);
                Clear(collectOEE2Data);

                /*End*/
                Set(varLoading,{Visible: true, Value: 100, Text: "Completed"});
                Set(varLoading,{Visible: false, Value: -1, Text: "Not Loading"});
              Text: ="update"
              Visible: =false
              X: =20
              Y: =20
        - dor_logo:
            Control: Image
            Properties:
              Image: =LOGO_MSIG_SBlue_FIT_ALPHA
              FillPortions: =1
              LayoutMinHeight: =1
              LayoutMinWidth: =1
              Width: =10
        - dor_h_title:
            Control: Label
            Properties:
              Text: ="Encapsualtion Daily Managmenet System"
              Align: =Align.Center
              Color: =varColor5
              FillPortions: =6
              LayoutMinHeight: =1
              LayoutMinWidth: =1
              Size: =Self.Height / 2
        - dor_h_nav:
            Control: GroupContainer
            Variant: horizontalAutoLayoutContainer
            Properties:
              AlignInContainer: =AlignInContainer.SetByContainer
              DropShadow: =DropShadow.None
              LayoutAlignItems: =LayoutAlignItems.Stretch
              LayoutGap: =varPadding
              LayoutJustifyContent: =LayoutJustifyContent.Center
              LayoutMinHeight: =1
              LayoutMinWidth: =10
              LayoutMode: =LayoutMode.Auto
              RadiusBottomLeft: =0
              RadiusBottomRight: =0
              RadiusTopLeft: =0
              RadiusTopRight: =0
              Width: =dor_h_n_reload.Width * 3 + varPadding * 4
            Children:
            - dor_h_n_reload:
                Control: Image
                Properties:
                  OnSelect: "=/*Start*/\r\nUpdateContext({locLoading:{Visible: true, Value: 1, Text: \"Loading\"}});\r\n\r\nUpdateContext({\r\n    locStartDate: dor_date.SelectedDate,\r\n    locEndDate: dor_date.SelectedDate\r\n});\r\n\r\n/*Collect Production*/\r\nIf(\r\n    DateDiff( locStartDate, locEndDate, TimeUnit.Days) <= 10,\r\n    UpdateContext({locLoading:{Visible: true, Value: 25, Text: \"Collecting Production Data\"}});\r\n    ClearCollect(collectProduction,\r\n        ForAll(\r\n            Filter(Production,\r\n                Hour_Ending <= DateAdd(locEndDate, 23, TimeUnit.Hours),\r\n                Hour_Starting >= DateAdd(locStartDate, -1, TimeUnit.Hours)\r\n            ),\r\n            {\r\n                id: Value(ThisRecord.ID),\r\n                shift: Text(ThisRecord.Shift_Letter),\r\n                line: Text(ThisRecord.Line.Value),\r\n                lot: Text(ThisRecord.Lot),\r\n                catalog: Text(ThisRecord.Catalog),\r\n                size: Text(ThisRecord.Size),\r\n                hour_ending: DateTimeValue(ThisRecord.Hour_Ending),\r\n                hour_starting: DateTimeValue(ThisRecord.Hour_Starting),\r\n                goal: Value(ThisRecord.Hourly_Goal),\r\n                amount_built: Value(ThisRecord.Amount_Built),\r\n                unit_starting: Value(ThisRecord.Unit_Starting),\r\n                unit_ending: Value(ThisRecord.Unit_Ending),\r\n                reject_labels: Value(ThisRecord.Reject_Labels),\r\n                reject_cartridges: Value(ThisRecord.Reject_Cartridges),\r\n                reject_units: Value(ThisRecord.Reject_Units),\r\n                qa_units: Value(ThisRecord.QA_Units)\r\n            }\r\n        )\r\n    ),\r\n\r\n    DateDiff( locStartDate, locEndDate, TimeUnit.Days) > 20,\r\n    UpdateContext({locLoading:{Visible: true, Value: 25, Text: \"Parsing PowerAutomate Flow for Production Data\"}});\r\n    ClearCollect(collectProduction,\r\n        ForAll(\r\n            Table(\r\n                ParseJSON(\r\n                    flow_get_units_range_v2.Run(\r\n                        Text(\"All\"),\r\n                        Text(DateAdd(locEndDate, 23,TimeUnit.Hours), \"yyyy-mm-dd\"),\r\n                        Text(DateAdd(locStartDate, -1, TimeUnit.Hours), \"yyyy-mm-dd\")\r\n                    ).output\r\n                )\r\n            ),\r\n            {\r\n                id: Value(Value._ID),\r\n                shift: Text(Value._shift),\r\n                line: Text(Value._line),\r\n                lot: Text(Value._lot),\r\n                catalog: Text(Value._catalog),\r\n                size: Text(Value._size),\r\n                hour_ending: DateTimeValue(Value._hour_ending),\r\n                hour_starting: DateTimeValue(Value._hour_starting),\r\n                goal: Value(Value._goal),\r\n                amount_built: Value(Value._amount_built),\r\n                unit_starting: Value(Value._unit_starting),\r\n                unit_ending: Value(Value._unit_ending),\r\n                reject_labels: Value(Value._reject_labels),\r\n                reject_cartridges: Value(Value._reject_cartridges),\r\n                reject_units: Value(Value._reject_units),\r\n                qa_units: Value(Value._qa)\r\n            }\r\n        )\r\n    ),\r\n\r\n    DateDiff( locStartDate, locEndDate, TimeUnit.Days) <= 20,\r\n    UpdateContext({locLoading:{Visible: true, Value: 5, Text: \"Collecting Production Dataset 1\"}});\r\n     Collect(material_1,\r\n        Sort(\r\n            Filter(Production,\r\n                And(\r\n                    Hour_Starting >= DateAdd(locStartDate, -1, TimeUnit.Hours),\r\n                    Hour_Ending <= DateAdd(locEndDate, 23, TimeUnit.Hours)\r\n                )\r\n            ),\r\n            Hour_Ending,\r\n            SortOrder.Ascending\r\n        )\r\n    );\r\n\r\n    UpdateContext({locLoading:{Visible: true, Value: 10, Text: \"Collecting Production Dataset 2\"}});\r\n    Collect(material_2,\r\n        Sort(\r\n            Filter(Production,\r\n                And(\r\n                    Hour_Starting >= DateAdd(locStartDate, -1, TimeUnit.Hours),\r\n                    Hour_Ending <= DateAdd(locEndDate, 23, TimeUnit.Hours)\r\n                )\r\n            ),\r\n            Hour_Ending,\r\n            SortOrder.Descending\r\n        )\r\n    );\r\n\r\n    \r\n    UpdateContext({locLoading:{Visible: true, Value: 15, Text: \"Joining Production Dataset 1\"}});\r\n    ClearCollect(fusion, material_1);\r\n\r\n    UpdateContext({locLoading:{Visible: true, Value: 20, Text: \"Joining Production Dataset 2\"}});\r\n    Collect(fusion,\r\n        Filter(material_2, Not(ID in material_1.ID))\r\n    );\r\n\r\n    UpdateContext({locLoading:{Visible: true, Value: 25, Text: \"Collecting Joined Production Data\"}});\r\n    ClearCollect(\r\n        collectProduction,\r\n        ForAll(\r\n            fusion,\r\n            {\r\n                id: Value(ThisRecord.ID),\r\n                shift: Text(ThisRecord.Shift_Letter),\r\n                line: Text(ThisRecord.Line.Value),\r\n                lot: Text(ThisRecord.Lot),\r\n                catalog: Text(ThisRecord.Catalog),\r\n                size: Text(ThisRecord.Size),\r\n                hour_ending: DateTimeValue(ThisRecord.Hour_Ending),\r\n                hour_starting: DateTimeValue(ThisRecord.Hour_Starting),\r\n                goal: Value(ThisRecord.Hourly_Goal),\r\n                amount_built: Value(ThisRecord.Amount_Built),\r\n                unit_starting: Value(ThisRecord.Unit_Starting),\r\n                unit_ending: Value(ThisRecord.Unit_Ending),\r\n                reject_labels: Value(ThisRecord.Reject_Labels),\r\n                reject_cartridges: Value(ThisRecord.Reject_Cartridges),\r\n                reject_units: Value(ThisRecord.Reject_Units),\r\n                qa_units: Value(ThisRecord.QA_Units)\r\n            }\r\n        )\r\n    );\r\n\r\n    UpdateContext({locLoading:{Visible: true, Value: 26, Text: \"Garbage Collection\"}});\r\n    Clear(fusion);\r\n    Clear(material_1);\r\n    Clear(material_2);\r\n);\r\n\r\n/*Collect Downtime*/\r\nIf(\r\n    DateDiff( locStartDate, locEndDate, TimeUnit.Days) <= 10,\r\n    UpdateContext({locLoading:{Visible: true, Value: 50, Text: \"Collecting Downtime Data\"}});\r\n    ClearCollect(collectDowntime,\r\n        ForAll(\r\n            Filter(Downtime,\r\n                Ended <= DateAdd(locEndDate, 23, TimeUnit.Hours),\r\n                Started >= DateAdd(locStartDate, -1, TimeUnit.Hours)\r\n            ),\r\n            {\r\n                id: Value(ThisRecord.ID),\r\n                shift: Text(ThisRecord.Shift_Letter),\r\n                line: Text(ThisRecord.Line.Value),\r\n                lot: Text(ThisRecord.Lot),\r\n                catalog: Text(ThisRecord.Catalog),\r\n                size: Text(ThisRecord.Size),\r\n                started: DateTimeValue(ThisRecord.Started),\r\n                ended: DateTimeValue(ThisRecord.Ended),\r\n                reason: Text(ThisRecord.Reason.Value),\r\n                total: Value(ThisRecord.Total_Downtime),\r\n                comments: Text(ThisRecord.Comments)\r\n            }\r\n        )\r\n    ),\r\n\r\n    DateDiff( locStartDate, locEndDate, TimeUnit.Days) > 20,\r\n    UpdateContext({locLoading:{Visible: true, Value: 50, Text: \"Parsing PowerAutomate Flow for Downtime Data\"}});\r\n    ClearCollect(collectDowntime,\r\n        ForAll(\r\n            Table(\r\n                ParseJSON(\r\n                    flow_get_downtime_range_v2.Run(\r\n                        Text(\"All\"),\r\n                        Text(DateAdd(locEndDate, 23,TimeUnit.Hours), \"yyyy-mm-dd\"),\r\n                        Text(DateAdd(locStartDate, -1, TimeUnit.Hours), \"yyyy-mm-dd\")\r\n                    ).output\r\n                )\r\n            ),\r\n            {\r\n                id: Value(Value._ID),\r\n                shift: Text(Value._shift),\r\n                line: Text(Value._line),\r\n                lot: Text(Value._lot),\r\n                catalog: Text(Value._catalog),\r\n                size: Text(Value._size),\r\n                started: DateTimeValue(Value._started),\r\n                ended: DateTimeValue(Value._ended),\r\n                reason: Text(Value._reason),\r\n                total: Value(Value._total),\r\n                comments: Text(Value._comments)\r\n            }\r\n        )\r\n    ),\r\n\r\n    DateDiff( locStartDate, locEndDate, TimeUnit.Days) <= 20,\r\n    UpdateContext({locLoading:{Visible: true, Value: 30, Text: \"Collecting Downtime Dataset 1\"}});\r\n     Collect(material_1,\r\n        Sort(\r\n            Filter(Downtime,\r\n                And(\r\n                    Started >= DateAdd(locStartDate, -1, TimeUnit.Hours),\r\n                    Ended <= DateAdd(locEndDate, 23, TimeUnit.Hours)\r\n                )\r\n            ),\r\n            Ended,\r\n            SortOrder.Ascending\r\n        )\r\n    );\r\n\r\n    UpdateContext({locLoading:{Visible: true, Value: 35, Text: \"Collecting Downtime Dataset 2\"}});\r\n    Collect(material_2,\r\n        Sort(\r\n            Filter(Downtime,\r\n                And(\r\n                    Started >= DateAdd(locStartDate, -1, TimeUnit.Hours),\r\n                    Ended <= DateAdd(locEndDate, 23, TimeUnit.Hours)\r\n                )\r\n            ),\r\n            Ended,\r\n            SortOrder.Descending\r\n        )\r\n    );\r\n\r\n    UpdateContext({locLoading:{Visible: true, Value: 40, Text: \"Joining Downtime Dataset 1\"}});\r\n    ClearCollect(fusion, material_1);\r\n\r\n    UpdateContext({locLoading:{Visible: true, Value: 45, Text: \"Joining Downtime Dataset 2\"}});\r\n    Collect(fusion,\r\n        Filter(material_2, Not(ID in material_1.ID))\r\n    );\r\n\r\n    UpdateContext({locLoading:{Visible: true, Value: 50, Text: \"Collecting Joined Downtime Data\"}});\r\n    ClearCollect(\r\n        collectDowntime,\r\n        ForAll(\r\n            fusion,\r\n            {\r\n                id: Value(ThisRecord.ID),\r\n                shift: Text(ThisRecord.Shift_Letter),\r\n                line: Text(ThisRecord.Line.Value),\r\n                lot: Text(ThisRecord.Lot),\r\n                catalog: Text(ThisRecord.Catalog),\r\n                size: Text(ThisRecord.Size),\r\n                started: DateTimeValue(ThisRecord.Started),\r\n                ended: DateTimeValue(ThisRecord.Ended),\r\n                reason: Text(ThisRecord.Reason.Value),\r\n                total: Value(ThisRecord.Total_Downtime),\r\n                comments: Text(ThisRecord.Comments)\r\n            }\r\n        )\r\n    );\r\n\r\n    UpdateContext({locLoading:{Visible: true, Value: 51, Text: \"Garbage Collection\"}});\r\n    Clear(fusion);\r\n    Clear(material_1);\r\n    Clear(material_2);\r\n);\r\n\r\nUpdateContext({locLoading:{Visible: true, Value: 52, Text: \"Finshing up\"}});\r\n\r\n/*Update*/\r\nSelect(dor_update);"
                  Image: =gblAppIcons.Reload
                  Height: =Parent.Height * 0.75
                  HoverBorderColor: =ColorFade(varColorYes, 20%)
                  HoverFill: =ColorFade(varColorAccent, 75%)
                  LayoutMinHeight: =1
                  LayoutMinWidth: =10
                  RadiusBottomLeft: =Self.Width/2
                  RadiusBottomRight: =Self.Width/2
                  RadiusTopLeft: =Self.Width/2
                  RadiusTopRight: =Self.Width/2
                  Width: =Self.Height
                  X: =dor_h_n_settings.X - Self.Width - Parent.Width * 0.015
                  Y: =Parent.Height/2 - Self.Height/2
            - dor_h_n_bugs:
                Control: Image
                Properties:
                  OnSelect: =Navigate(Bugs)
                  Image: =gblAppIcons.Bug
                  Height: =Parent.Height * 0.75
                  HoverBorderColor: =ColorFade(varColorYes, 20%)
                  HoverFill: =ColorFade(varColorAccent, 75%)
                  LayoutMinHeight: =1
                  LayoutMinWidth: =10
                  RadiusBottomLeft: =Self.Width/2
                  RadiusBottomRight: =Self.Width/2
                  RadiusTopLeft: =Self.Width/2
                  RadiusTopRight: =Self.Width/2
                  Width: =Self.Height
                  X: =Parent.Width * 0.99 - Self.Width
                  Y: =Parent.Height/2 - Self.Height/2
            - dor_h_n_settings:
                Control: Image
                Properties:
                  OnSelect: =Navigate(Settings)
                  Image: =gblAppIcons.Settings
                  Height: =Parent.Height * 0.75
                  HoverBorderColor: =ColorFade(varColorYes, 20%)
                  HoverFill: =ColorFade(varColorAccent, 75%)
                  LayoutMinHeight: =1
                  LayoutMinWidth: =10
                  RadiusBottomLeft: =Self.Width/2
                  RadiusBottomRight: =Self.Width/2
                  RadiusTopLeft: =Self.Width/2
                  RadiusTopRight: =Self.Width/2
                  Width: =Self.Height
                  X: =Parent.Width * 0.99 - Self.Width - dor_h_n_bugs.Width - Parent.Width * 0.015
                  Y: =Parent.Height/2 - Self.Height/2
            - dor_h_n_user:
                Control: Image
                Properties:
                  Image: |
                    =If(IsBlankOrError(User().Image), gblAppIcons.Employee, User().Image)
                  LayoutMinHeight: =1
                  LayoutMinWidth: =1
                  RadiusBottomLeft: =Self.Height / 2
                  RadiusBottomRight: =Self.Height / 2
                  RadiusTopLeft: =Self.Height / 2
                  RadiusTopRight: =Self.Height / 2
                  Width: =Self.Height
    - dor_body:
        Control: GroupContainer
        Variant: horizontalAutoLayoutContainer
        Properties:
          AlignInContainer: =AlignInContainer.SetByContainer
          DropShadow: =DropShadow.None
          FillPortions: =15
          LayoutAlignItems: =LayoutAlignItems.Stretch
          LayoutMinHeight: =10
          LayoutMinWidth: =10
          LayoutMode: =LayoutMode.Auto
          RadiusBottomLeft: =0
          RadiusBottomRight: =0
          RadiusTopLeft: =0
          RadiusTopRight: =0
        Children:
        - dor_nav:
            Control: GroupContainer
            Variant: horizontalAutoLayoutContainer
            Properties:
              AlignInContainer: =AlignInContainer.SetByContainer
              DropShadow: =DropShadow.None
              Fill: =varColor3
              LayoutAlignItems: =LayoutAlignItems.Stretch
              LayoutDirection: =LayoutDirection.Vertical
              LayoutGap: =varPadding
              LayoutMinHeight: =10
              LayoutMinWidth: =10
              LayoutMode: =LayoutMode.Auto
              PaddingBottom: =varPadding
              PaddingLeft: =varPadding
              PaddingRight: =varPadding
              PaddingTop: =varPadding
              RadiusBottomLeft: =0
              RadiusBottomRight: =0
              RadiusTopLeft: =0
              RadiusTopRight: =0
            Children:
            - dor_n_title:
                Control: Text
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  Size: =Self.Height / 3
                  Text: =App.ActiveScreen.Name
                  VerticalAlign: ='TextCanvas.VerticalAlign'.Middle
                  Weight: ='TextCanvas.Weight'.Semibold
                  FillPortions: =1
            - dor_n_seperator:
                Control: Rectangle
                Properties:
                  Height: =1
                  Width: =Parent.Width * 0.95
            - dor_n_gallery:
                Control: Gallery
                Variant: galleryVertical
                Properties:
                  Items: =collectNavigation
                  DelayItemLoading: =true
                  FillPortions: =13
                  Layout: =Layout.Vertical
                  LayoutMinHeight: =1
                  LayoutMinWidth: =1
                  LoadingSpinner: =LoadingSpinner.Data
                  ShowScrollbar: =false
                  TemplatePadding: =0
                  TemplateSize: =(Self.Height - ((Self.AllItemsCount+1) * Self.TemplatePadding)) / Self.AllItemsCount
                Children:
                - dor_n_button:
                    Control: Classic/Button
                    Properties:
                      OnSelect: =Navigate(ThisItem.ScreenName);
                      Text: =ThisItem.Title
                      Color: =varColor0
                      DisplayMode: =If(App.ActiveScreen = ThisItem.ScreenName, DisplayMode.Disabled, DisplayMode.Edit)
                      Fill: =varColorAccent
                      FontWeight: =FontWeight.Normal
                      Height: =Parent.TemplateHeight - varPadding
                      Size: =Self.Width / 16
                      Width: =Parent.TemplateWidth - Self.BorderThickness
                      X: =Center(Parent.TemplateWidth, Self.Width)
                      Y: =Center(Parent.TemplateHeight, Self.Height)
            - dor_n_footer:
                Control: GroupContainer
                Variant: manualLayoutContainer
                Properties:
                  AlignInContainer: =AlignInContainer.SetByContainer
                  DropShadow: =DropShadow.None
                  FillPortions: =2
                  LayoutMinHeight: =1
                  LayoutMinWidth: =1
                  RadiusBottomLeft: =0
                  RadiusBottomRight: =0
                  RadiusTopLeft: =0
                  RadiusTopRight: =0
                Children:
                - dor_n_f_text:
                    Control: Text
                    Properties:
                      Align: ='TextCanvas.Align'.Center
                      Size: =8
                      Text: ="MilliporeSigma is the U.S. and Canada Life Science business of Merck KGaA, Darmstadt, Germany."
                      VerticalAlign: ='TextCanvas.VerticalAlign'.Bottom
                      Height: =Parent.Height
                      Width: =Parent.Width
        - dor_main:
            Control: GroupContainer
            Variant: horizontalAutoLayoutContainer
            Properties:
              AlignInContainer: =AlignInContainer.SetByContainer
              DropShadow: =DropShadow.None
              FillPortions: =11
              LayoutAlignItems: =LayoutAlignItems.Stretch
              LayoutGap: =varPadding
              LayoutMinHeight: =10
              LayoutMinWidth: =10
              LayoutMode: =LayoutMode.Auto
              PaddingBottom: =varPadding
              PaddingLeft: =varPadding
              PaddingRight: =varPadding
              PaddingTop: =varPadding
              RadiusBottomLeft: =0
              RadiusBottomRight: =0
              RadiusTopLeft: =0
              RadiusTopRight: =0
            Children:
            - dor_section_0:
                Control: GroupContainer
                Variant: verticalAutoLayoutContainer
                Properties:
                  AlignInContainer: =AlignInContainer.SetByContainer
                  DropShadow: =DropShadow.None
                  LayoutAlignItems: =LayoutAlignItems.Center
                  LayoutDirection: =LayoutDirection.Vertical
                  LayoutGap: =varPadding
                  LayoutMinHeight: =10
                  LayoutMinWidth: =10
                  LayoutMode: =LayoutMode.Auto
                  LayoutOverflowY: =LayoutOverflow.Scroll
                  PaddingLeft: =varPadding
                  PaddingRight: =varPadding
                  PaddingTop: =varPadding
                  RadiusBottomLeft: =0
                  RadiusBottomRight: =0
                  RadiusTopLeft: =0
                  RadiusTopRight: =0
                Children:
                - dor_section_1:
                    Control: GroupContainer
                    Variant: verticalAutoLayoutContainer
                    Properties:
                      AlignInContainer: =AlignInContainer.Center
                      Fill: =varColor1
                      FillPortions: =0
                      Height: =DOR.Width * 0.030
                      LayoutAlignItems: =LayoutAlignItems.Stretch
                      LayoutGap: =varPadding
                      LayoutMode: =LayoutMode.Auto
                      Width: =If(App.ActiveScreen.Width < 1500, Parent.Width * 0.80, Parent.Width * 0.55)
                    Children:
                    - dor_date_title:
                        Control: Text
                        Properties:
                          Align: ='TextCanvas.Align'.End
                          FontColor: =varColor5
                          Size: =Self.Height / 3
                          Text: ="Summary Date:"
                          FillPortions: =1
                          LayoutMinHeight: =10
                          LayoutMinWidth: =10
                    - dor_date:
                        Control: DatePicker
                        Properties:
                          OnChange: |-
                            =Set(varDORDate, Self.SelectedDate);
                            Select(dor_collect);
                          FontSize: =Self.Height / 3
                          SelectedDate: =varNowDay
                          AlignInContainer: =AlignInContainer.Center
                          FillPortions: =1
                          Height: =Parent.Height * 0.90
                          LayoutMinHeight: =10
                          LayoutMinWidth: =10
                    - dor_seperator_0:
                        Control: Rectangle
                        Properties:
                          AlignInContainer: =AlignInContainer.Center
                          Fill: =varColor5
                          Height: =Parent.Height * 0.80
                          LayoutMinWidth: =10
                          Width: =1
                    - dor_week_title:
                        Control: Text
                        Properties:
                          Align: ='TextCanvas.Align'.End
                          FontColor: =varColor5
                          Size: =Self.Height / 3
                          Text: ="Week:"
                          VerticalAlign: ='TextCanvas.VerticalAlign'.Middle
                          Weight: ='TextCanvas.Weight'.Regular
                          FillPortions: =1
                          LayoutMinHeight: =10
                          LayoutMinWidth: =10
                    - dor_week:
                        Control: Text
                        Properties:
                          Align: ='TextCanvas.Align'.Start
                          FontColor: =varColor5
                          Size: =Self.Height / 3
                          Text: =WeekNum(dor_date.SelectedDate)
                          Weight: ='TextCanvas.Weight'.Regular
                          FillPortions: =1
                          LayoutMinHeight: =10
                          LayoutMinWidth: =10
                - dor_section_2:
                    Control: GroupContainer
                    Variant: verticalAutoLayoutContainer
                    Properties:
                      AlignInContainer: =AlignInContainer.Center
                      Fill: =varColor4
                      FillPortions: =0
                      Height: =DOR.Width * 0.025
                      LayoutAlignItems: =LayoutAlignItems.Stretch
                      LayoutMode: =LayoutMode.Auto
                      Width: =If(App.ActiveScreen.Width < 1500, Parent.Width * 0.80, Parent.Width * 0.55)
                    Children:
                    - dor_verifications_title:
                        Control: Text
                        Properties:
                          Align: ='TextCanvas.Align'.Center
                          Size: =Self.Height / 3
                          Text: ="Content Verified"
                          FillPortions: =2
                          LayoutMinHeight: =10
                          LayoutMinWidth: '=10  '
                    - dor_submission_seperator_0:
                        Control: Rectangle
                        Properties:
                          AlignInContainer: =AlignInContainer.Center
                          Height: =Parent.Height * 0.80
                          Width: =1
                    - dor_c_verified_title:
                        Control: Text
                        Properties:
                          Align: ='TextCanvas.Align'.End
                          Size: =Self.Height / 2.5
                          Text: ="C Shift:"
                          VerticalAlign: ='TextCanvas.VerticalAlign'.Middle
                          Weight: ='TextCanvas.Weight'.Regular
                          FillPortions: =1
                          LayoutMinHeight: =10
                          LayoutMinWidth: '=10  '
                    - dor_c_verified:
                        Control: Classic/Icon
                        Variant: Check
                        Properties:
                          OnSelect: |-
                            =If(
                                !LookUp(locDORFilter, Shift.Value = "C").Is_Verified,
                                Set(varDORShift, "C");
                                Navigate(Verify);,
                                false
                            )
                          Color: |-
                            =If(
                                Self.Icon = Icon.Check,
                                varColorYes,
                                varColorNo
                            )
                          FillPortions: =1
                          Icon: |-
                            =If(
                                LookUp(locDORFilter, Shift.Value = "C").Is_Verified = true,
                                Icon.Check,
                                Icon.Save
                            )
                          LayoutMinHeight: =10
                          LayoutMinWidth: =10
                          PaddingBottom: =varPadding/2
                          PaddingTop: =varPadding/2
                    - dor_submission_seperator_1:
                        Control: Rectangle
                        Properties:
                          AlignInContainer: =AlignInContainer.Center
                          Height: =Parent.Height * 0.80
                          LayoutMinHeight: =10
                          Width: =1
                    - dor_a_verified_title:
                        Control: Text
                        Properties:
                          Align: ='TextCanvas.Align'.End
                          Size: =Self.Height / 2.5
                          Text: ="A Shift:"
                          VerticalAlign: ='TextCanvas.VerticalAlign'.Middle
                          Weight: ='TextCanvas.Weight'.Regular
                          FillPortions: =1
                          LayoutMinHeight: =10
                          LayoutMinWidth: '=10  '
                    - dor_a_verified:
                        Control: Classic/Icon
                        Variant: Check
                        Properties:
                          OnSelect: |-
                            =If(
                                !LookUp(locDORFilter, Shift.Value = "A").Is_Verified,
                                Set(varDORShift, "A");
                                Navigate(Verify);,
                                false
                            )
                          Color: |-
                            =If(
                                Self.Icon = Icon.Check,
                                varColorYes,
                                varColorNo
                            )
                          FillPortions: =1
                          Icon: |-
                            =If(
                                LookUp(locDORFilter, Shift.Value = "A").Is_Verified = true,
                                Icon.Check,
                                Icon.Save
                            )
                          LayoutMinHeight: =10
                          LayoutMinWidth: =10
                          PaddingBottom: =varPadding/2
                          PaddingTop: =varPadding/2
                    - dor_submission_seperator_2:
                        Control: Rectangle
                        Properties:
                          AlignInContainer: =AlignInContainer.Center
                          Height: =Parent.Height * 0.80
                          LayoutMinHeight: =10
                          Width: =1
                    - dor_b_verified_title:
                        Control: Text
                        Properties:
                          Align: ='TextCanvas.Align'.End
                          Size: =Self.Height / 2.5
                          Text: ="B Shift:"
                          VerticalAlign: ='TextCanvas.VerticalAlign'.Middle
                          Weight: ='TextCanvas.Weight'.Regular
                          FillPortions: =1
                          LayoutMinHeight: =10
                          LayoutMinWidth: '=10  '
                    - dor_b_verified:
                        Control: Classic/Icon
                        Variant: Check
                        Properties:
                          OnSelect: |-
                            =If(
                                !LookUp(locDORFilter, Shift.Value = "B").Is_Verified,
                                Set(varDORShift, "B");
                                Navigate(Verify);,
                                false
                            )
                          Color: |-
                            =If(
                                Self.Icon = Icon.Check,
                                varColorYes,
                                varColorNo
                            )
                          FillPortions: =1
                          Icon: |-
                            =If(
                                LookUp(locDORFilter, Shift.Value = "B").Is_Verified = true,
                                Icon.Check,
                                Icon.Save
                            )
                          LayoutMinHeight: =10
                          LayoutMinWidth: =10
                          PaddingBottom: =varPadding/2
                          PaddingTop: =varPadding/2
                - dor_section_3:
                    Control: GroupContainer
                    Variant: verticalAutoLayoutContainer
                    Properties:
                      AlignInContainer: =AlignInContainer.Center
                      Fill: =RGBA(0,0,0,0)
                      FillPortions: =0
                      Height: =DOR.Width * 0.25
                      LayoutAlignItems: =LayoutAlignItems.Stretch
                      LayoutDirection: =LayoutDirection.Vertical
                      LayoutMode: =LayoutMode.Auto
                      Width: =If(App.ActiveScreen.Width < 1500, Parent.Width * 0.80, Parent.Width * 0.55)
                    Children:
                    - dor_overall_title:
                        Control: Label
                        Properties:
                          Text: ="Overall Summary"
                          Align: =Align.Center
                          Color: =varColor5
                          Fill: =varColor2
                          Size: =Self.Height / 2.5
                    - dor_overall_target_parent:
                        Control: GroupContainer
                        Variant: verticalAutoLayoutContainer
                        Properties:
                          DropShadow: =DropShadow.None
                          LayoutAlignItems: =LayoutAlignItems.Stretch
                          LayoutGap: =varPadding
                          LayoutMinHeight: =10
                          LayoutMinWidth: =10
                          LayoutMode: =LayoutMode.Auto
                          PaddingBottom: =varPadding/2
                          PaddingLeft: =varPadding/2
                          PaddingRight: =varPadding/2
                          PaddingTop: =varPadding/2
                          RadiusBottomLeft: =0
                          RadiusBottomRight: =0
                          RadiusTopLeft: =0
                          RadiusTopRight: =0
                        Children:
                        - dor_output_ssc_parent:
                            Control: GroupContainer
                            Variant: verticalAutoLayoutContainer
                            Properties:
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              LayoutMode: =LayoutMode.Auto
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                            Children:
                            - dor_output_ssc_title:
                                Control: Label
                                Properties:
                                  Text: ="SSC Output"
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =varColor3
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4
                            - dor_output_ssc:
                                Control: Label
                                Properties:
                                  Text: =First(collectDOR).SSC_Output*1
                                  Align: =Align.Center
                                  Color: =varColor5
                                  Fill: =If(First(collectOEE2).SSC_Target <= First(collectDOR).SSC_Output, varColorYes, varColorNo)
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4.5
                            - dor_target_ssc_title:
                                Control: Label
                                Properties:
                                  Text: ="OEE2 Target"
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =varColor3
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4
                            - dor_target_ssc:
                                Control: Label
                                Properties:
                                  Text: =Round(First(collectOEE2).SSC_Target,0)
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =RGBA(0,0,0,0)
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4.5
                        - dor_output_xl_parent:
                            Control: GroupContainer
                            Variant: verticalAutoLayoutContainer
                            Properties:
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              LayoutMode: =LayoutMode.Auto
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                            Children:
                            - dor_output_xl_title:
                                Control: Label
                                Properties:
                                  Text: ="XL Output"
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =varColor3
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4
                            - dor_output_xl:
                                Control: Label
                                Properties:
                                  Text: =First(collectDOR).XL_Output*1
                                  Align: =Align.Center
                                  Color: =varColor5
                                  Fill: =If(First(collectOEE2).XL_Target <= First(collectDOR).XL_Output, varColorYes, varColorNo)
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4.5
                            - dor_target_xl_title:
                                Control: Label
                                Properties:
                                  Text: ="OEE2 Target"
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =varColor3
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4
                            - dor_target_xl:
                                Control: Label
                                Properties:
                                  Text: =Round(First(collectOEE2).XL_Target,0)
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =RGBA(0,0,0,0)
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4.5
                        - dor_output_xlt_parent:
                            Control: GroupContainer
                            Variant: verticalAutoLayoutContainer
                            Properties:
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              LayoutMode: =LayoutMode.Auto
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                            Children:
                            - dor_output_xlt_title:
                                Control: Label
                                Properties:
                                  Text: ="XLT Output"
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =varColor3
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4
                            - dor_output_xlt:
                                Control: Label
                                Properties:
                                  Text: =First(collectDOR).XLT_Output*1
                                  Align: =Align.Center
                                  Color: =varColor5
                                  Fill: =If(First(collectOEE2).XLT_Target <= First(collectDOR).XLT_Output, varColorYes, varColorNo)
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4.5
                            - dor_target_xlt_title:
                                Control: Label
                                Properties:
                                  Text: ="OEE2 Target"
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =varColor3
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4
                            - dor_target_xlt:
                                Control: Label
                                Properties:
                                  Text: =Round(First(collectOEE2).XLT_Target,0)
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =RGBA(0,0,0,0)
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4.5
                        - dor_output_safety_parent:
                            Control: GroupContainer
                            Variant: verticalAutoLayoutContainer
                            Properties:
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              LayoutMode: =LayoutMode.Auto
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                            Children:
                            - dor_output_miss_title:
                                Control: Label
                                Properties:
                                  Text: |-
                                    ="Safety
                                    Near Misses"
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =varColor3
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 3.5
                            - dor_output_miss:
                                Control: Label
                                Properties:
                                  Text: =First(collectDOR).Near_Miss*1
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =RGBA(0,0,0,0)
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 3
                            - dor_target_aid_title:
                                Control: Label
                                Properties:
                                  Text: ="Safety First Aid"
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =varColor3
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 3.5
                            - dor_target_aid:
                                Control: Label
                                Properties:
                                  Text: =First(collectDOR).First_Aid*1
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =RGBA(0,0,0,0)
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 3
                            - dor_target_incident_title:
                                Control: Label
                                Properties:
                                  Text: ="Safety Incidents"
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =varColor3
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 3.5
                            - dor_target_incident:
                                Control: Label
                                Properties:
                                  Text: =First(collectDOR).Incidents*1
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =RGBA(0,0,0,0)
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 3
                        - dor_output_quality_parent:
                            Control: GroupContainer
                            Variant: verticalAutoLayoutContainer
                            Properties:
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              LayoutMode: =LayoutMode.Auto
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                            Children:
                            - dor_output_roe_title:
                                Control: Label
                                Properties:
                                  Text: ="ROEs"
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =varColor3
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4
                            - dor_output_roe:
                                Control: Label
                                Properties:
                                  Text: =First(collectDOR).ROEs*1
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =RGBA(0,0,0,0)
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4.5
                            - dor_target_deviations_title:
                                Control: Label
                                Properties:
                                  Text: ="Deviations"
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =varColor3
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4
                            - dor_target_deviations:
                                Control: Label
                                Properties:
                                  Text: =First(collectDOR).Deviations*1
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =RGBA(0,0,0,0)
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4.5
                        - dor_output_proactive_parent:
                            Control: GroupContainer
                            Variant: verticalAutoLayoutContainer
                            Properties:
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              LayoutMode: =LayoutMode.Auto
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                            Children:
                            - dor_output_stretches_title:
                                Control: Label
                                Properties:
                                  Text: ="Proactive Stretches"
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =varColor3
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4
                            - dor_output_stretches:
                                Control: Label
                                Properties:
                                  Text: =First(collectDOR).Stretches*1
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =RGBA(0,0,0,0)
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4.5
                            - dor_target_exercises_title:
                                Control: Label
                                Properties:
                                  Text: ="Proactive Extercises"
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =varColor3
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4
                            - dor_target_exercises:
                                Control: Label
                                Properties:
                                  Text: =First(collectDOR).Excercises*1
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =RGBA(0,0,0,0)
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4.5
                    - dor_overall_productivity_parent:
                        Control: GroupContainer
                        Variant: verticalAutoLayoutContainer
                        Properties:
                          DropShadow: =DropShadow.None
                          LayoutAlignItems: =LayoutAlignItems.Stretch
                          LayoutGap: =varPadding
                          LayoutMinHeight: =10
                          LayoutMinWidth: =10
                          LayoutMode: =LayoutMode.Auto
                          PaddingBottom: =varPadding/2
                          PaddingLeft: =varPadding/2
                          PaddingRight: =varPadding/2
                          RadiusBottomLeft: =0
                          RadiusBottomRight: =0
                          RadiusTopLeft: =0
                          RadiusTopRight: =0
                        Children:
                        - dor_output_oee_parent:
                            Control: GroupContainer
                            Variant: verticalAutoLayoutContainer
                            Properties:
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              LayoutMode: =LayoutMode.Auto
                            Children:
                            - dor_output_xl_title_7:
                                Control: Label
                                Properties:
                                  Text: ="Overall OEE"
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =varColor4
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4
                            - dor_output_xl_7:
                                Control: Label
                                Properties:
                                  Text: =Round(First(collectOEE2).OEE2,0) & "%"
                                  Align: =Align.Center
                                  Color: =varColor5
                                  Fill: =If(First(collectOEE2).OEE2 >= First(collectDOR).OEE_Target, varColorYes, varColorNo)
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4.5
                            - dor_target_xl_title_7:
                                Control: Label
                                Properties:
                                  Text: ="Target OEE"
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =varColor4
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4
                            - dor_target_xl_7:
                                Control: Label
                                Properties:
                                  Text: =First(collectDOR).OEE_Target & "%"
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =RGBA(0,0,0,0)
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4.5
                        - dor_output_productivity_parent:
                            Control: GroupContainer
                            Variant: verticalAutoLayoutContainer
                            Properties:
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              LayoutMode: =LayoutMode.Auto
                            Children:
                            - dor_output_xl_title_6:
                                Control: Label
                                Properties:
                                  Text: ="Total Output"
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =varColor4
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4
                            - dor_output_xl_6:
                                Control: Label
                                Properties:
                                  Text: =First(collectOEE2).total & " units"
                                  Align: =Align.Center
                                  Color: =varColor5
                                  Fill: =If(First(collectOEE2).total >= First(collectOEE2).constraint_goal, varColorYes, varColorNo)
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4.5
                            - dor_target_xl_title_6:
                                Control: Label
                                Properties:
                                  Text: ="Total Output OEE2 Target"
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =varColor4
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4
                            - dor_target_xl_6:
                                Control: Label
                                Properties:
                                  Text: =Round(First(collectOEE2).constraint_goal,0) & " units"
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =RGBA(0,0,0,0)
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4.5
                        - dor_output_downtime_parent:
                            Control: GroupContainer
                            Variant: verticalAutoLayoutContainer
                            Properties:
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              LayoutMode: =LayoutMode.Auto
                            Children:
                            - dor_output_xl_title_5:
                                Control: Label
                                Properties:
                                  Text: ="Total Downtime"
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =varColor4
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4
                            - dor_output_xl_5:
                                Control: Label
                                Properties:
                                  Text: =Round(First(collectOEE2).downtime_total,0) & " Minutes"
                                  Align: =Align.Center
                                  Color: =varColor5
                                  Fill: =If(First(collectOEE2).downtime_total <= First(collectDOR).Downtime_Allowance, varColorYes, varColorNo)
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4.5
                            - dor_target_xl_title_5:
                                Control: Label
                                Properties:
                                  Text: ="Downtime Allowance"
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =varColor4
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4
                            - dor_target_xl_5:
                                Control: Label
                                Properties:
                                  Text: =First(collectDOR).Downtime_Allowance & " Minutes"
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =RGBA(0,0,0,0)
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4.5
                        - dor_output_yield_parent:
                            Control: GroupContainer
                            Variant: verticalAutoLayoutContainer
                            Properties:
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              LayoutMode: =LayoutMode.Auto
                            Children:
                            - dor_output_xl_title_8:
                                Control: Label
                                Properties:
                                  Text: ="Yield"
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =varColor4
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4
                            - dor_output_xl_8:
                                Control: Label
                                Properties:
                                  Text: =First(collectOEE2).yield & "%"
                                  Align: =Align.Center
                                  Color: =varColor5
                                  Fill: =If(First(collectOEE2).yield >= First(collectDOR).Target_Yield, varColorYes, varColorNo)
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4.5
                            - dor_target_xl_title_8:
                                Control: Label
                                Properties:
                                  Text: ="Target Yield"
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =varColor4
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4
                            - dor_target_xl_8:
                                Control: Label
                                Properties:
                                  Text: =First(collectDOR).Target_Yield & "%"
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =RGBA(0,0,0,0)
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4.5
                        - dor_output_yield_parent_1:
                            Control: GroupContainer
                            Variant: verticalAutoLayoutContainer
                            Properties:
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              LayoutMode: =LayoutMode.Auto
                            Children:
                            - dor_output_xl_title_9:
                                Control: Label
                                Properties:
                                  Text: ="Labor Efficency"
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =varColor4
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4
                            - dor_output_xl_9:
                                Control: Label
                                Properties:
                                  Text: =IfError(Round(First(collectOEE2).total / First(collectDOR).Total_Labor_Hours, 3),0)
                                  Align: =Align.Center
                                  Color: =varColor5
                                  Fill: =If(IfError(Round(First(collectOEE2).total / First(collectDOR).Total_Labor_Hours, 3),0) >= First(collectDOR).Target_Labor, varColorYes, varColorNo)
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4.5
                            - dor_target_xl_title_9:
                                Control: Label
                                Properties:
                                  Text: ="Efficency Target"
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =varColor4
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4
                            - dor_target_xl_9:
                                Control: Label
                                Properties:
                                  Text: =First(collectDOR).Target_Labor*1
                                  Align: =Align.Center
                                  Color: =varColor0
                                  Fill: =RGBA(0,0,0,0)
                                  FillPortions: =1
                                  LayoutMinHeight: =5
                                  LayoutMinWidth: =5
                                  Size: =Self.Height / 4.5
                - dor_section_4:
                    Control: GroupContainer
                    Variant: verticalAutoLayoutContainer
                    Properties:
                      AlignInContainer: =AlignInContainer.Center
                      Fill: =RGBA(0,0,0,0)
                      FillPortions: =0
                      Height: =DOR.Width * 0.40
                      LayoutAlignItems: =LayoutAlignItems.Stretch
                      LayoutDirection: =LayoutDirection.Vertical
                      LayoutGap: =varPadding
                      LayoutMode: =LayoutMode.Auto
                      Width: =If(App.ActiveScreen.Width < 1500, Parent.Width * 0.80, Parent.Width * 0.55)
                    Children:
                    - dor_summary_title_1:
                        Control: Label
                        Properties:
                          Text: ="Summary by Line"
                          Align: =Align.Center
                          Color: =varColor5
                          Fill: =varColor2
                          Size: =Self.Height / 2.5
                    - dor_summary:
                        Control: Gallery
                        Variant: BrowseLayout_Horizontal_TwoTextOneImageVariant_ver5.0
                        Properties:
                          Items: =["XL1","SSC","XL2","SSC2","XL3","XLT","XL4","XLT2","XL5","XLT3"]
                          WrapCount: =2
                          DelayItemLoading: =true
                          LayoutMinHeight: =10
                          LayoutMinWidth: =10
                          LoadingSpinner: =LoadingSpinner.Data
                          TemplatePadding: =0
                          TemplateSize: =Self.Width/5
                        Children:
                        - dor_s_parent:
                            Control: GroupContainer
                            Variant: verticalAutoLayoutContainer
                            Properties:
                              DropShadow: =DropShadow.None
                              Height: =Parent.TemplateHeight
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutMode: =LayoutMode.Auto
                              PaddingBottom: =varPadding
                              PaddingLeft: =varPadding
                              PaddingRight: =varPadding
                              PaddingTop: =varPadding
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                              Width: =Parent.TemplateWidth
                            Children:
                            - dor_s_title:
                                Control: Label
                                Properties:
                                  Text: =ThisItem.Value
                                  Align: =Align.Center
                                  BorderColor: =RGBA(0, 0, 0, 1)
                                  Color: =varColor5
                                  Fill: =varColor3
                                  FontWeight: =FontWeight.Bold
                                  Height: =dor_summary.TemplateHeight * 0.10
                                  LayoutMinWidth: =10
                                  PaddingBottom: =0
                                  PaddingLeft: =0
                                  PaddingRight: =0
                                  PaddingTop: =0
                                  Size: =Self.Height / 2
                                  Width: =Parent.Width
                            - dor_s_labor_title:
                                Control: Label
                                Properties:
                                  Text: ="Labor Hours"
                                  Align: =Align.Center
                                  BorderColor: =RGBA(0, 0, 0, 1)
                                  Color: =varColor0
                                  Fill: =varColor4
                                  FillPortions: =1
                                  Height: =dor_summary.TemplateHeight * 0.10
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: =10
                                  PaddingBottom: =0
                                  PaddingLeft: =0
                                  PaddingRight: =0
                                  PaddingTop: =0
                                  Size: =Self.Height / 2.5
                                  Width: =Parent.Width
                            - dor_s_labor:
                                Control: Label
                                Properties:
                                  Text: =LookUp(collectLaborHours, Line = ThisItem.Value).Value*1
                                  Align: =Align.Center
                                  BorderColor: =RGBA(0, 0, 0, 1)
                                  Color: =varColor0
                                  Fill: =varColor5
                                  FillPortions: =1
                                  Height: =dor_summary.TemplateHeight * 0.10
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: =10
                                  PaddingBottom: =0
                                  PaddingLeft: =0
                                  PaddingRight: =0
                                  PaddingTop: =0
                                  Size: =Self.Height / 3
                                  Width: =Parent.Width
                            - dor_s_oee_title:
                                Control: Label
                                Properties:
                                  Text: ="OEE2"
                                  Align: =Align.Center
                                  BorderColor: =RGBA(0, 0, 0, 1)
                                  Color: =varColor0
                                  Fill: =varColor4
                                  FillPortions: =1
                                  Height: =dor_summary.TemplateHeight * 0.10
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: =10
                                  PaddingBottom: =0
                                  PaddingLeft: =0
                                  PaddingRight: =0
                                  PaddingTop: =0
                                  Size: =Self.Height / 2.5
                                  Width: =Parent.Width
                            - dor_s_oee:
                                Control: Label
                                Properties:
                                  Text: =LookUp(collectLineOEE, line = ThisItem.Value).OEE2 & "%"
                                  Align: =Align.Center
                                  BorderColor: =RGBA(0, 0, 0, 1)
                                  Color: =varColor0
                                  Fill: =varColor5
                                  FillPortions: =1
                                  Height: =dor_summary.TemplateHeight * 0.10
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: =10
                                  PaddingBottom: =0
                                  PaddingLeft: =0
                                  PaddingRight: =0
                                  PaddingTop: =0
                                  Size: =Self.Height / 3
                                  Width: =Parent.Width
                            - dor_s_output_title:
                                Control: Label
                                Properties:
                                  Text: ="Output"
                                  Align: =Align.Center
                                  BorderColor: =RGBA(0, 0, 0, 1)
                                  Color: =varColor0
                                  Fill: =varColor4
                                  FillPortions: =1
                                  Height: =dor_summary.TemplateHeight * 0.10
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: =10
                                  PaddingBottom: =0
                                  PaddingLeft: =0
                                  PaddingRight: =0
                                  PaddingTop: =0
                                  Size: =Self.Height / 2.5
                                  Width: =Parent.Width
                            - dor_s_output:
                                Control: Label
                                Properties:
                                  Text: =LookUp(collectLineOEE, line = ThisItem.Value).total*1 & " / " & LookUp(collectLineOEE, line = ThisItem.Value).constraint_goal*1
                                  Align: =Align.Center
                                  BorderColor: =RGBA(0, 0, 0, 1)
                                  Color: =varColor0
                                  Fill: =varColor5
                                  FillPortions: =1
                                  Height: =dor_summary.TemplateHeight * 0.10
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: =10
                                  PaddingBottom: =0
                                  PaddingLeft: =0
                                  PaddingRight: =0
                                  PaddingTop: =0
                                  Size: =Self.Height / 3
                                  Width: =Parent.Width
                            - dor_s_yeild_title:
                                Control: Label
                                Properties:
                                  Text: ="Yield"
                                  Align: =Align.Center
                                  BorderColor: =RGBA(0, 0, 0, 1)
                                  Color: =varColor0
                                  Fill: =varColor4
                                  FillPortions: =1
                                  Height: =dor_summary.TemplateHeight * 0.10
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: =10
                                  PaddingBottom: =0
                                  PaddingLeft: =0
                                  PaddingRight: =0
                                  PaddingTop: =0
                                  Size: =Self.Height / 2.5
                                  Width: =Parent.Width
                            - dor_s_yield:
                                Control: Label
                                Properties:
                                  Text: =LookUp(collectLineOEE, line = ThisItem.Value).output*1 & " / " & LookUp(collectLineOEE, line = ThisItem.Value).total*1
                                  Align: =Align.Center
                                  BorderColor: =RGBA(0, 0, 0, 1)
                                  Color: =varColor0
                                  Fill: =varColor5
                                  FillPortions: =1
                                  Height: =dor_summary.TemplateHeight * 0.10
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: =10
                                  PaddingBottom: =0
                                  PaddingLeft: =0
                                  PaddingRight: =0
                                  PaddingTop: =0
                                  Size: =Self.Height / 3
                                  Width: =Parent.Width
                            - dor_s_downtime_title:
                                Control: Label
                                Properties:
                                  Text: ="Downtime"
                                  Align: =Align.Center
                                  BorderColor: =RGBA(0, 0, 0, 1)
                                  Color: =varColor0
                                  Fill: =varColor4
                                  FillPortions: =1
                                  Height: =dor_summary.TemplateHeight * 0.10
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: =10
                                  PaddingBottom: =0
                                  PaddingLeft: =0
                                  PaddingRight: =0
                                  PaddingTop: =0
                                  Size: =Self.Height / 2.5
                                  Width: =Parent.Width
                            - dor_s_downtime:
                                Control: Label
                                Properties:
                                  Text: =LookUp(collectLineOEE, line = ThisItem.Value).downtime_total & " Minutes"
                                  Align: =Align.Center
                                  BorderColor: =RGBA(0, 0, 0, 1)
                                  Color: =varColor0
                                  Fill: =varColor5
                                  FillPortions: =1
                                  Height: =dor_summary.TemplateHeight * 0.10
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: =10
                                  PaddingBottom: =0
                                  PaddingLeft: =0
                                  PaddingRight: =0
                                  PaddingTop: =0
                                  Size: =Self.Height / 3
                                  Width: =Parent.Width
                - dor_section_5:
                    Control: GroupContainer
                    Variant: verticalAutoLayoutContainer
                    Properties:
                      AlignInContainer: =AlignInContainer.Center
                      Fill: =RGBA(0,0,0,0)
                      FillPortions: =0
                      Height: =DOR.Width
                      LayoutAlignItems: =LayoutAlignItems.Stretch
                      LayoutDirection: =LayoutDirection.Vertical
                      LayoutMode: =LayoutMode.Auto
                      Width: =If(App.ActiveScreen.Width < 1500, Parent.Width * 0.80, Parent.Width * 0.55)
                    Children:
                    - dor_losses_title:
                        Control: Label
                        Properties:
                          Text: ="Key Losses"
                          Align: =Align.Center
                          Color: =varColor5
                          Fill: =varColor2
                          Size: =Self.Height / 2.5
                    - dor_losses:
                        Control: Gallery
                        Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                        Properties:
                          Items: =["SSC","SSC2","XL1","XL2","XL3","XL4","XL5","XLT","XLT2","XLT3"]
                          DelayItemLoading: =true
                          Layout: =Layout.Vertical
                          LayoutMinHeight: =10
                          LayoutMinWidth: =10
                          LoadingSpinner: =LoadingSpinner.Data
                          TemplatePadding: =0
                          TemplateSize: =Self.Height / 10
                        Children:
                        - dor_l_separator:
                            Control: Rectangle
                            Properties:
                              OnSelect: =Select(Parent)
                              Fill: =varColor1
                              Height: =locPadding
                              Width: =Parent.TemplateWidth
                              Y: =Parent.TemplateHeight - Self.Height
                        - dor_l_title:
                            Control: Label
                            Properties:
                              OnSelect: =Select(Parent)
                              Text: =ThisItem.Value
                              Align: =Align.Center
                              BorderColor: =RGBA(0, 0, 0, 1)
                              Color: =RGBA(50, 49, 48, 1)
                              Fill: =varColor3
                              Height: =Parent.TemplateHeight - dor_l_separator.Height
                              PaddingBottom: =0
                              PaddingLeft: =0
                              PaddingRight: =0
                              PaddingTop: =0
                              Size: =Self.Height / 8
                              Width: =Parent.TemplateWidth * 0.10
                        - dor_l_downtime:
                            Control: Label
                            Properties:
                              OnSelect: =Select(Parent)
                              Text: =LookUp(collectLineOEE, line = dor_l_title.Text).downtime_total & " Minutes"
                              Align: =Align.Center
                              BorderColor: =RGBA(0, 0, 0, 1)
                              Color: =RGBA(50, 49, 48, 1)
                              Fill: =varColor4
                              Height: =Parent.TemplateHeight - dor_l_separator.Height
                              PaddingBottom: =0
                              PaddingLeft: =0
                              PaddingRight: =0
                              PaddingTop: =0
                              Size: =Self.Height / 12
                              Width: =Parent.TemplateWidth * 0.10
                              X: =dor_l_title.Width
                        - dor_top_downtime:
                            Control: Gallery
                            Variant: galleryVertical
                            Properties:
                              Items: |-
                                =Sort(
                                    FirstN(
                                        Sort(Filter(collectTopDowntimePerLine, Line = dor_l_title.Text),Downtime_Total,SortOrder.Descending),
                                        6
                                    ),
                                    Downtime_Total,
                                    SortOrder.Descending
                                )
                              DelayItemLoading: =true
                              Height: =Parent.TemplateHeight - dor_l_separator.Height
                              Layout: =Layout.Vertical
                              LoadingSpinner: =LoadingSpinner.Data
                              TemplatePadding: =0
                              TemplateSize: =Self.Height / 6
                              Width: =Parent.TemplateWidth - Self.X
                              X: =dor_l_downtime.X + dor_l_downtime.Width
                            Children:
                            - dor_td_reason:
                                Control: Label
                                Properties:
                                  OnSelect: =Select(Parent)
                                  Text: =ThisItem.Downtime_Reason
                                  Align: =Align.Center
                                  Font: =Font.Verdana
                                  Height: =Parent.TemplateHeight - dor_td_separator.Height
                                  Size: =Self.Height / 2 - Len(Self.Text)/6
                                  Width: =dor_losses.TemplateWidth * 0.20
                                  X: =1-1
                                  Y: =1-1
                            - dor_td_amount:
                                Control: Label
                                Properties:
                                  OnSelect: =Select(Parent)
                                  Text: =RoundDown(ThisItem.Downtime_Total/60,0) & "H " & Mod(ThisItem.Downtime_Total,60) & "m"
                                  Align: =Align.Center
                                  Font: =Font.Verdana
                                  Height: =Parent.TemplateHeight - dor_td_separator.Height
                                  Size: =Self.Height / 2.5
                                  Width: =dor_losses.TemplateWidth * 0.10
                                  X: =dor_td_reason.X + dor_td_reason.Width
                                  Y: =1-1
                            - dor_td_comments:
                                Control: Label
                                Properties:
                                  OnSelect: =Select(Parent)
                                  Text: =ThisItem.Comments
                                  Font: =Font.Verdana
                                  Height: =Parent.TemplateHeight - dor_td_separator.Height
                                  LineHeight: =1
                                  Overflow: =Overflow.Scroll
                                  Size: =Self.Height / 3
                                  VerticalAlign: =VerticalAlign.Top
                                  Width: =Parent.TemplateWidth - Self.X
                                  X: =dor_td_amount.X + dor_td_amount.Width
                                  Y: =1-1
                            - dor_td_separator:
                                Control: Rectangle
                                Properties:
                                  OnSelect: =Select(Parent)
                                  Fill: =varColor1
                                  Height: =Parent.TemplateHeight * 0.025
                                  Width: =Parent.Width
                                  Y: =Parent.TemplateHeight - Self.Height
                - dor_section_6:
                    Control: GroupContainer
                    Variant: verticalAutoLayoutContainer
                    Properties:
                      AlignInContainer: =AlignInContainer.Center
                      Fill: =RGBA(0,0,0,0)
                      FillPortions: =0
                      Height: =DOR.Width * 0.20
                      LayoutAlignItems: =LayoutAlignItems.Stretch
                      LayoutDirection: =LayoutDirection.Vertical
                      LayoutMode: =LayoutMode.Auto
                      Width: =If(App.ActiveScreen.Width < 1500, Parent.Width * 0.80, Parent.Width * 0.55)
                    Children:
                    - dor_tieoff_title:
                        Control: Label
                        Properties:
                          Text: ="Tie-Off Communications"
                          Align: =Align.Center
                          Color: =varColor5
                          Fill: =varColor2
                          Size: =Self.Height / 2.5
                    - dor_tieoff_c_title:
                        Control: Label
                        Properties:
                          Text: ="C Shift"
                          Align: =Align.Center
                          Color: =varColor5
                          Fill: =varColor3
                          FillPortions: =1
                          LayoutMinHeight: =10
                          LayoutMinWidth: =10
                          Size: =Self.Height / 2.5
                    - dor_tieoff_c:
                        Control: Label
                        Properties:
                          Text: =First(collectDOR).C_Tie_Off
                          Color: =varColor0
                          Fill: =varColor5
                          FillPortions: =2
                          LayoutMinHeight: =10
                          LayoutMinWidth: =10
                          Overflow: =Overflow.Scroll
                          Size: =Self.Height / 5
                    - dor_tieoff_a_title:
                        Control: Label
                        Properties:
                          Text: ="A Shift"
                          Align: =Align.Center
                          Color: =varColor5
                          Fill: =varColor3
                          FillPortions: =1
                          LayoutMinHeight: =10
                          LayoutMinWidth: =10
                          Size: =Self.Height / 2.5
                    - dor_tieoff_a:
                        Control: Label
                        Properties:
                          Text: =First(collectDOR).A_Tie_Off
                          Color: =varColor0
                          Fill: =varColor5
                          FillPortions: =2
                          LayoutMinHeight: =10
                          LayoutMinWidth: =10
                          Overflow: =Overflow.Scroll
                          Size: =Self.Height / 5
                    - dor_tieoff_b_title:
                        Control: Label
                        Properties:
                          Text: ="B Shift"
                          Align: =Align.Center
                          Color: =varColor5
                          Fill: =varColor3
                          FillPortions: =1
                          LayoutMinHeight: =10
                          LayoutMinWidth: =10
                          Size: =Self.Height / 2.5
                    - dor_tieoff_b:
                        Control: Label
                        Properties:
                          Text: =First(collectDOR).B_Tie_Off
                          Color: =varColor0
                          Fill: =varColor5
                          FillPortions: =2
                          LayoutMinHeight: =10
                          LayoutMinWidth: =10
                          Overflow: =Overflow.Scroll
                          Size: =Self.Height / 5