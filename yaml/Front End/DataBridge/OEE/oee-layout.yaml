- oee-layout:
    Control: GroupContainer
    Variant: verticalAutoLayoutContainer
    Properties:
      DropShadow: =DropShadow.None
      Fill: =gTheme.Background
      Height: =Parent.Height
      LayoutAlignItems: =LayoutAlignItems.Stretch
      LayoutDirection: =LayoutDirection.Vertical
      LayoutMode: =LayoutMode.Auto
      RadiusBottomLeft: =0
      RadiusBottomRight: =0
      RadiusTopLeft: =0
      RadiusTopRight: =0
      Width: =Parent.Width
    Children:
    - oee-collect:
        Control: Classic/Button
        Properties:
          OnSelect: |-
            =/*Start*/
            Patch(rPopups,First(rPopups),{Visible: true, Value: 10, Display_Text: "Loading"});

            /*Capture Local Date Selection*/
            UpdateContext({
                lEndDate: 'oee-end-date'.SelectedDate,
                lStartDate: 'oee-start-date'.SelectedDate
            });

            Patch(rPopups,First(rPopups),{Value: 20, Display_Text:"Collecting Production Data"});
            /*Collect Production Data*/
            Clear(cProduction);
            ForAll(
                Filter(Sort(Roll_Data_Filtered_SPL, 'Date', SortOrder.Descending),
                    'Date' >= gTime.Today
                ),
                Collect(cProduction,
                    {
                        ID: ThisRecord.ID,
                        Side: Upper(ThisRecord.Pleater),
                        Shift: ThisRecord.Shift,
                        Lot: ThisRecord.Lot_No,
                        Catalog: ThisRecord.Catalog,
                        Pleats_Per_Pack: ThisRecord.PleatPerPack,
                        Pleat_Height: ThisRecord.Pleat_Height,
                        Date: ThisRecord.Date,
                        Unit_Starting: ThisRecord.'Begin Cart #',
                        Unit_Ending: ThisRecord.'End Cart #',
                        Amount_Built: ThisRecord.'End Cart #' - ThisRecord.'Begin Cart #' + 1,
                        Reject_Pleats: ThisRecord.Total_Reject_Pleats
                    }
                )
            );

            /*Collect Downtime Data*/
            Patch(rPopups,First(rPopups),{Value: 30, Display_Text:"Collecting Downtime Data"});
            Clear(cDowntime);
            ForAll(
                Filter(FE_Express_DT_Events,
                    'DateTime' >= lStartDate,
                    'DateTime' <= lEndDate
                ),
                Collect(cDowntime,
                    {
                        ID: ThisRecord.ID,
                        Line: ThisRecord.Pleater,
                        Shift: ThisRecord.' Shift',
                        DateTime: ThisRecord.DateTime,
                        Reason: ThisRecord.' Downtime Reason',
                        Downtime_Minutes: ThisRecord.' Downtime Minutes'
                    }
                )
            );


            /*Update the UI Elements*/
            Select('oee-update');
          Text: ="collect"
          AlignInContainer: =AlignInContainer.Start
          Visible: =false
    - oee-sequential-collect:
        Control: Timer
        Properties:
          Text: =Text(Time(0, 0, Self.Duration/1000 - Self.Value/1000), "hh:mm:ss")
          AlignInContainer: =AlignInContainer.Start
          Visible: =false
    - oee-update:
        Control: Classic/Button
        Properties:
          OnSelect: "=/*OEE*/\n/*Init default filters*/\nPatch(rPopups,First(rPopups),{Visible: true, Value: 40, Display_Text: \"Creating Default Filters\"});\n\nUpdateContext({\n    locProdFilter:\n        Filter(cProduction,\n            Amount_Built > 0,\n            Date >= lStartDate,\n            Date <= lEndDate,\n            If(\n                'oee-line'.Selected.Value = \"All\",\n                Side = Side,\n                Side in 'oee-line'.Selected.Value\n            )\n        ),\n    locDownFilter:\n        Filter(cDowntime,\n            DateTime >= lStartDate,\n            DateTime < DateAdd(lEndDate,1,TimeUnit.Days),\n            If(\n                'oee-line'.Selected.Value = \"All\",\n                Line = Line,\n                Line = 'oee-line'.Selected.Value\n            )\n        ),      \n    count_of_days:\n        RoundDown(DateDiff(lStartDate, lEndDate, TimeUnit.Days) / 7, 0)\n        * 5\n        + Mod(5 + Weekday(lEndDate) - Weekday(lStartDate), 5)\n        + 1\n});\n\nUpdateContext({\n    distinct_catalogs: Distinct(locProdFilter, Catalog),\n    distinct_prod_lines: Distinct(locProdFilter, Side),\n    distinct_down_lines: Distinct(locDownFilter, Line)\n});\n\n\n/*Collect Top Downtime*/\nPatch(rPopups,First(rPopups),{Value: 50, Display_Text: \"Processing Top Downtime Reasons\"});\nClear(collectTopDowntime);\n/*\n    For all base downtime reasons,\n    If the sum of the downtime Downtime_Minutes is greater than 0,\n    add to collectTopDowntime.\n    \n*/\nForAll(Distinct(locDownFilter, Reason),\n    If(Sum(Filter(locDownFilter,Reason = Value), Downtime_Minutes) > 0,\n        Collect(collectTopDowntime,\n            {\n                Downtime_Reason: Value,\n\n                Downtime_Total: \n                    Round(\n                        Sum(\n                            Filter(\n                                locDownFilter,\n                                Reason = Value\n                            ),\n                            Downtime_Minutes\n                        ),\n                        0\n                    )\n            }\n        )\n    )\n);\n\n/*Collect OEE 2 data for pareto chart*/\nPatch(rPopups,First(rPopups),{Value: 60, Display_Text: \"Creating Pareto Charts\"});\nClear(collectPareto);\n/*\n    For all collectTopDowntime,\n    Sorted and filtered by user selections,\n    Create pareto data in collectPareto.\n*/\nForAll(\n    Sort(\n        Filter(collectTopDowntime,\n                Not(Downtime_Reason in gLists.Downtime_Reasons_Planned)\n        ),\n        Downtime_Total,\n        SortOrder.Descending\n    ),\n    Collect(collectPareto,\n        {\n            id: CountRows(collectPareto)+1,\n            /*Debugging value*/\n            id_lookup: LookUp(collectPareto, id = CountRows(collectPareto)).id,\n            Reason: Downtime_Reason,\n            Downtime_Minutes: ThisRecord.Downtime_Total,\n            sum: Sum(collectTopDowntime,Downtime_Total),\n            /*frequency = This record's downtime / sum of Downtime_Minutes downtime */\n            freq:\n                Round(\n                    ThisRecord.Downtime_Total /\n                    Sum(\n                        Filter(collectTopDowntime,\n                            Not(Downtime_Reason in gLists.Downtime_Reasons_Planned)\n                        ),\n                        Downtime_Total\n                    ) * 100,0\n                ),\n            /*cumulative percentage = (this record's downtime / sum of Downtime_Minutes downtime) + the last record's cumulative percentage */\n            cumulative:\n                Round(\n                    ThisRecord.Downtime_Total / \n                    Sum(\n                        Filter(collectTopDowntime,\n                            Not(Downtime_Reason in gLists.Downtime_Reasons_Planned)\n                        ),\n                        Downtime_Total\n                    ) * 100,0\n                ) + \n                If(\n                    CountRows(collectPareto) >= 1,\n                    LookUp(collectPareto, id = CountRows(collectPareto)).cumulative,\n                    0\n                )\n        }\n    )\n);\n\n/*Collect OEE 1 data for pareto chart*/\nClear(collectParetoOEE1);\n/*\n    For all collectTopDowntime,\n    Sorted and filtered by user selections,\n    Create pareto data in collectPareto.\n*/\nForAll(\n    Sort(\n        Filter(collectTopDowntime,\n            Downtime_Reason in gLists.Downtime_Reasons_Planned\n        ),\n        Downtime_Total,\n        SortOrder.Descending\n    ),\n    Collect(collectParetoOEE1,\n        {\n            id: CountRows(collectParetoOEE1)+1,            \n            Reason: Downtime_Reason,\n            Downtime_Minutes: ThisRecord.Downtime_Total,\n            sum: Sum(collectTopDowntime,Downtime_Total),            \n            /*frequency = This record's downtime / sum of Downtime_Minutes downtime */\n            freq:\n                Round(\n                    ThisRecord.Downtime_Total /\n                    Sum(\n                        Filter(collectTopDowntime,\n                            Downtime_Reason in gLists.Downtime_Reasons_Planned\n                        ),\n                        Downtime_Total\n                    ) * 100,0\n                ),\n            /*cumulative percentage = frequency + the last record's cumulative percentage */\n            cumulative:\n                Round(\n                    ThisRecord.Downtime_Total / \n                    Sum(\n                        Filter(collectTopDowntime,\n                                Downtime_Reason in gLists.Downtime_Reasons_Planned\n                        ),\n                        Downtime_Total\n                    ) * 100,0\n                ) + \n                If(\n                    CountRows(collectParetoOEE1) >= 1,\n                    LookUp(collectParetoOEE1, id = CountRows(collectParetoOEE1)).cumulative,\n                    0\n                )\n        }\n    )\n);\n\n// Collect OEE\nPatch(rPopups,First(rPopups),{Value: 70, Display_Text: \"Gathering OEE2 Data\"});\nClear(collectOEE2Data);\nForAll(distinct_prod_lines,\n    With({thisLane:ThisRecord.Value},\n        ForAll(Distinct(Filter(locProdFilter, thisLane in Side),Pleats_Per_Pack),\n            With({thisPleatPerPack: ThisRecord.Value},\n                Collect(collectOEE2Data,\n                    {\n                        lane: thisLane,\n                        total_packs: Sum(Filter(locProdFilter, thisLane = Side, Pleats_Per_Pack = thisPleatPerPack),Amount_Built),\n                        Pleats_Per_Pack: thisPleatPerPack,\n                        pleats_per_hour: LookUp(collectPleaterSpeeds, thisLane in Line).Pleats_Per_Hour,\n                        pack_per_hour:\n                            IfError(\n                                Round(\n                                    LookUp(collectPleaterSpeeds, thisLane in Line).Pleats_Per_Hour\n                                    / thisPleatPerPack,\n                                    4\n                                ),\n                                0\n                            )\n                    }\n                )\n            )\n        )\n    )\n);\nClear(collectOEE2);\nForAll( // Lines\n    If(\n        'oee-line'.Selected.Value = \"All\",\n        Distinct(collectPleaterSpeeds, Line),\n        ['oee-line'.Selected.Value]\n    ),\n    With({thisLine: ThisRecord.Value},\n        If( \n            IfError(Round(Average(Filter(collectOEE2Data, lane in thisLine), pack_per_hour),4) > 0,false),\n        \n            Collect(collectOEE2,\n                {\n                    line: thisLine,\n                    pack_per_hour: Round(Average(Filter(collectOEE2Data, lane in thisLine), pack_per_hour),4), \n                    total_runtime: 48 * count_of_days, // This is a substitution for planned runtime\n                    total_downtime: Round(Sum(Filter(locDownFilter, thisLine in Line, Reason in gLists.Downtime_Reasons_Planned),Downtime_Minutes)/60,4),\n                    planned_packs:\n                        Round(\n                            Average(Filter(collectOEE2Data, lane in thisLine), pack_per_hour)\n                            * (\n                                (48 * count_of_days)\n                                - Round(Sum(Filter(locDownFilter, thisLine in Line, Reason in gLists.Downtime_Reasons_Planned),Downtime_Minutes)/60,4)\n                            ),\n                            4\n                        ),\n                    total_packs: 0,\n                    OEE2: 0\n                }\n            )\n        )\n    )   \n);\nForAll( // Lines\n    Distinct(collectOEE2, line),\n    With({thisLine: ThisRecord.Value},\n        If(\n            Sum(Filter(collectOEE2Data, lane in thisLine),total_packs) > 0,\n\n            Patch(collectOEE2, First(Filter(collectOEE2, line = thisLine)),\n                {\n                    total_packs: Sum(Filter(collectOEE2Data, lane in thisLine),total_packs),\n                    \n                    OEE2:\n                        IfError(\n                            Round(\n                                Sum(Filter(collectOEE2Data, lane in thisLine),total_packs)\n                                / Sum(Filter(collectOEE2, line = thisLine),planned_packs) \n                                * 100,\n                                4\n                            ),\n                            0\n                        )\n                }\n            )\n        )\n    )\n);\nPatch(collectOEE2, Defaults(collectOEE2),\n    {\n        line: \"Average\",\n        pack_per_hour:Round(Average(collectOEE2, pack_per_hour),4),\n        total_packs: Sum(collectOEE2, total_packs),\n        planned_packs: Round(Sum(collectOEE2, planned_packs),4),\n        total_runtime: Sum(collectOEE2, total_runtime),\n        total_downtime: Round(Sum(collectOEE2, total_downtime),4),\n        OEE2:\n            IfError(\n                Round(\n                    Sum(collectOEE2, total_packs)\n                    / Sum(collectOEE2, planned_packs)\n                    * 100,\n                    4\n                ),\n                0\n            )   \n    }\n);\n\n// Collect Shift OEE\nClear(collectShiftOEE2Data);\nForAll(gLists.Shifts,\n    With({thisShift: ThisRecord.Value},\n        ForAll(distinct_prod_lines,\n            With({thisLane:ThisRecord.Value},\n                ForAll(Distinct(Filter(locProdFilter, thisLane in Side, thisShift = Shift),Pleats_Per_Pack),\n                    With({thisPleatPerPack: ThisRecord.Value},\n                        Collect(collectShiftOEE2Data,\n                            {\n                                shift: thisShift,\n                                lane: thisLane,\n                                total_packs: Sum(Filter(locProdFilter, thisLane = Side, Pleats_Per_Pack = thisPleatPerPack, Shift = thisShift),Amount_Built),\n                                Pleats_Per_Pack: thisPleatPerPack,\n                                pleats_per_hour: LookUp(collectPleaterSpeeds, thisLane in Line).Pleats_Per_Hour,\n                                pack_per_hour:\n                                    IfError(\n                                        Round(\n                                            LookUp(collectPleaterSpeeds, thisLane in Line).Pleats_Per_Hour\n                                            / thisPleatPerPack,\n                                            4\n                                        ),\n                                        0\n                                    )\n                            }\n                        )\n                    )\n                )\n            )\n        )\n    )\n);\nClear(collectShiftOEE2);\nForAll(gLists.Shifts,\n    With({thisShift: Value},\n        ForAll( // Lines\n            If(\n                'oee-line'.Selected.Value = \"All\",\n                Distinct(collectPleaterSpeeds, Line),\n                ['oee-line'.Selected.Value]\n            ),\n            With({thisLine: ThisRecord.Value},\n                If( \n                    IfError(Round(Average(Filter(collectShiftOEE2Data, lane in thisLine, shift = thisShift), pack_per_hour),4) > 0,false),\n                \n                    Collect(collectShiftOEE2,\n                        {\n                            shift: thisShift,\n                            line: thisLine,\n                            pack_per_hour: Round(Average(Filter(collectShiftOEE2Data, lane in thisLine, shift = thisShift), pack_per_hour),4), \n                            total_runtime: 16 * count_of_days, // This is a substitution for planned runtime\n                            total_downtime: Round(Sum(Filter(locDownFilter, Line = thisLine, Shift = thisShift, Reason in gLists.Downtime_Reasons_Planned),Downtime_Minutes)/60,4),\n                            planned_packs: Round(Average(Filter(collectShiftOEE2Data, lane in thisLine, shift = thisShift), pack_per_hour) * 16 * count_of_days,4),\n                            downtime_planned_packs:\n                                Round(\n                                    Average(Filter(collectShiftOEE2Data, lane in thisLine, shift = thisShift), pack_per_hour)\n                                    * (\n                                        (16 * count_of_days)\n                                        - Round(Sum(Filter(locDownFilter, Line = thisLine, Shift = thisShift),Downtime_Minutes)/60,4)\n                                    ),\n                                    4\n                                ),\n                            total_packs: 0,\n                            OEE2: 0\n                        }\n                    )\n                )\n            )\n        )\n    )   \n);\nForAll(gLists.Shifts,\n    With({thisShift:Value},\n        ForAll( // Lines\n            Distinct(collectShiftOEE2, line),\n            With({thisLine: ThisRecord.Value},\n                If(\n                    Sum(Filter(collectShiftOEE2Data, lane in thisLine, shift = thisShift),total_packs) > 0,\n\n                    Patch(collectShiftOEE2, First(Filter(collectShiftOEE2, line = thisLine, shift = thisShift)),\n                        {\n                            total_packs: Sum(Filter(collectShiftOEE2Data, lane in thisLine, shift = thisShift),total_packs),\n                            \n                            OEE2:\n                                IfError(\n                                    Round(\n                                        Sum(Filter(collectShiftOEE2Data, lane in thisLine, shift = thisShift),total_packs)\n                                        / Sum(Filter(collectShiftOEE2, line = thisLine, shift = thisShift),downtime_planned_packs) \n                                        * 100,\n                                        4\n                                    ),\n                                    0\n                                )\n                        }\n                    )\n                )\n            )\n        )\n    )\n);\nForAll(gLists.Shifts,\n    With(\n        {\n            thisShift:ThisRecord.Value,\n            thisFilter: Filter(collectShiftOEE2, shift = Value)\n        },\n        Patch(collectShiftOEE2, Defaults(collectShiftOEE2),\n            {\n                line: \"Average\",\n                shift: thisShift,\n                pack_per_hour:Round(Average(thisFilter, pack_per_hour),4),\n                total_packs: Sum(thisFilter, total_packs),\n                total_downtime: Sum(thisFilter, total_downtime),\n                planned_packs: Round(Sum(thisFilter, planned_packs),4),\n                downtime_planned_packs: Round(Sum(thisFilter, downtime_planned_packs),4),\n                total_runtime: Sum(thisFilter, total_runtime),\n                OEE2:\n                    IfError(\n                        Round(\n                            Sum(thisFilter, total_packs)\n                            / Sum(thisFilter, downtime_planned_packs)\n                            * 100,\n                            4\n                        ),\n                        0\n                    )   \n            }\n        )\n    )\n);\n\n/*Garbage collection*/\nUpdateContext({\n    locProdFilter: Blank(),\n    locDownFilter: Blank(),\n    distinct_catalogs: Blank(),\n    distinct_prod_lines: Blank(),\n    distinct_down_lines: Blank()\n});\nClear(collectShiftOEE2Data);\nClear(collectOEE2Data);\n\nPatch(rPopups,First(rPopups),{Visible: false, Value: 70, Display_Text: \"Finishing Up\"});"
          Text: ="update"
          AlignInContainer: =AlignInContainer.Start
          Visible: =false
    - oee-header:
        Control: GroupContainer
        Variant: horizontalAutoLayoutContainer
        Properties:
          AlignInContainer: =AlignInContainer.SetByContainer
          DropShadow: =DropShadow.None
          Fill: =gTheme.Primary
          LayoutAlignItems: =LayoutAlignItems.Stretch
          LayoutGap: =gPadding
          LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
          LayoutMinHeight: =10
          LayoutMinWidth: =10
          LayoutMode: =LayoutMode.Auto
          PaddingBottom: =gPadding
          PaddingLeft: =gPadding
          PaddingRight: =gPadding
          PaddingTop: =gPadding
          RadiusBottomLeft: =0
          RadiusBottomRight: =0
          RadiusTopLeft: =0
          RadiusTopRight: =0
        Children:
        - oee-logo:
            Control: Image
            Properties:
              Image: =If(gTheme.Mode = "Light", logo1, logo2)
              LayoutMinHeight: =10
              Width: ='oee-n-title'.Width
        - oee-title:
            Control: Label
            Properties:
              Text: =APP_NAME
              Color: =gTheme.Text_Light
              FillPortions: =1
              LayoutMinHeight: =10
              LayoutMinWidth: =10
              Size: =Self.Height / 3
        - oee-mode:
            Control: Classic/Icon
            Variant: HalfFilledCircle
            Properties:
              OnSelect: =If(gTheme.Mode = "Light", Set(gTheme, gThemeMode.Dark),Set(gTheme, gThemeMode.Light))
              Color: =gTheme.Text_On_Dark
              Height: =10
              HoverColor: =gTheme.Text_On_Light
              Icon: =Icon.HalfFilledCircle
              LayoutMinHeight: =10
              PaddingBottom: =4
              PaddingLeft: =4
              PaddingRight: =4
              PaddingTop: =4
              Rotation: =If(gTheme.Mode = "Light", 0, 180)
              Width: =Self.Height
        - oee-bugs:
            Control: Image
            Properties:
              OnSelect: =Navigate(Bugs,ScreenTransition.Fade)
              Image: =gIcons.Bug
              HoverFill: =gTheme.Pri_Complement
              ImagePosition: =ImagePosition.Fill
              LayoutMinHeight: =10
              PaddingLeft: =
              RadiusBottomLeft: =Self.Width
              RadiusBottomRight: =Self.RadiusBottomLeft
              RadiusTopLeft: =Self.RadiusBottomLeft
              RadiusTopRight: =Self.RadiusBottomLeft
              Width: =Self.Height
        - oee-user-img:
            Control: Image
            Properties:
              Image: =User().Image
              Fill: =RGBA(0, 0, 0, 1)
              ImagePosition: =ImagePosition.Fill
              LayoutMinHeight: =10
              PaddingLeft: =
              RadiusBottomLeft: =Self.Width
              RadiusBottomRight: =Self.RadiusBottomLeft
              RadiusTopLeft: =Self.RadiusBottomLeft
              RadiusTopRight: =Self.RadiusBottomLeft
              Width: =Self.Height
    - oee-main:
        Control: GroupContainer
        Variant: horizontalAutoLayoutContainer
        Properties:
          AlignInContainer: =AlignInContainer.SetByContainer
          DropShadow: =DropShadow.None
          FillPortions: =11
          LayoutAlignItems: =LayoutAlignItems.Stretch
          LayoutMinHeight: =10
          LayoutMinWidth: =10
          LayoutMode: =LayoutMode.Auto
          RadiusBottomLeft: =0
          RadiusBottomRight: =0
          RadiusTopLeft: =0
          RadiusTopRight: =0
        Children:
        - oee-navigation:
            Control: GroupContainer
            Variant: verticalAutoLayoutContainer
            Properties:
              AlignInContainer: =AlignInContainer.SetByContainer
              DropShadow: =DropShadow.None
              Fill: =gTheme.Midground
              LayoutAlignItems: =LayoutAlignItems.Stretch
              LayoutDirection: =LayoutDirection.Vertical
              LayoutGap: =gPadding
              LayoutMinHeight: =10
              LayoutMinWidth: =10
              LayoutMode: =LayoutMode.Auto
              PaddingBottom: =gPadding
              PaddingLeft: =gPadding
              PaddingRight: =gPadding
              PaddingTop: =gPadding
              RadiusBottomLeft: =0
              RadiusBottomRight: =0
              RadiusTopLeft: =0
              RadiusTopRight: =0
            Children:
            - oee-n-title:
                Control: Label
                Properties:
                  Text: =App.ActiveScreen.Name
                  Align: =Align.Center
                  Color: =gTheme.Text_On_Light
                  LayoutMinWidth: =10
                  Size: =Self.Height / 3
            - oee-n-separator-0:
                Control: Rectangle
                Properties:
                  Fill: =gTheme.Pri_Complement
                  Height: =Round(gPadding/2,0)
                  LayoutMinWidth: =10
                  Width: =10
            - oee-n-gallery:
                Control: Gallery
                Variant: galleryVertical
                Properties:
                  Items: =cNavigation
                  AlignInContainer: =AlignInContainer.SetByContainer
                  DelayItemLoading: =true
                  Layout: =Layout.Vertical
                  LayoutMinHeight: =10
                  LayoutMinWidth: =10
                  LoadingSpinner: =LoadingSpinner.Data
                  TemplatePadding: =gPadding
                  TemplateSize: =40
                Children:
                - oee-n-g-button:
                    Control: Classic/Button
                    Properties:
                      OnSelect: =Navigate(ThisItem.Screen,ScreenTransition.Fade)
                      Text: =ThisItem.Label
                      BorderThickness: =1
                      Color: =gTheme.Text_Dark
                      DisplayMode: =If(App.ActiveScreen.Name = ThisItem.Screen.Name, DisplayMode.Disabled, DisplayMode.Edit)
                      Fill: =gTheme.Accent
                      FontWeight: =FontWeight.Normal
                      Height: =Parent.TemplateHeight
                      RadiusBottomLeft: =100
                      RadiusBottomRight: =100
                      RadiusTopLeft: =100
                      RadiusTopRight: =100
                      Size: =Self.Height / 4
                      Width: =Parent.TemplateWidth
            - oee-n-legal:
                Control: Label
                Properties:
                  Text: |-
                    =
                    "MilliporeSigma is the U.S. and Canada Life Science business of Merck KGaA, Darmstadt, Germany."
                    &Char(13)&Char(13)&
                    "© 2025 EMD Millipore. All rights reserved."
                  Align: =Align.Center
                  Color: =gTheme.Text_On_Light
                  Height: =200
                  LayoutMinWidth: =10
                  Size: =Self.Height / 24
                  VerticalAlign: =VerticalAlign.Bottom
        - oee-filter-parent:
            Control: GroupContainer
            Variant: verticalAutoLayoutContainer
            Properties:
              AlignInContainer: =AlignInContainer.SetByContainer
              DropShadow: =DropShadow.None
              Fill: =gTheme.Background
              LayoutAlignItems: =LayoutAlignItems.Stretch
              LayoutDirection: =LayoutDirection.Vertical
              LayoutGap: =gPadding
              LayoutMinHeight: =10
              LayoutMinWidth: =10
              LayoutMode: =LayoutMode.Auto
              PaddingBottom: =gPadding
              PaddingLeft: =gPadding
              PaddingRight: =gPadding
              PaddingTop: =gPadding
              RadiusBottomLeft: =0
              RadiusBottomRight: =0
              RadiusTopLeft: =0
              RadiusTopRight: =0
            Children:
            - oee-filters:
                Control: GroupContainer
                Variant: verticalAutoLayoutContainer
                Properties:
                  AlignInContainer: =AlignInContainer.SetByContainer
                  Fill: =gTheme.Foreground
                  FillPortions: =0
                  Height: =Parent.Height * 0.6
                  LayoutAlignItems: =LayoutAlignItems.Stretch
                  LayoutDirection: =LayoutDirection.Vertical
                  LayoutGap: =gPadding
                  LayoutMinHeight: =10
                  LayoutMinWidth: =10
                  LayoutMode: =LayoutMode.Auto
                  PaddingBottom: =gPadding
                  PaddingLeft: =gPadding
                  PaddingRight: =gPadding
                Children:
                - oee-oee-title:
                    Control: Label
                    Properties:
                      Text: ="Filters"
                      Align: =Align.Center
                      AlignInContainer: =AlignInContainer.Center
                      Color: =gTheme.Text_Light
                      Fill: =gTheme.Secondary
                      LayoutMinWidth: =10
                      Size: =Self.Height / 4
                      Width: =Parent.Width
                - oee-start-date-label:
                    Control: Label
                    Properties:
                      Text: ="Start Date"
                      Align: =Align.Center
                      Color: =gTheme.Text_On_Light
                      LayoutMinWidth: =10
                      Size: =Self.Height / 4
                - oee-start-date:
                    Control: Classic/DatePicker
                    Properties:
                      BorderThickness: =1
                      Color: =gTheme.Text_On_Light
                      Fill: =gTheme.Background
                      FocusedBorderThickness: =1
                      IconBackground: =gTheme.Sec_Complement
                      IconFill: =gTheme.Text_On_Light
                      LayoutMinWidth: =10
                      Size: =Self.Height / 5
                - oee-end-date-label:
                    Control: Label
                    Properties:
                      Text: ="End Date"
                      Align: =Align.Center
                      Color: =gTheme.Text_On_Light
                      LayoutMinWidth: =10
                      Size: =Self.Height / 4
                - oee-end-date:
                    Control: Classic/DatePicker
                    Properties:
                      BorderThickness: =1
                      Color: =gTheme.Text_On_Light
                      Fill: =gTheme.Background
                      FocusedBorderThickness: =1
                      IconBackground: =gTheme.Sec_Complement
                      IconFill: =gTheme.Text_On_Light
                      LayoutMinWidth: =10
                      Size: =Self.Height / 5
                - oee-button:
                    Control: Classic/Button
                    Properties:
                      OnSelect: =Select('oee-collect');
                      Text: ="Update Date Range"
                      Tooltip: ="Updates date range for OEE2 calculation."
                      Color: =gTheme.Text_Dark
                      Fill: =gTheme.Accent
                      FontWeight: =FontWeight.Normal
                      LayoutMinHeight: =10
                      LayoutMinWidth: =10
                      Size: =Self.Width / 16
                - oee-oee-separator-0:
                    Control: Rectangle
                    Properties:
                      Fill: =gTheme.Pri_Complement
                      Height: =Round(gPadding/2,0)
                      LayoutMinWidth: =10
                      Width: =10
                - oee-line-label:
                    Control: Label
                    Properties:
                      Text: ="Line"
                      Align: =Align.Center
                      Color: =gTheme.Text_On_Light
                      LayoutMinWidth: =10
                      Size: =Self.Height / 4
                - oee-line:
                    Control: Classic/DropDown
                    Properties:
                      OnChange: =Select('oee-update');
                      Items: =Table(["All"],gLists.Lines)
                      ChevronBackground: =gTheme.Sec_Complement
                      ChevronFill: =gTheme.Text_Dark
                      Color: =gTheme.Text_On_Light
                      Fill: =gTheme.Background
                      LayoutMinWidth: =10
                      Size: =Self.Height / 5
                - oee-oee-separator-1:
                    Control: Rectangle
                    Properties:
                      Fill: =gTheme.Pri_Complement
                      Height: =Round(gPadding/2,0)
                      LayoutMinWidth: =10
                      Width: =10
        - oee-body:
            Control: GroupContainer
            Variant: verticalAutoLayoutContainer
            Properties:
              AlignInContainer: =AlignInContainer.SetByContainer
              DropShadow: =DropShadow.None
              FillPortions: =If(App.Width < Index(App.SizeBreakpoints,3).Value, 6, 10)
              LayoutAlignItems: =LayoutAlignItems.Center
              LayoutDirection: =LayoutDirection.Vertical
              LayoutGap: =gPadding
              LayoutMinHeight: =10
              LayoutMinWidth: =10
              LayoutMode: =LayoutMode.Auto
              LayoutOverflowY: =LayoutOverflow.Scroll
              PaddingBottom: =gPadding
              PaddingLeft: =gPadding
              PaddingRight: =gPadding
              PaddingTop: =gPadding
              RadiusBottomLeft: =0
              RadiusBottomRight: =0
              RadiusTopLeft: =0
              RadiusTopRight: =0
            Children:
            - oee-last-update:
                Control: GroupContainer
                Variant: manualLayoutContainer
                Properties:
                  AlignInContainer: =AlignInContainer.SetByContainer
                  DropShadow: =DropShadow.Regular
                  Fill: =gTheme.Pri_Complement
                  FillPortions: =0
                  Height: =Parent.Height * 0.05
                  RadiusBottomLeft: =8
                  RadiusBottomRight: =8
                  RadiusTopLeft: =8
                  RadiusTopRight: =8
                Children:
                - oee-lu-text:
                    Control: Label
                    Properties:
                      Text: |-
                        ="Last Database Update: " & gLastDBUpdate
                      Align: =Align.Center
                      Color: =gTheme.Text_Dark
                      Height: =Parent.Height
                      Size: =Round(Self.Height/3,0)
                      Width: =Parent.Width
            - oee-average:
                Control: GroupContainer
                Variant: verticalAutoLayoutContainer
                Properties:
                  AlignInContainer: =AlignInContainer.SetByContainer
                  BorderColor: =gTheme.Sec_Complement
                  BorderThickness: |-
                    =//If(gTheme.Mode = "Light", 0, 1)
                    0
                  DropShadow: =DropShadow.Semilight
                  Fill: =gTheme.Foreground
                  FillPortions: =0
                  Height: =Self.Width * 0.6
                  LayoutAlignItems: =LayoutAlignItems.Stretch
                  LayoutDirection: =LayoutDirection.Vertical
                  LayoutMinHeight: =10
                  LayoutMinWidth: =10
                  LayoutMode: =LayoutMode.Auto
                  Width: =Parent.Width * 0.33
                Children:
                - oee-average-title:
                    Control: Label
                    Properties:
                      Text: =Concatenate('oee-line'.Selected.Value," OEE2")
                      Align: =Align.Center
                      Color: =gTheme.Text_Light
                      Fill: =gTheme.Secondary
                      FillPortions: =1
                      Font: =Font.Verdana
                      LayoutMinHeight: =10
                      LayoutMinWidth: =10
                      Size: =Self.Height / 3
                - oee-ave-layout:
                    Control: GroupContainer
                    Variant: horizontalAutoLayoutContainer
                    Properties:
                      DropShadow: =DropShadow.None
                      FillPortions: =7
                      LayoutAlignItems: =LayoutAlignItems.Stretch
                      LayoutMinHeight: =10
                      LayoutMinWidth: =10
                      LayoutMode: =LayoutMode.Auto
                      RadiusBottomLeft: =0
                      RadiusBottomRight: =0
                      RadiusTopLeft: =0
                      RadiusTopRight: =0
                    Children:
                    - oee-average-graph:
                        Control: Image
                        Properties:
                          Image: |-
                            ="https://quickchart.io/chart?width=" &Self.Width& "&height=" &Self.Height*0.90& "&c=" & 
                            EncodeUrl(
                            "{
                              type: 'radialGauge',
                              data: {
                                datasets: [{
                                  data: ["& Last(collectOEE2).OEE2 &"],
                                  backgroundColor: getGradientFillHelper('horizontal', [
                                    '"& gTheme.Chart_Blue &"',
                                    '"& gTheme.Chart_Blue &"',
                                    '"& gTheme.Chart_Blue &"',
                                    '"& gTheme.Chart_Red &"',
                                    '"& gTheme.Chart_Red &"',
                                    '"& gTheme.Chart_Red &"'
                                    ]),
                                }]
                              },
                              options: {
                                domain: [0, "& If(Last(collectOEE2).OEE2 <= 100, 100, Last(collectOEE2).OEE2) &"],
                                trackColor: '"& gTheme.Chart_White &"', 
                                centerPercentage: 90,
                                centerArea: {
                                  text: (val) => val + '%',
                                  fontColor: '"& gTheme.Chart_Black &"'
                                },
                              }
                            }"
                            )
                          AlignInContainer: =AlignInContainer.Stretch
                          FillPortions: =3
                          Height: =Self.Width
                          LayoutMinHeight: =1
                          LayoutMinWidth: =1
                          PaddingLeft: =gPadding/2
                          PaddingRight: =gPadding/2
                    - oee-ave-data:
                        Control: GroupContainer
                        Variant: verticalAutoLayoutContainer
                        Properties:
                          AlignInContainer: =AlignInContainer.SetByContainer
                          DropShadow: =DropShadow.None
                          FillPortions: =5
                          LayoutAlignItems: =LayoutAlignItems.Stretch
                          LayoutDirection: =LayoutDirection.Vertical
                          LayoutMinHeight: =10
                          LayoutMinWidth: =10
                          LayoutMode: =LayoutMode.Auto
                          RadiusBottomLeft: =0
                          RadiusBottomRight: =0
                          RadiusTopLeft: =0
                          RadiusTopRight: =0
                        Children:
                        - oee-ave-upper:
                            Control: GroupContainer
                            Variant: horizontalAutoLayoutContainer
                            Properties:
                              DropShadow: =DropShadow.None
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              LayoutMode: =LayoutMode.Auto
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                            Children:
                            - oee-ave-built-parent:
                                Control: GroupContainer
                                Variant: verticalAutoLayoutContainer
                                Properties:
                                  AlignInContainer: =AlignInContainer.SetByContainer
                                  DropShadow: =DropShadow.None
                                  LayoutAlignItems: =LayoutAlignItems.Stretch
                                  LayoutDirection: =LayoutDirection.Vertical
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: '=10  '
                                  LayoutMode: =LayoutMode.Auto
                                  RadiusBottomLeft: =0
                                  RadiusBottomRight: =0
                                  RadiusTopLeft: =0
                                  RadiusTopRight: =0
                                Children:
                                - oee-ave-built-title:
                                    Control: Label
                                    Properties:
                                      Text: ="Total Packs"
                                      Align: =Align.Center
                                      Color: =gTheme.Text_Dark
                                      Fill: =gTheme.Sec_Complement
                                      FillPortions: =1
                                      Font: =Font.Verdana
                                      LayoutMinHeight: =10
                                      LayoutMinWidth: =10
                                      Size: =Self.Height / 4.5
                                      Width: =10
                                - oee-ave-built:
                                    Control: Label
                                    Properties:
                                      Text: =Last(collectOEE2).total_packs*1
                                      Align: =Align.Center
                                      Color: =gTheme.Text_On_Light
                                      FillPortions: =1
                                      Font: =Font.Verdana
                                      FontWeight: =FontWeight.Semibold
                                      LayoutMinHeight: =10
                                      LayoutMinWidth: =10
                                      Size: =Self.Height / 3
                                      Width: =10
                            - oee-ave-reject-parent:
                                Control: GroupContainer
                                Variant: verticalAutoLayoutContainer
                                Properties:
                                  AlignInContainer: =AlignInContainer.SetByContainer
                                  DropShadow: =DropShadow.None
                                  LayoutAlignItems: =LayoutAlignItems.Stretch
                                  LayoutDirection: =LayoutDirection.Vertical
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: =10
                                  LayoutMode: =LayoutMode.Auto
                                  RadiusBottomLeft: =0
                                  RadiusBottomRight: =0
                                  RadiusTopLeft: =0
                                  RadiusTopRight: =0
                                Children:
                                - oee-ave-reject-title:
                                    Control: Label
                                    Properties:
                                      Text: ="Reject Pleats"
                                      Align: =Align.Center
                                      Color: =gTheme.Text_Dark
                                      Fill: =gTheme.Sec_Complement
                                      FillPortions: =1
                                      Font: =Font.Verdana
                                      LayoutMinHeight: =10
                                      LayoutMinWidth: =10
                                      Size: =Self.Height / 4.5
                                      Width: =10
                                - oee-ave-reject:
                                    Control: Label
                                    Properties:
                                      Text: |-
                                        ="Not Collected"
                                        //Last(collectOEE2).line
                                      Align: =Align.Center
                                      Color: =gTheme.Text_On_Light
                                      FillPortions: =1
                                      Font: =Font.Verdana
                                      LayoutMinHeight: =10
                                      LayoutMinWidth: =10
                                      Size: =Self.Height / 3.5
                                      Width: =10
                        - oee-ave-middle:
                            Control: GroupContainer
                            Variant: horizontalAutoLayoutContainer
                            Properties:
                              AlignInContainer: =AlignInContainer.SetByContainer
                              DropShadow: =DropShadow.None
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              LayoutMode: =LayoutMode.Auto
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                            Children:
                            - oee-ave-constraint-parent:
                                Control: GroupContainer
                                Variant: verticalAutoLayoutContainer
                                Properties:
                                  AlignInContainer: =AlignInContainer.SetByContainer
                                  DropShadow: =DropShadow.None
                                  LayoutAlignItems: =LayoutAlignItems.Stretch
                                  LayoutDirection: =LayoutDirection.Vertical
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: '=10  '
                                  LayoutMode: =LayoutMode.Auto
                                  RadiusBottomLeft: =0
                                  RadiusBottomRight: =0
                                  RadiusTopLeft: =0
                                  RadiusTopRight: =0
                                Children:
                                - oee-ave-constraint-title:
                                    Control: Label
                                    Properties:
                                      Text: ="Average Constraint"
                                      Align: =Align.Center
                                      Color: =gTheme.Text_Dark
                                      Fill: =gTheme.Sec_Complement
                                      FillPortions: =1
                                      Font: =Font.Verdana
                                      LayoutMinHeight: =10
                                      LayoutMinWidth: =10
                                      Size: =Self.Height / 4.5
                                      Width: =10
                                - oee-ave-constraint:
                                    Control: Label
                                    Properties:
                                      Text: |-
                                        =IfError(Round(Last(collectOEE2).pack_per_hour*1,0),0) & "
                                        packs per hour"
                                      Align: =Align.Center
                                      Color: =gTheme.Text_On_Light
                                      FillPortions: =1
                                      Font: =Font.Verdana
                                      LayoutMinHeight: =10
                                      LayoutMinWidth: =10
                                      Size: =Self.Height / 4
                                      Width: =10
                            - oee-ave-target-parent:
                                Control: GroupContainer
                                Variant: verticalAutoLayoutContainer
                                Properties:
                                  AlignInContainer: =AlignInContainer.SetByContainer
                                  DropShadow: =DropShadow.None
                                  LayoutAlignItems: =LayoutAlignItems.Stretch
                                  LayoutDirection: =LayoutDirection.Vertical
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: '=10  '
                                  LayoutMode: =LayoutMode.Auto
                                  RadiusBottomLeft: =0
                                  RadiusBottomRight: =0
                                  RadiusTopLeft: =0
                                  RadiusTopRight: =0
                                Children:
                                - oee-ave-target-title:
                                    Control: Label
                                    Properties:
                                      Text: ="Total Packs Possible"
                                      Align: =Align.Center
                                      Color: =gTheme.Text_Dark
                                      Fill: =gTheme.Sec_Complement
                                      FillPortions: =1
                                      Font: =Font.Verdana
                                      LayoutMinHeight: =10
                                      LayoutMinWidth: =10
                                      Size: =Self.Height / 4.5
                                      Width: =10
                                - oee-ave-target:
                                    Control: Label
                                    Properties:
                                      Text: =RoundDown(Last(collectOEE2).planned_packs,0)
                                      Align: =Align.Center
                                      Color: =gTheme.Text_On_Light
                                      FillPortions: =1
                                      Font: =Font.Verdana
                                      LayoutMinHeight: =10
                                      LayoutMinWidth: =10
                                      Size: =Self.Height / 3.5
                                      Width: =10
                        - oee-average-lower:
                            Control: GroupContainer
                            Variant: horizontalAutoLayoutContainer
                            Properties:
                              AlignInContainer: =AlignInContainer.SetByContainer
                              DropShadow: =DropShadow.None
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              LayoutMode: =LayoutMode.Auto
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                            Children:
                            - oee-ave-unplanned-parent:
                                Control: GroupContainer
                                Variant: verticalAutoLayoutContainer
                                Properties:
                                  AlignInContainer: =AlignInContainer.SetByContainer
                                  DropShadow: =DropShadow.None
                                  LayoutAlignItems: =LayoutAlignItems.Stretch
                                  LayoutDirection: =LayoutDirection.Vertical
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: =10
                                  LayoutMode: =LayoutMode.Auto
                                  RadiusBottomLeft: =0
                                  RadiusBottomRight: =0
                                  RadiusTopLeft: =0
                                  RadiusTopRight: =0
                                Children:
                                - oee-ave-unplanned-title:
                                    Control: Label
                                    Properties:
                                      Text: ="Calculated Downtime"
                                      Align: =Align.Center
                                      Color: =gTheme.Text_Dark
                                      Fill: =gTheme.Sec_Complement
                                      FillPortions: =1
                                      Font: =Font.Verdana
                                      LayoutMinHeight: =10
                                      LayoutMinWidth: =10
                                      Size: =Self.Height / 4.5
                                      Width: =10
                                - oee-ave-unplanned:
                                    Control: Label
                                    Properties:
                                      Text: |-
                                        =Round(Last(collectOEE2).total_downtime,0) & "H "& Round(Mod(Last(collectOEE2).total_downtime*60,60),0) & "m"
                                        //"Not Collected"
                                        //RoundDown(First(collectOEE2).downtime_unplanned/60,0) &"H "& Mod(First(collectOEE2).downtime_unplanned,60) & "m"
                                      Align: =Align.Center
                                      Color: =gTheme.Text_On_Light
                                      FillPortions: =1
                                      Font: =Font.Verdana
                                      LayoutMinHeight: =10
                                      LayoutMinWidth: =10
                                      Size: =Self.Height / 4
                                      Width: =10
                            - oee-ave-planned-parent:
                                Control: GroupContainer
                                Variant: verticalAutoLayoutContainer
                                Properties:
                                  AlignInContainer: =AlignInContainer.SetByContainer
                                  DropShadow: =DropShadow.None
                                  LayoutAlignItems: =LayoutAlignItems.Stretch
                                  LayoutDirection: =LayoutDirection.Vertical
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: =10
                                  LayoutMode: =LayoutMode.Auto
                                  RadiusBottomLeft: =0
                                  RadiusBottomRight: =0
                                  RadiusTopLeft: =0
                                  RadiusTopRight: =0
                                Children:
                                - oee-ave-planned-title:
                                    Control: Label
                                    Properties:
                                      Text: ="Calculated Runtime"
                                      Align: =Align.Center
                                      Color: =gTheme.Text_Dark
                                      Fill: =gTheme.Sec_Complement
                                      FillPortions: =1
                                      Font: =Font.Verdana
                                      LayoutMinHeight: =10
                                      LayoutMinWidth: =10
                                      Size: =Self.Height / 4.5
                                      Width: =10
                                - oee-ave-planned:
                                    Control: Label
                                    Properties:
                                      Text: |-
                                        =Round(Sum(-Last(collectOEE2).total_downtime,Last(collectOEE2).total_runtime),0)& "H"
                                        //"Not Collected"
                                        //RoundDown(First(collectOEE2).downtime_planned/60,0) &"H "& Mod(First(collectOEE2).downtime_planned,60) & "m"
                                      Align: =Align.Center
                                      Color: =gTheme.Text_On_Light
                                      FillPortions: =1
                                      Font: =Font.Verdana
                                      LayoutMinHeight: =10
                                      LayoutMinWidth: =10
                                      Size: =Self.Height / 4
                                      Width: =10
                            - oee-ave-possible-parent:
                                Control: GroupContainer
                                Variant: verticalAutoLayoutContainer
                                Properties:
                                  AlignInContainer: =AlignInContainer.SetByContainer
                                  DropShadow: =DropShadow.None
                                  LayoutAlignItems: =LayoutAlignItems.Stretch
                                  LayoutDirection: =LayoutDirection.Vertical
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: =10
                                  LayoutMode: =LayoutMode.Auto
                                  RadiusBottomLeft: =0
                                  RadiusBottomRight: =0
                                  RadiusTopLeft: =0
                                  RadiusTopRight: =0
                                Children:
                                - oee-ave-possible-title:
                                    Control: Label
                                    Properties:
                                      Text: |-
                                        ="Possible
                                        Runtime"
                                      Align: =Align.Center
                                      Color: =gTheme.Text_Dark
                                      Fill: =gTheme.Sec_Complement
                                      FillPortions: =1
                                      Font: =Font.Verdana
                                      LayoutMinHeight: =10
                                      LayoutMinWidth: =10
                                      Size: =Self.Height / 4.5
                                      Width: =10
                                - oee-ave-possible:
                                    Control: Label
                                    Properties:
                                      Text: =Last(collectOEE2).total_runtime*1 & "H"
                                      Align: =Align.Center
                                      Color: =gTheme.Text_On_Light
                                      FillPortions: =1
                                      Font: =Font.Verdana
                                      LayoutMinHeight: =10
                                      LayoutMinWidth: =10
                                      Size: =Self.Height / 4
                                      Width: =10
            - oee-section-1:
                Control: GroupContainer
                Variant: horizontalAutoLayoutContainer
                Properties:
                  AlignInContainer: =AlignInContainer.SetByContainer
                  DropShadow: =DropShadow.None
                  FillPortions: =0
                  Height: =Self.Width
                  LayoutGap: =gPadding * 2.5
                  LayoutMode: =LayoutMode.Auto
                  RadiusBottomLeft: =0
                  RadiusBottomRight: =0
                  RadiusTopLeft: =0
                  RadiusTopRight: =0
                  Width: =Parent.Width * 0.50
                Children:
                - oee-section-2:
                    Control: GroupContainer
                    Variant: horizontalAutoLayoutContainer
                    Properties:
                      AlignInContainer: =AlignInContainer.SetByContainer
                      DropShadow: =DropShadow.None
                      FillPortions: =3
                      Height: =Parent.Height
                      LayoutAlignItems: =LayoutAlignItems.Stretch
                      LayoutDirection: =LayoutDirection.Vertical
                      LayoutGap: =gPadding * 2.5
                      LayoutMinHeight: =10
                      LayoutMinWidth: =10
                      LayoutMode: =LayoutMode.Auto
                      PaddingBottom: =gPadding
                      RadiusBottomLeft: =0
                      RadiusBottomRight: =0
                      RadiusTopLeft: =0
                      RadiusTopRight: =0
                      Width: =Parent.Width * 0.65
                    Children:
                    - oee-shift-c:
                        Control: GroupContainer
                        Variant: verticalAutoLayoutContainer
                        Properties:
                          AlignInContainer: =AlignInContainer.SetByContainer
                          BorderColor: =RGBA(0,0,0,0)
                          DropShadow: =DropShadow.Semilight
                          Fill: =gTheme.Foreground
                          LayoutAlignItems: =LayoutAlignItems.Stretch
                          LayoutDirection: =LayoutDirection.Vertical
                          LayoutMinHeight: =10
                          LayoutMinWidth: =10
                          LayoutMode: =LayoutMode.Auto
                          PaddingLeft: =
                        Children:
                        - oee-c-title:
                            Control: Label
                            Properties:
                              Text: ="C Shift"
                              Align: =Align.Center
                              Color: =gTheme.Text_Light
                              Fill: =gTheme.Secondary
                              FillPortions: =1
                              Font: =Font.Verdana
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              Size: =Self.Height / 3
                        - oee-c-layout:
                            Control: GroupContainer
                            Variant: horizontalAutoLayoutContainer
                            Properties:
                              AlignInContainer: =AlignInContainer.SetByContainer
                              DropShadow: =DropShadow.None
                              FillPortions: =5
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              LayoutMode: =LayoutMode.Auto
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                            Children:
                            - oee-c-graph:
                                Control: Image
                                Properties:
                                  Image: |-
                                    ="https://quickchart.io/chart?width=" &Self.Width& "&height=" &Self.Height*0.90& "&c=" & 
                                    EncodeUrl(
                                    "{
                                      type: 'radialGauge',
                                      data: {
                                        datasets: [{
                                          data: ["& LookUp(collectShiftOEE2, line = "Average" && shift = "C").OEE2 &"],
                                          backgroundColor: getGradientFillHelper('horizontal', [
                                            '"& gTheme.Chart_Blue &"',
                                            '"& gTheme.Chart_Blue &"',
                                            '"& gTheme.Chart_Blue &"',
                                            '"& gTheme.Chart_Red &"',
                                            '"& gTheme.Chart_Red &"',
                                            '"& gTheme.Chart_Red &"'
                                            ]),
                                        }]
                                      },
                                      options: {
                                        domain: [0, "& If(LookUp(collectShiftOEE2, line = "Average" && shift = "C").OEE2 <= 100, 100, LookUp(collectShiftOEE2, line = "Average" && shift = "C").OEE2) &"],
                                        trackColor: '"& gTheme.Chart_White &"', 
                                        centerPercentage: 90,
                                        centerArea: {
                                          text: (val) => val + '%',
                                          fontColor: '"& gTheme.Chart_Black &"'
                                        },
                                      }
                                    }"
                                    )
                                  FillPortions: =2
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: =10
                            - oee-c-data:
                                Control: GroupContainer
                                Variant: verticalAutoLayoutContainer
                                Properties:
                                  AlignInContainer: =AlignInContainer.SetByContainer
                                  DropShadow: =DropShadow.None
                                  FillPortions: =4
                                  LayoutAlignItems: =LayoutAlignItems.Stretch
                                  LayoutDirection: =LayoutDirection.Vertical
                                  LayoutGap: =
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: =10
                                  LayoutMode: =LayoutMode.Auto
                                  RadiusBottomLeft: =0
                                  RadiusBottomRight: =0
                                  RadiusTopLeft: =0
                                  RadiusTopRight: =0
                                Children:
                                - oee-c-upper:
                                    Control: GroupContainer
                                    Variant: horizontalAutoLayoutContainer
                                    Properties:
                                      AlignInContainer: =AlignInContainer.SetByContainer
                                      DropShadow: =DropShadow.None
                                      LayoutAlignItems: =LayoutAlignItems.Stretch
                                      LayoutMinHeight: =10
                                      LayoutMinWidth: =10
                                      LayoutMode: =LayoutMode.Auto
                                      RadiusBottomLeft: =0
                                      RadiusBottomRight: =0
                                      RadiusTopLeft: =0
                                      RadiusTopRight: =0
                                    Children:
                                    - oee-c-built-parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee-c-built-title:
                                            Control: Label
                                            Properties:
                                              Text: ="Units Built"
                                              Align: =Align.Center
                                              Color: =gTheme.Text_Dark
                                              Fill: =gTheme.Sec_Complement
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee-c-built:
                                            Control: Label
                                            Properties:
                                              Text: =Sum(Filter(collectShiftOEE2, line = "Average", shift = "C"),total_packs)*1
                                              Align: =Align.Center
                                              Color: =gTheme.Text_On_Light
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4
                                              Width: =10
                                    - oee-c-goal-parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee-c-goal-title:
                                            Control: Label
                                            Properties:
                                              Text: ="Build Goal"
                                              Align: =Align.Center
                                              Color: =gTheme.Text_Dark
                                              Fill: =gTheme.Sec_Complement
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee-c-goal:
                                            Control: Label
                                            Properties:
                                              Text: =Round(Sum(Filter(collectShiftOEE2, line="Average", shift="C"),downtime_planned_packs),0)
                                              Align: =Align.Center
                                              Color: =gTheme.Text_On_Light
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4
                                              Width: =10
                                    - oee-c-constraint-parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee-c-constraint-title:
                                            Control: Label
                                            Properties:
                                              Text: ="Constraint"
                                              Align: =Align.Center
                                              Color: =gTheme.Text_Dark
                                              Fill: =gTheme.Sec_Complement
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee-c-constraint:
                                            Control: Label
                                            Properties:
                                              Text: =IfError(LookUp(collectShiftOEE2, line="Average" && shift = "C").pack_per_hour,0)
                                              Align: =Align.Center
                                              Color: =gTheme.Text_On_Light
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4
                                              Width: =10
                                - oee-c-lower:
                                    Control: GroupContainer
                                    Variant: horizontalAutoLayoutContainer
                                    Properties:
                                      AlignInContainer: =AlignInContainer.SetByContainer
                                      DropShadow: =DropShadow.None
                                      LayoutAlignItems: =LayoutAlignItems.Stretch
                                      LayoutMinHeight: =10
                                      LayoutMinWidth: =10
                                      LayoutMode: =LayoutMode.Auto
                                      RadiusBottomLeft: =0
                                      RadiusBottomRight: =0
                                      RadiusTopLeft: =0
                                      RadiusTopRight: =0
                                    Children:
                                    - oee-c-runtime-parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee-c-runtime-title:
                                            Control: Label
                                            Properties:
                                              Text: ="Collected Runtime"
                                              Align: =Align.Center
                                              Color: =gTheme.Text_Dark
                                              Fill: =gTheme.Sec_Complement
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee-c-runtime:
                                            Control: Label
                                            Properties:
                                              Text: |-
                                                =Round(Sum(Filter(collectShiftOEE2, shift= "C", line <> "Average"), total_runtime),0) & "H"
                                                //RoundDown(LookUp(collectShiftOEE2, line = "Average" shift = "C").runtime,0) & "H "& Mod(LookUp(collectShiftOEE, shift = "C").runtime*60,60) & "m"
                                              Align: =Align.Center
                                              Color: =gTheme.Text_On_Light
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4
                                              Width: =10
                                    - oee-c-downtime-parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee-c-downtime-title:
                                            Control: Label
                                            Properties:
                                              Text: ="Calculated Downtime"
                                              Align: =Align.Center
                                              Color: =gTheme.Text_Dark
                                              Fill: =gTheme.Sec_Complement
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee-c-downtime:
                                            Control: Label
                                            Properties:
                                              Text: |-
                                                =Round(Sum(Filter(collectShiftOEE2, line = "Average", shift = "C"),total_downtime),0) & "H " & Round(Mod(Sum(Filter(collectShiftOEE2, line = "Average", shift = "C"),total_downtime)*60,60),0) & "m"
                                                //"Not Collected"
                                                //RoundDown(LookUp(collectShiftOEE, shift = "C").downtime_planned/60,0) &"H "& Mod(LookUp(collectShiftOEE, shift = "C").downtime_planned,60) & "m"
                                              Align: =Align.Center
                                              Color: =gTheme.Text_On_Light
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4
                                              Width: =10
                                    - oee-c-possible-parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee-c-possible-title:
                                            Control: Label
                                            Properties:
                                              Text: ="Possible Runtime"
                                              Align: =Align.Center
                                              Color: =gTheme.Text_Dark
                                              Fill: =gTheme.Sec_Complement
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee-c-possible:
                                            Control: Label
                                            Properties:
                                              Text: =If('oee-line'.Selected.Value = "All", 11, 1) * 16 * count_of_days & "H"
                                              Align: =Align.Center
                                              Color: =gTheme.Text_On_Light
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4
                                              Width: =10
                    - oee-shift-a:
                        Control: GroupContainer
                        Variant: verticalAutoLayoutContainer
                        Properties:
                          AlignInContainer: =AlignInContainer.SetByContainer
                          BorderColor: =RGBA(0,0,0,0)
                          DropShadow: =DropShadow.Semilight
                          Fill: =gTheme.Foreground
                          LayoutAlignItems: =LayoutAlignItems.Stretch
                          LayoutDirection: =LayoutDirection.Vertical
                          LayoutMinHeight: =10
                          LayoutMinWidth: =10
                          LayoutMode: =LayoutMode.Auto
                          PaddingLeft: =
                        Children:
                        - oee-a-title:
                            Control: Label
                            Properties:
                              Text: ="A Shift"
                              Align: =Align.Center
                              Color: =gTheme.Text_Light
                              Fill: =gTheme.Secondary
                              FillPortions: =1
                              Font: =Font.Verdana
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              Size: =Self.Height / 3
                        - oee-a-layout:
                            Control: GroupContainer
                            Variant: horizontalAutoLayoutContainer
                            Properties:
                              AlignInContainer: =AlignInContainer.SetByContainer
                              DropShadow: =DropShadow.None
                              FillPortions: =5
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              LayoutMode: =LayoutMode.Auto
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                            Children:
                            - oee-a-graph:
                                Control: Image
                                Properties:
                                  Image: |-
                                    ="https://quickchart.io/chart?width=" &Self.Width& "&height=" &Self.Height*0.90& "&c=" & 
                                    EncodeUrl(
                                    "{
                                      type: 'radialGauge',
                                      data: {
                                        datasets: [{
                                          data: ["& LookUp(collectShiftOEE2, line = "Average" && shift = "A").OEE2 &"],
                                          backgroundColor: getGradientFillHelper('horizontal', [
                                            '"& gTheme.Chart_Blue &"',
                                            '"& gTheme.Chart_Blue &"',
                                            '"& gTheme.Chart_Blue &"',
                                            '"& gTheme.Chart_Red &"',
                                            '"& gTheme.Chart_Red &"',
                                            '"& gTheme.Chart_Red &"'
                                            ]),
                                        }]
                                      },
                                      options: {
                                        domain: [0, "& If(LookUp(collectShiftOEE2, line = "Average" && shift = "A").OEE2 <= 100, 100, LookUp(collectShiftOEE2, line = "Average" && shift = "A").OEE2) &"],
                                        trackColor: '"& gTheme.Chart_White &"', 
                                        centerPercentage: 90,
                                        centerArea: {
                                          text: (val) => val + '%',
                                          fontColor: '"& gTheme.Chart_Black &"'
                                        },
                                      }
                                    }"
                                    )
                                  FillPortions: =2
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: =10
                            - oee-a-data:
                                Control: GroupContainer
                                Variant: verticalAutoLayoutContainer
                                Properties:
                                  AlignInContainer: =AlignInContainer.SetByContainer
                                  DropShadow: =DropShadow.None
                                  FillPortions: =4
                                  LayoutAlignItems: =LayoutAlignItems.Stretch
                                  LayoutDirection: =LayoutDirection.Vertical
                                  LayoutGap: =
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: =10
                                  LayoutMode: =LayoutMode.Auto
                                  RadiusBottomLeft: =0
                                  RadiusBottomRight: =0
                                  RadiusTopLeft: =0
                                  RadiusTopRight: =0
                                Children:
                                - oee-a-upper:
                                    Control: GroupContainer
                                    Variant: horizontalAutoLayoutContainer
                                    Properties:
                                      AlignInContainer: =AlignInContainer.SetByContainer
                                      DropShadow: =DropShadow.None
                                      LayoutAlignItems: =LayoutAlignItems.Stretch
                                      LayoutMinHeight: =10
                                      LayoutMinWidth: =10
                                      LayoutMode: =LayoutMode.Auto
                                      RadiusBottomLeft: =0
                                      RadiusBottomRight: =0
                                      RadiusTopLeft: =0
                                      RadiusTopRight: =0
                                    Children:
                                    - oee-a-built-parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee-a-built-title:
                                            Control: Label
                                            Properties:
                                              Text: ="Units Built"
                                              Align: =Align.Center
                                              Color: =gTheme.Text_Dark
                                              Fill: =gTheme.Sec_Complement
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee-a-built:
                                            Control: Label
                                            Properties:
                                              Text: =Sum(Filter(collectShiftOEE2, line = "Average", shift = "A"),total_packs)*1
                                              Align: =Align.Center
                                              Color: =gTheme.Text_On_Light
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4
                                              Width: =10
                                    - oee-a-goal-parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee-a-goal-title:
                                            Control: Label
                                            Properties:
                                              Text: ="Build Goal"
                                              Align: =Align.Center
                                              Color: =gTheme.Text_Dark
                                              Fill: =gTheme.Sec_Complement
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee-a-goal:
                                            Control: Label
                                            Properties:
                                              Text: =Round(Sum(Filter(collectShiftOEE2, line="Average", shift="A"),planned_packs),0)
                                              Align: =Align.Center
                                              Color: =gTheme.Text_On_Light
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4
                                              Width: =10
                                    - oee-a-constraint-parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee-a-constraint-title:
                                            Control: Label
                                            Properties:
                                              Text: ="Constraint"
                                              Align: =Align.Center
                                              Color: =gTheme.Text_Dark
                                              Fill: =gTheme.Sec_Complement
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee-a-constraint:
                                            Control: Label
                                            Properties:
                                              Text: =IfError(LookUp(collectShiftOEE2, line="Average" && shift = "A").pack_per_hour,0)
                                              Align: =Align.Center
                                              Color: =gTheme.Text_On_Light
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4
                                              Width: =10
                                - oee-a-lower:
                                    Control: GroupContainer
                                    Variant: horizontalAutoLayoutContainer
                                    Properties:
                                      AlignInContainer: =AlignInContainer.SetByContainer
                                      DropShadow: =DropShadow.None
                                      LayoutAlignItems: =LayoutAlignItems.Stretch
                                      LayoutMinHeight: =10
                                      LayoutMinWidth: =10
                                      LayoutMode: =LayoutMode.Auto
                                      RadiusBottomLeft: =0
                                      RadiusBottomRight: =0
                                      RadiusTopLeft: =0
                                      RadiusTopRight: =0
                                    Children:
                                    - oee-a-runtime-parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee-a-runtime-title:
                                            Control: Label
                                            Properties:
                                              Text: ="Collected Runtime"
                                              Align: =Align.Center
                                              Color: =gTheme.Text_Dark
                                              Fill: =gTheme.Sec_Complement
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee-a-runtime:
                                            Control: Label
                                            Properties:
                                              Text: |-
                                                =Round(Sum(Filter(collectShiftOEE2, shift= "A", line <> "Average"), total_runtime),0) & "H"
                                                //RoundDown(LookUp(collectShiftOEE2, line = "Average" shift = "A").runtime,0) & "H "& Mod(LookUp(collectShiftOEE, shift = "A").runtime*60,60) & "m"
                                              Align: =Align.Center
                                              Color: =gTheme.Text_On_Light
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4
                                              Width: =10
                                    - oee-a-downtime-parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee-a-downtime-title:
                                            Control: Label
                                            Properties:
                                              Text: ="Calculated Downtime"
                                              Align: =Align.Center
                                              Color: =gTheme.Text_Dark
                                              Fill: =gTheme.Sec_Complement
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee-a-downtime:
                                            Control: Label
                                            Properties:
                                              Text: |-
                                                =Round(Sum(Filter(collectShiftOEE2, line = "Average", shift = "A"),total_downtime),0) & "H " & Round(Mod(Sum(Filter(collectShiftOEE2, line = "Average", shift = "A"),total_downtime)*60,60),0) & "m"
                                                //"Not Collected"
                                                //RoundDown(LookUp(collectShiftOEE, shift = "A").downtime_planned/60,0) &"H "& Mod(LookUp(collectShiftOEE, shift = "A").downtime_planned,60) & "m"
                                              Align: =Align.Center
                                              Color: =gTheme.Text_On_Light
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4
                                              Width: =10
                                    - oee-a-possible-parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee-a-possible-title:
                                            Control: Label
                                            Properties:
                                              Text: ="Possible Runtime"
                                              Align: =Align.Center
                                              Color: =gTheme.Text_Dark
                                              Fill: =gTheme.Sec_Complement
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee-a-possible:
                                            Control: Label
                                            Properties:
                                              Text: =If('oee-line'.Selected.Value = "All", 11, 1) * 16 * count_of_days & "H"
                                              Align: =Align.Center
                                              Color: =gTheme.Text_On_Light
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4
                                              Width: =10
                    - oee-shift-b:
                        Control: GroupContainer
                        Variant: verticalAutoLayoutContainer
                        Properties:
                          AlignInContainer: =AlignInContainer.SetByContainer
                          BorderColor: =RGBA(0,0,0,0)
                          DropShadow: =DropShadow.Semilight
                          Fill: =gTheme.Foreground
                          LayoutAlignItems: =LayoutAlignItems.Stretch
                          LayoutDirection: =LayoutDirection.Vertical
                          LayoutMinHeight: =10
                          LayoutMinWidth: =10
                          LayoutMode: =LayoutMode.Auto
                          PaddingLeft: =
                        Children:
                        - oee-b-title:
                            Control: Label
                            Properties:
                              Text: ="B Shift"
                              Align: =Align.Center
                              Color: =gTheme.Text_Light
                              Fill: =gTheme.Secondary
                              FillPortions: =1
                              Font: =Font.Verdana
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              Size: =Self.Height / 3
                        - oee-b-layout:
                            Control: GroupContainer
                            Variant: horizontalAutoLayoutContainer
                            Properties:
                              AlignInContainer: =AlignInContainer.SetByContainer
                              DropShadow: =DropShadow.None
                              FillPortions: =5
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutMinHeight: =10
                              LayoutMinWidth: =10
                              LayoutMode: =LayoutMode.Auto
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                            Children:
                            - oee-b-graph:
                                Control: Image
                                Properties:
                                  Image: |-
                                    ="https://quickchart.io/chart?width=" &Self.Width& "&height=" &Self.Height*0.90& "&c=" & 
                                    EncodeUrl(
                                    "{
                                      type: 'radialGauge',
                                      data: {
                                        datasets: [{
                                          data: ["& LookUp(collectShiftOEE2, line = "Average" && shift = "B").OEE2 &"],
                                          backgroundColor: getGradientFillHelper('horizontal', [
                                            '"& gTheme.Chart_Blue &"',
                                            '"& gTheme.Chart_Blue &"',
                                            '"& gTheme.Chart_Blue &"',
                                            '"& gTheme.Chart_Red &"',
                                            '"& gTheme.Chart_Red &"',
                                            '"& gTheme.Chart_Red &"'
                                            ]),
                                        }]
                                      },
                                      options: {
                                        domain: [0, "& If(LookUp(collectShiftOEE2, line = "Average" && shift = "B").OEE2 <= 100, 100, LookUp(collectShiftOEE2, line = "Average" && shift = "B").OEE2) &"],
                                        trackColor: '"& gTheme.Chart_White &"', 
                                        centerPercentage: 90,
                                        centerArea: {
                                          text: (val) => val + '%',
                                          fontColor: '"& gTheme.Chart_Black &"'
                                        },
                                      }
                                    }"
                                    )
                                  FillPortions: =2
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: =10
                            - oee-b-data:
                                Control: GroupContainer
                                Variant: verticalAutoLayoutContainer
                                Properties:
                                  AlignInContainer: =AlignInContainer.SetByContainer
                                  DropShadow: =DropShadow.None
                                  FillPortions: =4
                                  LayoutAlignItems: =LayoutAlignItems.Stretch
                                  LayoutDirection: =LayoutDirection.Vertical
                                  LayoutGap: =
                                  LayoutMinHeight: =10
                                  LayoutMinWidth: =10
                                  LayoutMode: =LayoutMode.Auto
                                  RadiusBottomLeft: =0
                                  RadiusBottomRight: =0
                                  RadiusTopLeft: =0
                                  RadiusTopRight: =0
                                Children:
                                - oee-b-upper:
                                    Control: GroupContainer
                                    Variant: horizontalAutoLayoutContainer
                                    Properties:
                                      AlignInContainer: =AlignInContainer.SetByContainer
                                      DropShadow: =DropShadow.None
                                      LayoutAlignItems: =LayoutAlignItems.Stretch
                                      LayoutMinHeight: =10
                                      LayoutMinWidth: =10
                                      LayoutMode: =LayoutMode.Auto
                                      RadiusBottomLeft: =0
                                      RadiusBottomRight: =0
                                      RadiusTopLeft: =0
                                      RadiusTopRight: =0
                                    Children:
                                    - oee-b-built-parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee-b-built-title:
                                            Control: Label
                                            Properties:
                                              Text: ="Units Built"
                                              Align: =Align.Center
                                              Color: =gTheme.Text_Dark
                                              Fill: =gTheme.Sec_Complement
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee-b-built:
                                            Control: Label
                                            Properties:
                                              Text: =Sum(Filter(collectShiftOEE2, line = "Average", shift = "B"),total_packs)*1
                                              Align: =Align.Center
                                              Color: =gTheme.Text_On_Light
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4
                                              Width: =10
                                    - oee-b-goal-parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee-b-goal-title:
                                            Control: Label
                                            Properties:
                                              Text: ="Build Goal"
                                              Align: =Align.Center
                                              Color: =gTheme.Text_Dark
                                              Fill: =gTheme.Sec_Complement
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee-b-goal:
                                            Control: Label
                                            Properties:
                                              Text: =Round(Sum(Filter(collectShiftOEE2, line="Average", shift="B"),planned_packs),0)
                                              Align: =Align.Center
                                              Color: =gTheme.Text_On_Light
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4
                                              Width: =10
                                    - oee-b-constraint-parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee-b-constraint-title:
                                            Control: Label
                                            Properties:
                                              Text: ="Constraint"
                                              Align: =Align.Center
                                              Color: =gTheme.Text_Dark
                                              Fill: =gTheme.Sec_Complement
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee-b-constraint:
                                            Control: Label
                                            Properties:
                                              Text: =IfError(LookUp(collectShiftOEE2, line="Average" && shift = "B").pack_per_hour,0)
                                              Align: =Align.Center
                                              Color: =gTheme.Text_On_Light
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4
                                              Width: =10
                                - oee-b-lower:
                                    Control: GroupContainer
                                    Variant: horizontalAutoLayoutContainer
                                    Properties:
                                      AlignInContainer: =AlignInContainer.SetByContainer
                                      DropShadow: =DropShadow.None
                                      LayoutAlignItems: =LayoutAlignItems.Stretch
                                      LayoutMinHeight: =10
                                      LayoutMinWidth: =10
                                      LayoutMode: =LayoutMode.Auto
                                      RadiusBottomLeft: =0
                                      RadiusBottomRight: =0
                                      RadiusTopLeft: =0
                                      RadiusTopRight: =0
                                    Children:
                                    - oee-b-runtime-parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee-b-runtime-title:
                                            Control: Label
                                            Properties:
                                              Text: ="Collected Runtime"
                                              Align: =Align.Center
                                              Color: =gTheme.Text_Dark
                                              Fill: =gTheme.Sec_Complement
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee-b-runtime:
                                            Control: Label
                                            Properties:
                                              Text: |-
                                                =Round(Sum(Filter(collectShiftOEE2, shift= "A", line <> "Average"), total_runtime),0) & "H"
                                                //RoundDown(LookUp(collectShiftOEE2, line = "Average" shift = "B").runtime,0) & "H "& Mod(LookUp(collectShiftOEE, shift = "B").runtime*60,60) & "m"
                                              Align: =Align.Center
                                              Color: =gTheme.Text_On_Light
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4
                                              Width: =10
                                    - oee-b-downtime-parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee-b-downtime-title:
                                            Control: Label
                                            Properties:
                                              Text: ="Calcualted Downtime"
                                              Align: =Align.Center
                                              Color: =gTheme.Text_Dark
                                              Fill: =gTheme.Sec_Complement
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee-b-downtime:
                                            Control: Label
                                            Properties:
                                              Text: |-
                                                =Round(Sum(Filter(collectShiftOEE2, line = "Average", shift = "B"),total_downtime),0) & "H " & Round(Mod(Sum(Filter(collectShiftOEE2, line = "Average", shift = "B"),total_downtime)*60,60),0) & "m"
                                                //"Not Collected"
                                                //RoundDown(LookUp(collectShiftOEE, shift = "B").downtime_planned/60,0) &"H "& Mod(LookUp(collectShiftOEE, shift = "B").downtime_planned,60) & "m"
                                              Align: =Align.Center
                                              Color: =gTheme.Text_On_Light
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4
                                              Width: =10
                                    - oee-b-possible-parent:
                                        Control: GroupContainer
                                        Variant: verticalAutoLayoutContainer
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutMinHeight: =10
                                          LayoutMinWidth: =10
                                          LayoutMode: =LayoutMode.Auto
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                        - oee-b-possible-title:
                                            Control: Label
                                            Properties:
                                              Text: ="Possible Runtime"
                                              Align: =Align.Center
                                              Color: =gTheme.Text_Dark
                                              Fill: =gTheme.Sec_Complement
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4.5
                                              Width: =10
                                        - oee-b-possible:
                                            Control: Label
                                            Properties:
                                              Text: =If('oee-line'.Selected.Value = "All", 11, 1) * 16 * count_of_days & "H"
                                              Align: =Align.Center
                                              Color: =gTheme.Text_On_Light
                                              FillPortions: =1
                                              Font: =Font.Verdana
                                              LayoutMinHeight: =10
                                              LayoutMinWidth: =10
                                              Size: =Self.Height / 4
                                              Width: =10
                - oee-top-downtime:
                    Control: GroupContainer
                    Variant: verticalAutoLayoutContainer
                    Properties:
                      AlignInContainer: =AlignInContainer.SetByContainer
                      BorderColor: =gTheme.Sec_Complement
                      BorderThickness: |-
                        =//If(gTheme.Mode = "Light", 0, 1)
                        0
                      DropShadow: =DropShadow.Semilight
                      Fill: =gTheme.Foreground
                      FillPortions: =2
                      Height: =Parent.Height
                      LayoutAlignItems: =LayoutAlignItems.Stretch
                      LayoutDirection: =LayoutDirection.Vertical
                      LayoutMinHeight: =10
                      LayoutMinWidth: =10
                      LayoutMode: =LayoutMode.Auto
                      PaddingBottom: =gPadding
                      PaddingTop: =
                      Width: =Parent.Width * 0.65
                    Children:
                    - oee-td-header:
                        Control: GroupContainer
                        Variant: manualLayoutContainer
                        Properties:
                          AlignInContainer: =AlignInContainer.SetByContainer
                          DropShadow: =DropShadow.None
                          Fill: =gTheme.Secondary
                          LayoutMinHeight: =1
                          LayoutMinWidth: =1
                          RadiusBottomLeft: =0
                          RadiusBottomRight: =0
                          RadiusTopLeft: =0
                          RadiusTopRight: =0
                          Width: =Parent.Width
                        Children:
                        - oee-td-h-title:
                            Control: Label
                            Properties:
                              Text: ="Downtime Breakdown"
                              Align: =Align.Center
                              Color: =gTheme.Text_Light
                              Font: =Font.Verdana
                              Height: =Parent.Height
                              Size: =Self.Height / 3
                              Width: =Parent.Width
                    - oee-td-columns:
                        Control: GroupContainer
                        Variant: manualLayoutContainer
                        Properties:
                          AlignInContainer: =AlignInContainer.SetByContainer
                          DropShadow: =DropShadow.None
                          Fill: =gTheme.Sec_Complement
                          LayoutMinHeight: =1
                          LayoutMinWidth: =1
                          RadiusBottomLeft: =0
                          RadiusBottomRight: =0
                          RadiusTopLeft: =0
                          RadiusTopRight: =0
                          Width: =Parent.Width
                        Children:
                        - oee-td-c-amount:
                            Control: Label
                            Properties:
                              Text: ="Amount"
                              Align: =Align.Center
                              Color: =gTheme.Text_Dark
                              Font: =Font.Verdana
                              Height: =Parent.Height
                              Size: =Self.Height / 3.5
                              Width: =Parent.Width / 2
                              X: ='oee-td-c-reason'.X + 'oee-td-c-reason'.Width
                        - oee-td-c-reason:
                            Control: Label
                            Properties:
                              Text: ="Reason"
                              Align: =Align.Center
                              Color: =gTheme.Text_Dark
                              Font: =Font.Verdana
                              Height: =Parent.Height
                              Size: =Self.Height / 3.5
                              Width: =Parent.Width / 2
                    - oee-td-gallery:
                        Control: Gallery
                        Variant: galleryVertical
                        Properties:
                          Items: |-
                            =Sort(collectTopDowntime,
                                Downtime_Total,
                                SortOrder.Descending
                            )
                          AlignInContainer: =AlignInContainer.SetByContainer
                          DelayItemLoading: =true
                          FillPortions: =14
                          Layout: =Layout.Vertical
                          LayoutMinHeight: =1
                          LayoutMinWidth: =1
                          LoadingSpinner: =LoadingSpinner.Data
                          TemplatePadding: =0
                          TemplateSize: =Self.Height / 14
                        Children:
                        - oee-td-g-amount:
                            Control: Label
                            Properties:
                              OnSelect: =Select(Parent)
                              Text: =RoundDown(ThisItem.Downtime_Total/60,0) & "H " & Mod(ThisItem.Downtime_Total,60) & "m"
                              Align: =Align.Center
                              Color: =gTheme.Text_On_Light
                              Font: =Font.Verdana
                              Height: =Parent.TemplateHeight - 'oee-td-g-seperator'.Height
                              Size: =Self.Height / 4.5
                              Width: =Parent.TemplateWidth/2
                              X: ='oee-td-g-reason'.X + 'oee-td-g-reason'.Width
                              Y: =1-1
                        - oee-td-g-reason:
                            Control: Label
                            Properties:
                              OnSelect: =Select(Parent)
                              Text: =ThisItem.Downtime_Reason
                              Align: =Align.Center
                              Color: =gTheme.Text_On_Light
                              Font: =Font.Verdana
                              Height: =Parent.TemplateHeight - 'oee-td-g-seperator'.Height
                              Size: =Self.Height / 4.5
                              Width: =Parent.TemplateWidth/2
                              X: =1-1
                              Y: =1-1
                        - oee-td-g-seperator:
                            Control: Rectangle
                            Properties:
                              OnSelect: =Select(Parent)
                              Fill: =gTheme.Accent
                              Height: =Parent.TemplateHeight * 0.025
                              Width: =Parent.Width
                              Y: =Parent.TemplateHeight - Self.Height
            - oee-pareto-oee2:
                Control: Image
                Properties:
                  Image: |-
                    ="https://quickchart.io/chart?width=" & Self.Width & "&height=" & Self.Height*0.90 & "&c=" & 
                    EncodeUrl("
                    {
                      type: 'bar',
                      data: {
                        labels: "&
                            Concatenate(
                                "['",
                                Concat(
                                    Sort(
                                        Filter(collectTopDowntime,
                                            Not(Downtime_Reason in gLists.Downtime_Reasons_Planned)
                                        ),
                                        Downtime_Total,
                                        SortOrder.Descending
                                    ),
                                    ThisRecord.Downtime_Reason,
                                    "',
                                    '"
                                ),
                                "']")
                            &",
                        datasets: [{
                          label: 'Frequency',
                          data: "&
                            Concatenate(
                                "['",
                                Concat(
                                    Sort(
                                        Filter(collectTopDowntime,
                                            Not(Downtime_Reason in gLists.Downtime_Reasons_Planned)
                                        ),
                                        Downtime_Total,
                                        SortOrder.Descending
                                    ),
                                    ThisRecord.Downtime_Total,
                                    "',
                                    '"
                                ),
                                "']"
                            )
                          &",
                          backgroundColor: '"& gTheme.Chart_Blue &"'
                        }, {
                          label: 'Cumulative Percentage',
                          data: " & Concatenate("['", Concat(Sort(collectPareto, freq, SortOrder.Descending), ThisRecord.cumulative, "', '"), "']") & ",
                          type: 'line',
                          borderColor: '"& gTheme.Chart_Red &"',
                          fill: false,
                          yAxisID: 'right-y-axis' // Assign to the right Y-axis
                        }]
                      },
                      options: {
                        title: {
                          display: true,
                          text: 'OEE2 ',
                        },
                        scales: {
                          xAxes: [{
                            offset: true,
                            fontColor: '"&gTheme.Chart_Black&"',
                            ticks:{fontColor: '"&gTheme.Chart_Black&"'},
                            gridLines: {color: '"&gTheme.Chart_Dim&"'}
                          }],
                          yAxes: [{
                            id: 'left-y-axis',
                            type: 'linear',
                            position: 'left',
                            ticks: {
                              beginAtZero: true,
                              fontColor: '"&gTheme.Chart_Black&"'
                            },
                            gridLines: {color: '"&gTheme.Chart_Dim&"'}
                          },
                          {
                            id: 'right-y-axis',
                            type: 'linear',
                            position: 'right',
                            ticks: {
                              beginAtZero: true,
                              fontColor: '"&gTheme.Chart_Black&"',
                              max: 100,
                              stepSize: 20,
                              callback: function(value, index, values) {
                                return value + '%';
                              }
                            },
                            gridLines: { 
                              drawOnChartArea: false
                            }
                          }]
                        },
                        tooltips: {
                          mode: 'index',
                          intersect: false
                        },
                        annotation: {
                          annotations: [{
                            type: 'line',
                            mode: 'horizontal',
                            scaleID: 'right-y-axis',
                            value: 80,
                            borderColor: '"& gTheme.Chart_Red &"',
                            borderWidth: 2,
                            label: {
                              enabled: true,
                              position: 'right',
                              content: '80% Threshold'
                            }
                          },
                          {
                            type: 'line',
                            mode: 'vertical',
                            scaleID: 'x-axis-0',
                            value: ["& First(Sort(Filter(collectPareto, cumulative >= 80), freq, SortOrder.Descending)).id-1 &"],
                            borderColor: '"& gTheme.Chart_Blue &"',
                            borderWidth: 2,
                            label: {
                              enabled: true,
                              content: '80% Volume',
                              position: 'top',
                              backgroundColor: 'rgba(72, 72, 192, 0.5)'
                            }
                          }]
                        }
                      }
                    }")
                  BorderColor: =gTheme.Sec_Complement
                  BorderThickness: |-
                    =//If(gTheme.Mode = "Light", 0, 1)
                    0
                  Fill: =gTheme.Background
                  Height: =Self.Width / 2.15
                  HoverFill: =Self.Fill
                  Width: =Parent.Width * 0.65
                  X: =Parent.Width/2 - Self.Width/2
                  Y: =Parent.Height/2 - Self.Height/2
            - oee-pareto-oee1:
                Control: Image
                Properties:
                  Image: |-
                    ="https://quickchart.io/chart?width=" & Self.Width & "&height=" & Self.Height*0.90 & "&c=" & 
                    EncodeUrl("
                    {
                      type: 'bar',
                      data: {
                        labels: "&
                            Concatenate(
                                "['",
                                Concat(
                                    Sort(
                                        Filter(collectTopDowntime,
                                            Downtime_Reason in gLists.Downtime_Reasons_Planned
                                        ),
                                        Downtime_Total,
                                        SortOrder.Descending
                                    ),
                                    ThisRecord.Downtime_Reason,
                                    "',
                                    '"
                                ),
                                "']")
                            &",
                        datasets: [{
                          label: 'Frequency',
                          data: "&
                            Concatenate(
                                "['",
                                Concat(
                                    Sort(
                                        Filter(collectTopDowntime,
                                            Downtime_Reason in gLists.Downtime_Reasons_Planned
                                        ),
                                        Downtime_Total,
                                        SortOrder.Descending
                                    ),
                                    ThisRecord.Downtime_Total,
                                    "',
                                    '"
                                ),
                                "']"
                            )
                          &",
                          backgroundColor: '"& gTheme.Chart_Blue &"'
                        }, {
                          label: 'Cumulative Percentage',
                          data: " & Concatenate("['", Concat(Sort(collectParetoOEE1, freq, SortOrder.Descending), ThisRecord.cumulative, "', '"), "']") & ",
                          type: 'line',
                          borderColor: '"& gTheme.Chart_Red &"',
                          fill: false,
                          yAxisID: 'right-y-axis' // Assign to the right Y-axis
                        }]
                      },
                      options: {
                        title: {
                          display: true,
                          text: 'OEE1',
                        },
                        scales: {
                          xAxes: [{
                            offset: true,
                            fontColor: '"&gTheme.Chart_Black&"',
                            ticks:{fontColor: '"&gTheme.Chart_Black&"'},
                            gridLines: {color: '"&gTheme.Chart_Dim&"'}
                          }],
                          yAxes: [{
                            id: 'left-y-axis',
                            type: 'linear',
                            position: 'left',
                            ticks: {
                              beginAtZero: true,
                              fontColor: '"&gTheme.Chart_Black&"'
                            },
                            gridLines: {color: '"&gTheme.Chart_Dim&"'}
                          },
                          {
                            id: 'right-y-axis',
                            type: 'linear',
                            position: 'right',
                            ticks: {
                              beginAtZero: true,
                              fontColor: '"&gTheme.Chart_Black&"',
                              max: 100,
                              stepSize: 20,
                              callback: function(value, index, values) {
                                return value + '%';
                              }
                            },
                            gridLines: { 
                              drawOnChartArea: false
                            }
                          }]
                        },
                        tooltips: {
                          mode: 'index',
                          intersect: false
                        },
                        annotation: {
                          annotations: [{
                            type: 'line',
                            mode: 'horizontal',
                            scaleID: 'right-y-axis',
                            value: 80,
                            borderColor: '"& gTheme.Chart_Red &"',
                            borderWidth: 2,
                            label: {
                              enabled: true,
                              position: 'right',
                              content: '80% Threshold'
                            }
                          },
                          {
                            type: 'line',
                            mode: 'vertical',
                            scaleID: 'x-axis-0',
                            value: ["& First(Sort(Filter(collectParetoOEE1, cumulative >= 80), freq, SortOrder.Descending)).id-1 &"],
                            borderColor: '"& gTheme.Chart_Blue &"',
                            borderWidth: 2,
                            label: {
                              enabled: true,
                              content: '80% Volume',
                              position: 'top',
                              backgroundColor: 'rgba(72, 72, 192, 0.5)'
                            }
                          }]
                        }
                      }
                    }")
                  BorderColor: =gTheme.Sec_Complement
                  BorderThickness: |-
                    =//If(gTheme.Mode = "Light", 0, 1)
                    0
                  Fill: =gTheme.Background_0
                  Height: =Self.Width / 2.15
                  HoverFill: =Self.Fill
                  LayoutMinHeight: =10
                  LayoutMinWidth: =10
                  Width: =Parent.Width * 0.65
                  X: =Parent.Width/2 - Self.Width/2
                  Y: =Parent.Height/2 - Self.Height/2
